<!DOCTYPE html><html lang="en" dir="ltr" data-theme="dark" data-has-toc data-has-sidebar class="astro-bguv2lll"> <head><meta charset="utf-8"/><meta name="viewport" content="width=device-width, initial-scale=1"/><title>MCP servers with the Gemini CLI | Gemini CLI</title><link rel="canonical" href="https://geminicli.com/docs/tools/mcp-server/"/><link rel="sitemap" href="/sitemap-index.xml"/><link href="https://fonts.gstatic.com" rel="preconnect" crossorigin="true"/><link href="https://fonts.googleapis.com/css2?family=Google+Sans:wght@400;500;700&display=block" rel="stylesheet"/><link href="https://fonts.googleapis.com/css2?family=Google+Sans+Text:wght@400;500&display=block" rel="stylesheet"/><link href="https://fonts.googleapis.com/css2?family=Google+Sans+Mono:wght@400;500&display=block" rel="stylesheet"/><link href="https://fonts.googleapis.com/css2?family=Google+Symbols&display=block" rel="stylesheet"/><link rel="icon" href="/favicon.ico" sizes="32x32"/><script async src="https://www.googletagmanager.com/gtag/js?id=G-66QE907DJT"></script><script>window.dataLayer = window.dataLayer || [];
  function gtag() {
    dataLayer.push(arguments);
  }
  gtag("js", new Date());
  gtag("config", "G-66QE907DJT");</script><link rel="shortcut icon" href="/icon.png" type="image/png"/><meta name="generator" content="Astro v5.14.8"/><meta name="generator" content="Starlight v0.36.1"/><meta property="og:title" content="MCP servers with the Gemini CLI"/><meta property="og:type" content="article"/><meta property="og:url" content="https://geminicli.com/docs/tools/mcp-server/"/><meta property="og:locale" content="en"/><meta property="og:description"/><meta property="og:site_name" content="Gemini CLI"/><meta name="twitter:card" content="summary_large_image"/><meta property="og:image" content="https://geminicli.com/assets/social-poster.png"/><meta name="twitter:image" content="https://geminicli.com/assets/social-poster.png"/><script>
	window.StarlightThemeProvider = (() => {
		const storedTheme =
			typeof localStorage !== 'undefined' && localStorage.getItem('starlight-theme');
		const theme =
			storedTheme ||
			(window.matchMedia('(prefers-color-scheme: light)').matches ? 'light' : 'dark');
		document.documentElement.dataset.theme = theme === 'light' ? 'light' : 'dark';
		return {
			updatePickers(theme = storedTheme || 'auto') {
				document.querySelectorAll('starlight-theme-select').forEach((picker) => {
					const select = picker.querySelector('select');
					if (select) select.value = theme;
					/** @type {HTMLTemplateElement | null} */
					const tmpl = document.querySelector(`#theme-icons`);
					const newIcon = tmpl && tmpl.content.querySelector('.' + theme);
					if (newIcon) {
						const oldIcon = picker.querySelector('svg.label-icon');
						if (oldIcon) {
							oldIcon.replaceChildren(...newIcon.cloneNode(true).childNodes);
						}
					}
				});
			},
		};
	})();
</script><template id="theme-icons"><svg aria-hidden="true" class="light astro-c6vsoqas" width="16" height="16" viewBox="0 0 24 24" fill="currentColor" style="--sl-icon-size: 1em;"><path d="M5 12a1 1 0 0 0-1-1H3a1 1 0 0 0 0 2h1a1 1 0 0 0 1-1Zm.64 5-.71.71a1 1 0 0 0 0 1.41 1 1 0 0 0 1.41 0l.71-.71A1 1 0 0 0 5.64 17ZM12 5a1 1 0 0 0 1-1V3a1 1 0 0 0-2 0v1a1 1 0 0 0 1 1Zm5.66 2.34a1 1 0 0 0 .7-.29l.71-.71a1 1 0 1 0-1.41-1.41l-.66.71a1 1 0 0 0 0 1.41 1 1 0 0 0 .66.29Zm-12-.29a1 1 0 0 0 1.41 0 1 1 0 0 0 0-1.41l-.71-.71a1.004 1.004 0 1 0-1.43 1.41l.73.71ZM21 11h-1a1 1 0 0 0 0 2h1a1 1 0 0 0 0-2Zm-2.64 6A1 1 0 0 0 17 18.36l.71.71a1 1 0 0 0 1.41 0 1 1 0 0 0 0-1.41l-.76-.66ZM12 6.5a5.5 5.5 0 1 0 5.5 5.5A5.51 5.51 0 0 0 12 6.5Zm0 9a3.5 3.5 0 1 1 0-7 3.5 3.5 0 0 1 0 7Zm0 3.5a1 1 0 0 0-1 1v1a1 1 0 0 0 2 0v-1a1 1 0 0 0-1-1Z"/></svg><svg aria-hidden="true" class="dark astro-c6vsoqas" width="16" height="16" viewBox="0 0 24 24" fill="currentColor" style="--sl-icon-size: 1em;"><path d="M21.64 13a1 1 0 0 0-1.05-.14 8.049 8.049 0 0 1-3.37.73 8.15 8.15 0 0 1-8.14-8.1 8.59 8.59 0 0 1 .25-2A1 1 0 0 0 8 2.36a10.14 10.14 0 1 0 14 11.69 1 1 0 0 0-.36-1.05Zm-9.5 6.69A8.14 8.14 0 0 1 7.08 5.22v.27a10.15 10.15 0 0 0 10.14 10.14 9.784 9.784 0 0 0 2.1-.22 8.11 8.11 0 0 1-7.18 4.32v-.04Z"/></svg><svg aria-hidden="true" class="auto astro-c6vsoqas" width="16" height="16" viewBox="0 0 24 24" fill="currentColor" style="--sl-icon-size: 1em;"><path d="M21 14h-1V7a3 3 0 0 0-3-3H7a3 3 0 0 0-3 3v7H3a1 1 0 0 0-1 1v2a3 3 0 0 0 3 3h14a3 3 0 0 0 3-3v-2a1 1 0 0 0-1-1ZM6 7a1 1 0 0 1 1-1h10a1 1 0 0 1 1 1v7H6V7Zm14 10a1 1 0 0 1-1 1H5a1 1 0 0 1-1-1v-1h16v1Z"/></svg></template><link rel="stylesheet" href="/_astro/print.DNXP8c50.css" media="print"><link rel="stylesheet" href="/_astro/debugz.BJBL9UVz.css"><script type="module" src="/_astro/page.CqwDW6Ek.js"></script></head> <body class="astro-bguv2lll"> <a href="#_top" class="astro-7q3lir66">Skip to content</a>  <div class="announcement-banner astro-yriad4ts"> <b class="astro-yriad4ts">Gemini 3 Flash is now available</b>. Speed no longer has to mean compromising
  quality. <a href="https://developers.googleblog.com/gemini-3-flash-is-now-available-in-gemini-cli/" class="astro-yriad4ts">Read the announcement</a> </div> <div class="page sl-flex astro-yriad4ts"> <header class="header astro-yriad4ts"><div id="page-header" class="header astro-3ef6ksr2"> <div class="title-wrapper sl-flex items-center astro-3ef6ksr2"> <div class="links-and-menu astro-3ef6ksr2" role="button" aria-label="Open navigation menu"> <a href="/" class="site-title sl-flex astro-m46x6ez3">  <img class="astro-m46x6ez3" alt="Gemini CLI Icon" src="/_astro/icon.Bo4M5sF3.png" width="1645" height="1645">  <span class="astro-m46x6ez3" translate="no"> Gemini CLI </span> </a>  <div class="nav-items astro-jvd4jwbq"> <a href="/" class="mobile-only astro-jvd4jwbq">Home</a> <div class="extensions-container astro-jvd4jwbq"> <a href="/extensions/" class="dark:text-white text-black no-underline extensions-link astro-jvd4jwbq">Extensions</a> <div class="extensions-menu astro-jvd4jwbq"> <a href="/extensions/" class="mobile-hide astro-jvd4jwbq" class="dark:text-white text-black no-underline extensions-link">Gallery</a> <a href="/extensions/about" class="dark:text-white text-black no-underline astro-jvd4jwbq">About Extensions</a> </div> </div> <a href="/docs/" class="dark:text-white text-black no-underline is-active astro-jvd4jwbq">Docs</a> <a href="/docs/changelogs/" class="dark:text-white text-black no-underline astro-jvd4jwbq">Changelog</a> </div>  </div> </div> <div class="sl-flex justify-end print:hidden search astro-3ef6ksr2"> <site-search class="astro-3ef6ksr2 astro-v37mnknz" data-translations="{&#34;placeholder&#34;:&#34;Search&#34;}"> <button data-open-modal disabled aria-label="Search" aria-keyshortcuts="Control+K" class="astro-v37mnknz"> <svg aria-hidden="true" class="astro-v37mnknz astro-c6vsoqas" width="16" height="16" viewBox="0 0 24 24" fill="currentColor" style="--sl-icon-size: 1em;"><path d="M21.71 20.29 18 16.61A9 9 0 1 0 16.61 18l3.68 3.68a.999.999 0 0 0 1.42 0 1 1 0 0 0 0-1.39ZM11 18a7 7 0 1 1 0-14 7 7 0 0 1 0 14Z"/></svg> <span class="sl-hidden md:sl-block astro-v37mnknz" aria-hidden="true">Search</span> <kbd class="sl-hidden md:sl-flex astro-v37mnknz" style="display: none;"> <kbd class="astro-v37mnknz">Ctrl</kbd><kbd class="astro-v37mnknz">K</kbd> </kbd> </button> <dialog style="padding:0" aria-label="Search" class="astro-v37mnknz"> <div class="dialog-frame sl-flex astro-v37mnknz">  <button data-close-modal class="sl-flex md:sl-hidden astro-v37mnknz"> Cancel </button> <div class="search-container astro-v37mnknz"> <div id="starlight__search" class="astro-v37mnknz"></div> </div> </div> </dialog> </site-search>  <script>
	(() => {
		const openBtn = document.querySelector('button[data-open-modal]');
		const shortcut = openBtn?.querySelector('kbd');
		if (!openBtn || !(shortcut instanceof HTMLElement)) return;
		const platformKey = shortcut.querySelector('kbd');
		if (platformKey && /(Mac|iPhone|iPod|iPad)/i.test(navigator.platform)) {
			platformKey.textContent = 'âŒ˜';
			openBtn.setAttribute('aria-keyshortcuts', 'Meta+K');
		}
		shortcut.style.display = '';
	})();
</script> <script type="module" src="/_astro/Search.astro_astro_type_script_index_0_lang.cjYDvRdi.js"></script>   </div> <div class="sl-hidden md:sl-flex print:hidden right-group astro-3ef6ksr2"> <div class="sl-flex social-icons astro-3ef6ksr2"> <a href="https://github.com/google-gemini/gemini-cli" rel="me" class="sl-flex astro-wy4te6ga"><span class="sr-only astro-wy4te6ga">GitHub</span><svg aria-hidden="true" class="astro-wy4te6ga astro-c6vsoqas" width="16" height="16" viewBox="0 0 24 24" fill="currentColor" style="--sl-icon-size: 1em;"><path d="M12 .3a12 12 0 0 0-3.8 23.38c.6.12.83-.26.83-.57L9 21.07c-3.34.72-4.04-1.61-4.04-1.61-.55-1.39-1.34-1.76-1.34-1.76-1.08-.74.09-.73.09-.73 1.2.09 1.83 1.24 1.83 1.24 1.08 1.83 2.81 1.3 3.5 1 .1-.78.42-1.31.76-1.61-2.67-.3-5.47-1.33-5.47-5.93 0-1.31.47-2.38 1.24-3.22-.14-.3-.54-1.52.1-3.18 0 0 1-.32 3.3 1.23a11.5 11.5 0 0 1 6 0c2.28-1.55 3.29-1.23 3.29-1.23.64 1.66.24 2.88.12 3.18a4.65 4.65 0 0 1 1.23 3.22c0 4.61-2.8 5.63-5.48 5.92.42.36.81 1.1.81 2.22l-.01 3.29c0 .31.2.69.82.57A12 12 0 0 0 12 .3Z"/></svg></a> </div> <starlight-theme-select>  <label style="--sl-select-width: 6.25em" class="astro-4yphtoen"> <span class="sr-only astro-4yphtoen">Select theme</span> <svg aria-hidden="true" class="icon label-icon astro-4yphtoen astro-c6vsoqas" width="16" height="16" viewBox="0 0 24 24" fill="currentColor" style="--sl-icon-size: 1em;"><path d="M21 14h-1V7a3 3 0 0 0-3-3H7a3 3 0 0 0-3 3v7H3a1 1 0 0 0-1 1v2a3 3 0 0 0 3 3h14a3 3 0 0 0 3-3v-2a1 1 0 0 0-1-1ZM6 7a1 1 0 0 1 1-1h10a1 1 0 0 1 1 1v7H6V7Zm14 10a1 1 0 0 1-1 1H5a1 1 0 0 1-1-1v-1h16v1Z"/></svg> <select autocomplete="off" class="astro-4yphtoen"> <option value="dark" class="astro-4yphtoen">Dark</option><option value="light" class="astro-4yphtoen">Light</option><option value="auto" selected class="astro-4yphtoen">Auto</option> </select> <svg aria-hidden="true" class="icon caret astro-4yphtoen astro-c6vsoqas" width="16" height="16" viewBox="0 0 24 24" fill="currentColor" style="--sl-icon-size: 1em;"><path d="M17 9.17a1 1 0 0 0-1.41 0L12 12.71 8.46 9.17a1 1 0 1 0-1.41 1.42l4.24 4.24a1.002 1.002 0 0 0 1.42 0L17 10.59a1.002 1.002 0 0 0 0-1.42Z"/></svg> </label>  </starlight-theme-select>  <script>
	StarlightThemeProvider.updatePickers();
</script> <script type="module">const r="starlight-theme",o=e=>e==="auto"||e==="dark"||e==="light"?e:"auto",c=()=>o(typeof localStorage<"u"&&localStorage.getItem(r));function n(e){typeof localStorage<"u"&&localStorage.setItem(r,e==="light"||e==="dark"?e:"")}const l=()=>matchMedia("(prefers-color-scheme: light)").matches?"light":"dark";function t(e){StarlightThemeProvider.updatePickers(e),document.documentElement.dataset.theme=e==="auto"?l():e,n(e)}matchMedia("(prefers-color-scheme: light)").addEventListener("change",()=>{c()==="auto"&&t("auto")});class s extends HTMLElement{constructor(){super(),t(c()),this.querySelector("select")?.addEventListener("change",a=>{a.currentTarget instanceof HTMLSelectElement&&t(o(a.currentTarget.value))})}}customElements.define("starlight-theme-select",s);</script> <script type="module">class s extends HTMLElement{constructor(){super();const e=this.querySelector("select");e&&(e.addEventListener("change",t=>{t.currentTarget instanceof HTMLSelectElement&&(window.location.pathname=t.currentTarget.value)}),window.addEventListener("pageshow",t=>{if(!t.persisted)return;const n=e.querySelector("option[selected]")?.index;n!==e.selectedIndex&&(e.selectedIndex=n??0)}))}}customElements.define("starlight-lang-select",s);</script> </div> </div> <script type="module">const e=document.querySelector("[role=button].links-and-menu");e?.addEventListener("click",t=>{const{matches:s}=window.matchMedia("(max-width: 640px)");if(!s)return;if(e.querySelector(".nav-items")?.contains(t.target)){e.classList.remove("is-active");return}t.preventDefault(),e.classList.toggle("is-active")});</script>  </header> <nav class="sidebar print:hidden astro-yriad4ts" aria-label="Main"> <starlight-menu-button class="print:hidden astro-jif73yzw"> <button aria-expanded="false" aria-label="Menu" aria-controls="starlight__sidebar" class="sl-flex md:sl-hidden astro-jif73yzw"> <svg aria-hidden="true" class="open-menu astro-jif73yzw astro-c6vsoqas" width="16" height="16" viewBox="0 0 24 24" fill="currentColor" style="--sl-icon-size: 1em;"><path d="M3 8h18a1 1 0 1 0 0-2H3a1 1 0 0 0 0 2Zm18 8H3a1 1 0 0 0 0 2h18a1 1 0 0 0 0-2Zm0-5H3a1 1 0 0 0 0 2h18a1 1 0 0 0 0-2Z"/></svg> <svg aria-hidden="true" class="close-menu astro-jif73yzw astro-c6vsoqas" width="16" height="16" viewBox="0 0 24 24" fill="currentColor" style="--sl-icon-size: 1em;"><path d="m13.41 12 6.3-6.29a1.004 1.004 0 1 0-1.42-1.42L12 10.59l-6.29-6.3a1.004 1.004 0 0 0-1.42 1.42l6.3 6.29-6.3 6.29a1 1 0 0 0 0 1.42.998.998 0 0 0 1.42 0l6.29-6.3 6.29 6.3a.999.999 0 0 0 1.42 0 1 1 0 0 0 0-1.42L13.41 12Z"/></svg> </button> </starlight-menu-button> <script type="module">class s extends HTMLElement{constructor(){super(),this.btn=this.querySelector("button"),this.btn.addEventListener("click",()=>this.toggleExpanded());const t=this.closest("nav");t&&t.addEventListener("keyup",e=>this.closeOnEscape(e))}setExpanded(t){this.setAttribute("aria-expanded",String(t)),document.body.toggleAttribute("data-mobile-menu-expanded",t)}toggleExpanded(){this.setExpanded(this.getAttribute("aria-expanded")!=="true")}closeOnEscape(t){t.code==="Escape"&&(this.setExpanded(!1),this.btn.focus())}}customElements.define("starlight-menu-button",s);</script>   <div id="starlight__sidebar" class="sidebar-pane astro-yriad4ts"> <div class="sidebar-content sl-flex astro-yriad4ts"> <sl-sidebar-state-persist data-hash="0rmj47v" class="astro-kku4brbg"> <script aria-hidden="true">
		(() => {
			try {
				if (!matchMedia('(min-width: 50em)').matches) return;
				/** @type {HTMLElement | null} */
				const target = document.querySelector('sl-sidebar-state-persist');
				const state = JSON.parse(sessionStorage.getItem('sl-sidebar-state') || '0');
				if (!target || !state || target.dataset.hash !== state.hash) return;
				window._starlightScrollRestore = state.scroll;
				customElements.define(
					'sl-sidebar-restore',
					class SidebarRestore extends HTMLElement {
						connectedCallback() {
							try {
								const idx = parseInt(this.dataset.index || '');
								const details = this.closest('details');
								if (details && typeof state.open[idx] === 'boolean') details.open = state.open[idx];
							} catch {}
						}
					}
				);
			} catch {}
		})();
	</script>  <ul class="top-level astro-3ii7xxms"> <li class="astro-3ii7xxms"> <details open class="astro-3ii7xxms"> <summary class="astro-3ii7xxms"> <span class="group-label astro-3ii7xxms"> <span class="large astro-3ii7xxms">Overview</span>  </span> <svg aria-hidden="true" class="caret astro-3ii7xxms astro-c6vsoqas" width="16" height="16" viewBox="0 0 24 24" fill="currentColor" style="--sl-icon-size: 1.25rem;"><path d="m14.83 11.29-4.24-4.24a1 1 0 1 0-1.42 1.41L12.71 12l-3.54 3.54a1 1 0 0 0 0 1.41 1 1 0 0 0 .71.29 1 1 0 0 0 .71-.29l4.24-4.24a1.002 1.002 0 0 0 0-1.42Z"/></svg> </summary> <sl-sidebar-restore data-index="0"></sl-sidebar-restore> <ul class="astro-3ii7xxms"> <li class="astro-3ii7xxms"> <a href="/docs/" aria-current="false" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">Introduction</span>  </a> </li><li class="astro-3ii7xxms"> <a href="/docs/architecture/" aria-current="false" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">Architecture overview</span>  </a> </li><li class="astro-3ii7xxms"> <a href="/docs/contributing/" aria-current="false" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">Contribution guide</span>  </a> </li> </ul>  </details> </li><li class="astro-3ii7xxms"> <details open class="astro-3ii7xxms"> <summary class="astro-3ii7xxms"> <span class="group-label astro-3ii7xxms"> <span class="large astro-3ii7xxms">Get started</span>  </span> <svg aria-hidden="true" class="caret astro-3ii7xxms astro-c6vsoqas" width="16" height="16" viewBox="0 0 24 24" fill="currentColor" style="--sl-icon-size: 1.25rem;"><path d="m14.83 11.29-4.24-4.24a1 1 0 1 0-1.42 1.41L12.71 12l-3.54 3.54a1 1 0 0 0 0 1.41 1 1 0 0 0 .71.29 1 1 0 0 0 .71-.29l4.24-4.24a1.002 1.002 0 0 0 0-1.42Z"/></svg> </summary> <sl-sidebar-restore data-index="1"></sl-sidebar-restore> <ul class="astro-3ii7xxms"> <li class="astro-3ii7xxms"> <a href="/docs/get-started/" aria-current="false" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">Gemini CLI quickstart</span>  </a> </li><li class="astro-3ii7xxms"> <a href="/docs/get-started/gemini-3/" aria-current="false" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">Gemini 3 on Gemini CLI</span>  </a> </li><li class="astro-3ii7xxms"> <a href="/docs/get-started/authentication/" aria-current="false" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">Authentication</span>  </a> </li><li class="astro-3ii7xxms"> <a href="/docs/get-started/configuration/" aria-current="false" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">Configuration</span>  </a> </li><li class="astro-3ii7xxms"> <a href="/docs/get-started/installation/" aria-current="false" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">Installation</span>  </a> </li><li class="astro-3ii7xxms"> <a href="/docs/get-started/examples/" aria-current="false" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">Examples</span>  </a> </li> </ul>  </details> </li><li class="astro-3ii7xxms"> <details open class="astro-3ii7xxms"> <summary class="astro-3ii7xxms"> <span class="group-label astro-3ii7xxms"> <span class="large astro-3ii7xxms">CLI</span>  </span> <svg aria-hidden="true" class="caret astro-3ii7xxms astro-c6vsoqas" width="16" height="16" viewBox="0 0 24 24" fill="currentColor" style="--sl-icon-size: 1.25rem;"><path d="m14.83 11.29-4.24-4.24a1 1 0 1 0-1.42 1.41L12.71 12l-3.54 3.54a1 1 0 0 0 0 1.41 1 1 0 0 0 .71.29 1 1 0 0 0 .71-.29l4.24-4.24a1.002 1.002 0 0 0 0-1.42Z"/></svg> </summary> <sl-sidebar-restore data-index="2"></sl-sidebar-restore> <ul class="astro-3ii7xxms"> <li class="astro-3ii7xxms"> <a href="/docs/cli/" aria-current="false" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">Introduction</span>  </a> </li><li class="astro-3ii7xxms"> <a href="/docs/cli/commands/" aria-current="false" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">Commands</span>  </a> </li><li class="astro-3ii7xxms"> <a href="/docs/cli/checkpointing/" aria-current="false" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">Checkpointing</span>  </a> </li><li class="astro-3ii7xxms"> <a href="/docs/cli/custom-commands/" aria-current="false" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">Custom commands</span>  </a> </li><li class="astro-3ii7xxms"> <a href="/docs/cli/enterprise/" aria-current="false" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">Enterprise</span>  </a> </li><li class="astro-3ii7xxms"> <a href="/docs/cli/headless/" aria-current="false" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">Headless mode</span>  </a> </li><li class="astro-3ii7xxms"> <a href="/docs/cli/keyboard-shortcuts/" aria-current="false" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">Keyboard shortcuts</span>  </a> </li><li class="astro-3ii7xxms"> <a href="/docs/cli/model/" aria-current="false" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">Model selection</span>  </a> </li><li class="astro-3ii7xxms"> <a href="/docs/cli/sandbox/" aria-current="false" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">Sandbox</span>  </a> </li><li class="astro-3ii7xxms"> <a href="/docs/cli/session-management/" aria-current="false" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">Session Management</span>  </a> </li><li class="astro-3ii7xxms"> <a href="/docs/cli/settings/" aria-current="false" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">Settings</span>  </a> </li><li class="astro-3ii7xxms"> <a href="/docs/cli/telemetry/" aria-current="false" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">Telemetry</span>  </a> </li><li class="astro-3ii7xxms"> <a href="/docs/cli/themes/" aria-current="false" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">Themes</span>  </a> </li><li class="astro-3ii7xxms"> <a href="/docs/cli/token-caching/" aria-current="false" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">Token caching</span>  </a> </li><li class="astro-3ii7xxms"> <a href="/docs/cli/trusted-folders/" aria-current="false" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">Trusted Folders</span>  </a> </li><li class="astro-3ii7xxms"> <a href="/docs/cli/tutorials/" aria-current="false" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">Tutorials</span>  </a> </li><li class="astro-3ii7xxms"> <a href="/docs/cli/uninstall/" aria-current="false" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">Uninstall</span>  </a> </li><li class="astro-3ii7xxms"> <a href="/docs/cli/system-prompt/" aria-current="false" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">System prompt override</span>  </a> </li> </ul>  </details> </li><li class="astro-3ii7xxms"> <details open class="astro-3ii7xxms"> <summary class="astro-3ii7xxms"> <span class="group-label astro-3ii7xxms"> <span class="large astro-3ii7xxms">Core</span>  </span> <svg aria-hidden="true" class="caret astro-3ii7xxms astro-c6vsoqas" width="16" height="16" viewBox="0 0 24 24" fill="currentColor" style="--sl-icon-size: 1.25rem;"><path d="m14.83 11.29-4.24-4.24a1 1 0 1 0-1.42 1.41L12.71 12l-3.54 3.54a1 1 0 0 0 0 1.41 1 1 0 0 0 .71.29 1 1 0 0 0 .71-.29l4.24-4.24a1.002 1.002 0 0 0 0-1.42Z"/></svg> </summary> <sl-sidebar-restore data-index="3"></sl-sidebar-restore> <ul class="astro-3ii7xxms"> <li class="astro-3ii7xxms"> <a href="/docs/core/" aria-current="false" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">Introduction</span>  </a> </li><li class="astro-3ii7xxms"> <a href="/docs/core/tools-api/" aria-current="false" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">Tools API</span>  </a> </li><li class="astro-3ii7xxms"> <a href="/docs/core/memport/" aria-current="false" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">Memory Import Processor</span>  </a> </li><li class="astro-3ii7xxms"> <a href="/docs/core/policy-engine/" aria-current="false" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">Policy Engine</span>  </a> </li> </ul>  </details> </li><li class="astro-3ii7xxms"> <details open class="astro-3ii7xxms"> <summary class="astro-3ii7xxms"> <span class="group-label astro-3ii7xxms"> <span class="large astro-3ii7xxms">Tools</span>  </span> <svg aria-hidden="true" class="caret astro-3ii7xxms astro-c6vsoqas" width="16" height="16" viewBox="0 0 24 24" fill="currentColor" style="--sl-icon-size: 1.25rem;"><path d="m14.83 11.29-4.24-4.24a1 1 0 1 0-1.42 1.41L12.71 12l-3.54 3.54a1 1 0 0 0 0 1.41 1 1 0 0 0 .71.29 1 1 0 0 0 .71-.29l4.24-4.24a1.002 1.002 0 0 0 0-1.42Z"/></svg> </summary> <sl-sidebar-restore data-index="4"></sl-sidebar-restore> <ul class="astro-3ii7xxms"> <li class="astro-3ii7xxms"> <a href="/docs/tools/" aria-current="false" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">Introduction</span>  </a> </li><li class="astro-3ii7xxms"> <a href="/docs/tools/file-system/" aria-current="false" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">File system</span>  </a> </li><li class="astro-3ii7xxms"> <a href="/docs/tools/shell/" aria-current="false" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">Shell</span>  </a> </li><li class="astro-3ii7xxms"> <a href="/docs/tools/web-fetch/" aria-current="false" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">Web fetch</span>  </a> </li><li class="astro-3ii7xxms"> <a href="/docs/tools/web-search/" aria-current="false" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">Web search</span>  </a> </li><li class="astro-3ii7xxms"> <a href="/docs/tools/memory/" aria-current="false" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">Memory</span>  </a> </li><li class="astro-3ii7xxms"> <a href="/docs/tools/todos/" aria-current="false" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">Todos</span>  </a> </li><li class="astro-3ii7xxms"> <a href="/docs/tools/mcp-server/" aria-current="page" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">MCP servers</span>  </a> </li> </ul>  </details> </li><li class="astro-3ii7xxms"> <details open class="astro-3ii7xxms"> <summary class="astro-3ii7xxms"> <span class="group-label astro-3ii7xxms"> <span class="large astro-3ii7xxms">Extensions</span>  </span> <svg aria-hidden="true" class="caret astro-3ii7xxms astro-c6vsoqas" width="16" height="16" viewBox="0 0 24 24" fill="currentColor" style="--sl-icon-size: 1.25rem;"><path d="m14.83 11.29-4.24-4.24a1 1 0 1 0-1.42 1.41L12.71 12l-3.54 3.54a1 1 0 0 0 0 1.41 1 1 0 0 0 .71.29 1 1 0 0 0 .71-.29l4.24-4.24a1.002 1.002 0 0 0 0-1.42Z"/></svg> </summary> <sl-sidebar-restore data-index="5"></sl-sidebar-restore> <ul class="astro-3ii7xxms"> <li class="astro-3ii7xxms"> <a href="/docs/extensions/" aria-current="false" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">Introduction</span>  </a> </li><li class="astro-3ii7xxms"> <a href="/docs/extensions/getting-started-extensions/" aria-current="false" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">Get started with extensions</span>  </a> </li><li class="astro-3ii7xxms"> <a href="/docs/extensions/extension-releasing/" aria-current="false" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">Extension releasing</span>  </a> </li> </ul>  </details> </li><li class="astro-3ii7xxms"> <details open class="astro-3ii7xxms"> <summary class="astro-3ii7xxms"> <span class="group-label astro-3ii7xxms"> <span class="large astro-3ii7xxms">Hooks</span>  </span> <svg aria-hidden="true" class="caret astro-3ii7xxms astro-c6vsoqas" width="16" height="16" viewBox="0 0 24 24" fill="currentColor" style="--sl-icon-size: 1.25rem;"><path d="m14.83 11.29-4.24-4.24a1 1 0 1 0-1.42 1.41L12.71 12l-3.54 3.54a1 1 0 0 0 0 1.41 1 1 0 0 0 .71.29 1 1 0 0 0 .71-.29l4.24-4.24a1.002 1.002 0 0 0 0-1.42Z"/></svg> </summary> <sl-sidebar-restore data-index="6"></sl-sidebar-restore> <ul class="astro-3ii7xxms"> <li class="astro-3ii7xxms"> <a href="/docs/hooks/" aria-current="false" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">Introduction</span>  </a> </li><li class="astro-3ii7xxms"> <a href="/docs/hooks/writing-hooks/" aria-current="false" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">Writing hooks</span>  </a> </li><li class="astro-3ii7xxms"> <a href="/docs/hooks/reference/" aria-current="false" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">Hooks reference</span>  </a> </li><li class="astro-3ii7xxms"> <a href="/docs/hooks/best-practices/" aria-current="false" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">Best practices</span>  </a> </li> </ul>  </details> </li><li class="astro-3ii7xxms"> <details open class="astro-3ii7xxms"> <summary class="astro-3ii7xxms"> <span class="group-label astro-3ii7xxms"> <span class="large astro-3ii7xxms">IDE integration</span>  </span> <svg aria-hidden="true" class="caret astro-3ii7xxms astro-c6vsoqas" width="16" height="16" viewBox="0 0 24 24" fill="currentColor" style="--sl-icon-size: 1.25rem;"><path d="m14.83 11.29-4.24-4.24a1 1 0 1 0-1.42 1.41L12.71 12l-3.54 3.54a1 1 0 0 0 0 1.41 1 1 0 0 0 .71.29 1 1 0 0 0 .71-.29l4.24-4.24a1.002 1.002 0 0 0 0-1.42Z"/></svg> </summary> <sl-sidebar-restore data-index="7"></sl-sidebar-restore> <ul class="astro-3ii7xxms"> <li class="astro-3ii7xxms"> <a href="/docs/ide-integration/" aria-current="false" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">Introduction</span>  </a> </li><li class="astro-3ii7xxms"> <a href="/docs/ide-integration/ide-companion-spec/" aria-current="false" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">IDE companion spec</span>  </a> </li> </ul>  </details> </li><li class="astro-3ii7xxms"> <details open class="astro-3ii7xxms"> <summary class="astro-3ii7xxms"> <span class="group-label astro-3ii7xxms"> <span class="large astro-3ii7xxms">Development</span>  </span> <svg aria-hidden="true" class="caret astro-3ii7xxms astro-c6vsoqas" width="16" height="16" viewBox="0 0 24 24" fill="currentColor" style="--sl-icon-size: 1.25rem;"><path d="m14.83 11.29-4.24-4.24a1 1 0 1 0-1.42 1.41L12.71 12l-3.54 3.54a1 1 0 0 0 0 1.41 1 1 0 0 0 .71.29 1 1 0 0 0 .71-.29l4.24-4.24a1.002 1.002 0 0 0 0-1.42Z"/></svg> </summary> <sl-sidebar-restore data-index="8"></sl-sidebar-restore> <ul class="astro-3ii7xxms"> <li class="astro-3ii7xxms"> <a href="/docs/npm/" aria-current="false" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">NPM</span>  </a> </li><li class="astro-3ii7xxms"> <a href="/docs/releases/" aria-current="false" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">Releases</span>  </a> </li><li class="astro-3ii7xxms"> <a href="/docs/integration-tests/" aria-current="false" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">Integration tests</span>  </a> </li><li class="astro-3ii7xxms"> <a href="/docs/issue-and-pr-automation/" aria-current="false" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">Issue and PR automation</span>  </a> </li> </ul>  </details> </li><li class="astro-3ii7xxms"> <details open class="astro-3ii7xxms"> <summary class="astro-3ii7xxms"> <span class="group-label astro-3ii7xxms"> <span class="large astro-3ii7xxms">Releases</span>  </span> <svg aria-hidden="true" class="caret astro-3ii7xxms astro-c6vsoqas" width="16" height="16" viewBox="0 0 24 24" fill="currentColor" style="--sl-icon-size: 1.25rem;"><path d="m14.83 11.29-4.24-4.24a1 1 0 1 0-1.42 1.41L12.71 12l-3.54 3.54a1 1 0 0 0 0 1.41 1 1 0 0 0 .71.29 1 1 0 0 0 .71-.29l4.24-4.24a1.002 1.002 0 0 0 0-1.42Z"/></svg> </summary> <sl-sidebar-restore data-index="9"></sl-sidebar-restore> <ul class="astro-3ii7xxms"> <li class="astro-3ii7xxms"> <a href="/docs/changelogs/" aria-current="false" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">Release notes</span>  </a> </li><li class="astro-3ii7xxms"> <a href="/docs/changelogs/latest/" aria-current="false" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">Latest release</span>  </a> </li><li class="astro-3ii7xxms"> <a href="/docs/changelogs/preview/" aria-current="false" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">Preview release</span>  </a> </li><li class="astro-3ii7xxms"> <a href="/docs/changelogs/releases/" aria-current="false" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">Changelog</span>  </a> </li> </ul>  </details> </li><li class="astro-3ii7xxms"> <details open class="astro-3ii7xxms"> <summary class="astro-3ii7xxms"> <span class="group-label astro-3ii7xxms"> <span class="large astro-3ii7xxms">Support</span>  </span> <svg aria-hidden="true" class="caret astro-3ii7xxms astro-c6vsoqas" width="16" height="16" viewBox="0 0 24 24" fill="currentColor" style="--sl-icon-size: 1.25rem;"><path d="m14.83 11.29-4.24-4.24a1 1 0 1 0-1.42 1.41L12.71 12l-3.54 3.54a1 1 0 0 0 0 1.41 1 1 0 0 0 .71.29 1 1 0 0 0 .71-.29l4.24-4.24a1.002 1.002 0 0 0 0-1.42Z"/></svg> </summary> <sl-sidebar-restore data-index="10"></sl-sidebar-restore> <ul class="astro-3ii7xxms"> <li class="astro-3ii7xxms"> <a href="/docs/faq/" aria-current="false" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">FAQ</span>  </a> </li><li class="astro-3ii7xxms"> <a href="/docs/troubleshooting/" aria-current="false" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">Troubleshooting</span>  </a> </li><li class="astro-3ii7xxms"> <a href="/docs/quota-and-pricing/" aria-current="false" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">Quota and pricing</span>  </a> </li><li class="astro-3ii7xxms"> <a href="/docs/tos-privacy/" aria-current="false" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">Terms of service</span>  </a> </li> </ul>  </details> </li> </ul>   <script aria-hidden="true">
		(() => {
			const scroller = document.getElementById('starlight__sidebar');
			if (!window._starlightScrollRestore || !scroller) return;
			scroller.scrollTop = window._starlightScrollRestore;
			delete window._starlightScrollRestore;
		})();
	</script> </sl-sidebar-state-persist>  <div class="md:sl-hidden"> <div class="mobile-preferences sl-flex astro-wu23bvmt"> <div class="social-icons astro-wu23bvmt"> <a href="https://github.com/google-gemini/gemini-cli" rel="me" class="sl-flex astro-wy4te6ga"><span class="sr-only astro-wy4te6ga">GitHub</span><svg aria-hidden="true" class="astro-wy4te6ga astro-c6vsoqas" width="16" height="16" viewBox="0 0 24 24" fill="currentColor" style="--sl-icon-size: 1em;"><path d="M12 .3a12 12 0 0 0-3.8 23.38c.6.12.83-.26.83-.57L9 21.07c-3.34.72-4.04-1.61-4.04-1.61-.55-1.39-1.34-1.76-1.34-1.76-1.08-.74.09-.73.09-.73 1.2.09 1.83 1.24 1.83 1.24 1.08 1.83 2.81 1.3 3.5 1 .1-.78.42-1.31.76-1.61-2.67-.3-5.47-1.33-5.47-5.93 0-1.31.47-2.38 1.24-3.22-.14-.3-.54-1.52.1-3.18 0 0 1-.32 3.3 1.23a11.5 11.5 0 0 1 6 0c2.28-1.55 3.29-1.23 3.29-1.23.64 1.66.24 2.88.12 3.18a4.65 4.65 0 0 1 1.23 3.22c0 4.61-2.8 5.63-5.48 5.92.42.36.81 1.1.81 2.22l-.01 3.29c0 .31.2.69.82.57A12 12 0 0 0 12 .3Z"/></svg></a> </div> <starlight-theme-select>  <label style="--sl-select-width: 6.25em" class="astro-4yphtoen"> <span class="sr-only astro-4yphtoen">Select theme</span> <svg aria-hidden="true" class="icon label-icon astro-4yphtoen astro-c6vsoqas" width="16" height="16" viewBox="0 0 24 24" fill="currentColor" style="--sl-icon-size: 1em;"><path d="M21 14h-1V7a3 3 0 0 0-3-3H7a3 3 0 0 0-3 3v7H3a1 1 0 0 0-1 1v2a3 3 0 0 0 3 3h14a3 3 0 0 0 3-3v-2a1 1 0 0 0-1-1ZM6 7a1 1 0 0 1 1-1h10a1 1 0 0 1 1 1v7H6V7Zm14 10a1 1 0 0 1-1 1H5a1 1 0 0 1-1-1v-1h16v1Z"/></svg> <select autocomplete="off" class="astro-4yphtoen"> <option value="dark" class="astro-4yphtoen">Dark</option><option value="light" class="astro-4yphtoen">Light</option><option value="auto" selected class="astro-4yphtoen">Auto</option> </select> <svg aria-hidden="true" class="icon caret astro-4yphtoen astro-c6vsoqas" width="16" height="16" viewBox="0 0 24 24" fill="currentColor" style="--sl-icon-size: 1em;"><path d="M17 9.17a1 1 0 0 0-1.41 0L12 12.71 8.46 9.17a1 1 0 1 0-1.41 1.42l4.24 4.24a1.002 1.002 0 0 0 1.42 0L17 10.59a1.002 1.002 0 0 0 0-1.42Z"/></svg> </label>  </starlight-theme-select>  <script>
	StarlightThemeProvider.updatePickers();
</script>   </div>  </div> </div> </div> </nav> <!-- Main grows to push footer down --> <div class="main-frame astro-yriad4ts">   <script type="module">const a=document.getElementById("starlight__sidebar"),n=a?.querySelector("sl-sidebar-state-persist"),o="sl-sidebar-state",i=()=>{let t=[];const e=n?.dataset.hash||"";try{const s=sessionStorage.getItem(o),r=JSON.parse(s||"{}");Array.isArray(r.open)&&r.hash===e&&(t=r.open)}catch{}return{hash:e,open:t,scroll:a?.scrollTop||0}},c=t=>{try{sessionStorage.setItem(o,JSON.stringify(t))}catch{}},d=()=>c(i()),l=(t,e)=>{const s=i();s.open[e]=t,c(s)};n?.addEventListener("click",t=>{if(!(t.target instanceof Element))return;const e=t.target.closest("summary")?.closest("details");if(!e)return;const s=e.querySelector("sl-sidebar-restore"),r=parseInt(s?.dataset.index||"");isNaN(r)||l(!e.open,r)});addEventListener("visibilitychange",()=>{document.visibilityState==="hidden"&&d()});addEventListener("pageHide",d);</script> <div class="lg:sl-flex astro-67yu43on"> <aside class="right-sidebar-container print:hidden astro-67yu43on"> <div class="right-sidebar astro-67yu43on"> <div class="lg:sl-hidden astro-pb3aqygn"><mobile-starlight-toc data-min-h="2" data-max-h="3" class="astro-doynk5tl"><nav aria-labelledby="starlight__on-this-page--mobile" class="astro-doynk5tl"><details id="starlight__mobile-toc" class="astro-doynk5tl"><summary id="starlight__on-this-page--mobile" class="sl-flex astro-doynk5tl"><span class="toggle sl-flex astro-doynk5tl">On this page<svg aria-hidden="true" class="caret astro-doynk5tl astro-c6vsoqas" width="16" height="16" viewBox="0 0 24 24" fill="currentColor" style="--sl-icon-size: 1rem;"><path d="m14.83 11.29-4.24-4.24a1 1 0 1 0-1.42 1.41L12.71 12l-3.54 3.54a1 1 0 0 0 0 1.41 1 1 0 0 0 .71.29 1 1 0 0 0 .71-.29l4.24-4.24a1.002 1.002 0 0 0 0-1.42Z"/></svg></span><span class="display-current astro-doynk5tl"></span></summary><div class="dropdown astro-doynk5tl"><ul class="isMobile astro-g2bywc46" style="--depth: 0;"> <li class="astro-g2bywc46" style="--depth: 0;"> <a href="#_top" class="astro-g2bywc46" style="--depth: 0;"> <span class="astro-g2bywc46" style="--depth: 0;">Introduction</span> </a>  </li><li class="astro-g2bywc46" style="--depth: 0;"> <a href="#what-is-an-mcp-server" class="astro-g2bywc46" style="--depth: 0;"> <span class="astro-g2bywc46" style="--depth: 0;">What is an MCP server?</span> </a>  </li><li class="astro-g2bywc46" style="--depth: 0;"> <a href="#core-integration-architecture" class="astro-g2bywc46" style="--depth: 0;"> <span class="astro-g2bywc46" style="--depth: 0;">Core integration architecture</span> </a> <ul class="isMobile astro-g2bywc46" style="--depth: 1;"> <li class="astro-g2bywc46" style="--depth: 1;"> <a href="#discovery-layer-mcp-clientts" class="astro-g2bywc46" style="--depth: 1;"> <span class="astro-g2bywc46" style="--depth: 1;">Discovery Layer (mcp-client.ts)</span> </a>  </li><li class="astro-g2bywc46" style="--depth: 1;"> <a href="#execution-layer-mcp-toolts" class="astro-g2bywc46" style="--depth: 1;"> <span class="astro-g2bywc46" style="--depth: 1;">Execution layer (mcp-tool.ts)</span> </a>  </li><li class="astro-g2bywc46" style="--depth: 1;"> <a href="#transport-mechanisms" class="astro-g2bywc46" style="--depth: 1;"> <span class="astro-g2bywc46" style="--depth: 1;">Transport mechanisms</span> </a>  </li> </ul>  </li><li class="astro-g2bywc46" style="--depth: 0;"> <a href="#working-with-mcp-resources" class="astro-g2bywc46" style="--depth: 0;"> <span class="astro-g2bywc46" style="--depth: 0;">Working with MCP resources</span> </a> <ul class="isMobile astro-g2bywc46" style="--depth: 1;"> <li class="astro-g2bywc46" style="--depth: 1;"> <a href="#discovery-and-listing" class="astro-g2bywc46" style="--depth: 1;"> <span class="astro-g2bywc46" style="--depth: 1;">Discovery and listing</span> </a>  </li><li class="astro-g2bywc46" style="--depth: 1;"> <a href="#referencing-resources-in-a-conversation" class="astro-g2bywc46" style="--depth: 1;"> <span class="astro-g2bywc46" style="--depth: 1;">Referencing resources in a conversation</span> </a>  </li> </ul>  </li><li class="astro-g2bywc46" style="--depth: 0;"> <a href="#how-to-set-up-your-mcp-server" class="astro-g2bywc46" style="--depth: 0;"> <span class="astro-g2bywc46" style="--depth: 0;">How to set up your MCP server</span> </a> <ul class="isMobile astro-g2bywc46" style="--depth: 1;"> <li class="astro-g2bywc46" style="--depth: 1;"> <a href="#configure-the-mcp-server-in-settingsjson" class="astro-g2bywc46" style="--depth: 1;"> <span class="astro-g2bywc46" style="--depth: 1;">Configure the MCP server in settings.json</span> </a>  </li><li class="astro-g2bywc46" style="--depth: 1;"> <a href="#configuration-structure" class="astro-g2bywc46" style="--depth: 1;"> <span class="astro-g2bywc46" style="--depth: 1;">Configuration structure</span> </a>  </li><li class="astro-g2bywc46" style="--depth: 1;"> <a href="#configuration-properties" class="astro-g2bywc46" style="--depth: 1;"> <span class="astro-g2bywc46" style="--depth: 1;">Configuration properties</span> </a>  </li><li class="astro-g2bywc46" style="--depth: 1;"> <a href="#oauth-support-for-remote-mcp-servers" class="astro-g2bywc46" style="--depth: 1;"> <span class="astro-g2bywc46" style="--depth: 1;">OAuth support for remote MCP servers</span> </a>  </li><li class="astro-g2bywc46" style="--depth: 1;"> <a href="#example-configurations" class="astro-g2bywc46" style="--depth: 1;"> <span class="astro-g2bywc46" style="--depth: 1;">Example configurations</span> </a>  </li><li class="astro-g2bywc46" style="--depth: 1;"> <a href="#sse-mcp-server-with-sa-impersonation" class="astro-g2bywc46" style="--depth: 1;"> <span class="astro-g2bywc46" style="--depth: 1;">SSE MCP server with SA impersonation</span> </a>  </li> </ul>  </li><li class="astro-g2bywc46" style="--depth: 0;"> <a href="#discovery-process-deep-dive" class="astro-g2bywc46" style="--depth: 0;"> <span class="astro-g2bywc46" style="--depth: 0;">Discovery process deep dive</span> </a> <ul class="isMobile astro-g2bywc46" style="--depth: 1;"> <li class="astro-g2bywc46" style="--depth: 1;"> <a href="#1-server-iteration-and-connection" class="astro-g2bywc46" style="--depth: 1;"> <span class="astro-g2bywc46" style="--depth: 1;">1. Server iteration and connection</span> </a>  </li><li class="astro-g2bywc46" style="--depth: 1;"> <a href="#2-tool-discovery" class="astro-g2bywc46" style="--depth: 1;"> <span class="astro-g2bywc46" style="--depth: 1;">2. Tool discovery</span> </a>  </li><li class="astro-g2bywc46" style="--depth: 1;"> <a href="#3-conflict-resolution" class="astro-g2bywc46" style="--depth: 1;"> <span class="astro-g2bywc46" style="--depth: 1;">3. Conflict resolution</span> </a>  </li><li class="astro-g2bywc46" style="--depth: 1;"> <a href="#4-schema-processing" class="astro-g2bywc46" style="--depth: 1;"> <span class="astro-g2bywc46" style="--depth: 1;">4. Schema processing</span> </a>  </li><li class="astro-g2bywc46" style="--depth: 1;"> <a href="#5-connection-management" class="astro-g2bywc46" style="--depth: 1;"> <span class="astro-g2bywc46" style="--depth: 1;">5. Connection management</span> </a>  </li> </ul>  </li><li class="astro-g2bywc46" style="--depth: 0;"> <a href="#tool-execution-flow" class="astro-g2bywc46" style="--depth: 0;"> <span class="astro-g2bywc46" style="--depth: 0;">Tool execution flow</span> </a> <ul class="isMobile astro-g2bywc46" style="--depth: 1;"> <li class="astro-g2bywc46" style="--depth: 1;"> <a href="#1-tool-invocation" class="astro-g2bywc46" style="--depth: 1;"> <span class="astro-g2bywc46" style="--depth: 1;">1. Tool invocation</span> </a>  </li><li class="astro-g2bywc46" style="--depth: 1;"> <a href="#2-confirmation-process" class="astro-g2bywc46" style="--depth: 1;"> <span class="astro-g2bywc46" style="--depth: 1;">2. Confirmation process</span> </a>  </li><li class="astro-g2bywc46" style="--depth: 1;"> <a href="#3-execution" class="astro-g2bywc46" style="--depth: 1;"> <span class="astro-g2bywc46" style="--depth: 1;">3. Execution</span> </a>  </li><li class="astro-g2bywc46" style="--depth: 1;"> <a href="#4-response-handling" class="astro-g2bywc46" style="--depth: 1;"> <span class="astro-g2bywc46" style="--depth: 1;">4. Response handling</span> </a>  </li> </ul>  </li><li class="astro-g2bywc46" style="--depth: 0;"> <a href="#how-to-interact-with-your-mcp-server" class="astro-g2bywc46" style="--depth: 0;"> <span class="astro-g2bywc46" style="--depth: 0;">How to interact with your MCP server</span> </a> <ul class="isMobile astro-g2bywc46" style="--depth: 1;"> <li class="astro-g2bywc46" style="--depth: 1;"> <a href="#using-the-mcp-command" class="astro-g2bywc46" style="--depth: 1;"> <span class="astro-g2bywc46" style="--depth: 1;">Using the /mcp command</span> </a>  </li><li class="astro-g2bywc46" style="--depth: 1;"> <a href="#example-mcp-output" class="astro-g2bywc46" style="--depth: 1;"> <span class="astro-g2bywc46" style="--depth: 1;">Example /mcp output</span> </a>  </li><li class="astro-g2bywc46" style="--depth: 1;"> <a href="#tool-usage" class="astro-g2bywc46" style="--depth: 1;"> <span class="astro-g2bywc46" style="--depth: 1;">Tool usage</span> </a>  </li> </ul>  </li><li class="astro-g2bywc46" style="--depth: 0;"> <a href="#status-monitoring-and-troubleshooting" class="astro-g2bywc46" style="--depth: 0;"> <span class="astro-g2bywc46" style="--depth: 0;">Status monitoring and troubleshooting</span> </a> <ul class="isMobile astro-g2bywc46" style="--depth: 1;"> <li class="astro-g2bywc46" style="--depth: 1;"> <a href="#connection-states" class="astro-g2bywc46" style="--depth: 1;"> <span class="astro-g2bywc46" style="--depth: 1;">Connection states</span> </a>  </li><li class="astro-g2bywc46" style="--depth: 1;"> <a href="#common-issues-and-solutions" class="astro-g2bywc46" style="--depth: 1;"> <span class="astro-g2bywc46" style="--depth: 1;">Common issues and solutions</span> </a>  </li><li class="astro-g2bywc46" style="--depth: 1;"> <a href="#debugging-tips" class="astro-g2bywc46" style="--depth: 1;"> <span class="astro-g2bywc46" style="--depth: 1;">Debugging tips</span> </a>  </li> </ul>  </li><li class="astro-g2bywc46" style="--depth: 0;"> <a href="#important-notes" class="astro-g2bywc46" style="--depth: 0;"> <span class="astro-g2bywc46" style="--depth: 0;">Important notes</span> </a> <ul class="isMobile astro-g2bywc46" style="--depth: 1;"> <li class="astro-g2bywc46" style="--depth: 1;"> <a href="#security-sonsiderations" class="astro-g2bywc46" style="--depth: 1;"> <span class="astro-g2bywc46" style="--depth: 1;">Security sonsiderations</span> </a>  </li><li class="astro-g2bywc46" style="--depth: 1;"> <a href="#performance-and-resource-management" class="astro-g2bywc46" style="--depth: 1;"> <span class="astro-g2bywc46" style="--depth: 1;">Performance and resource management</span> </a>  </li><li class="astro-g2bywc46" style="--depth: 1;"> <a href="#schema-compatibility" class="astro-g2bywc46" style="--depth: 1;"> <span class="astro-g2bywc46" style="--depth: 1;">Schema compatibility</span> </a>  </li> </ul>  </li><li class="astro-g2bywc46" style="--depth: 0;"> <a href="#returning-rich-content-from-tools" class="astro-g2bywc46" style="--depth: 0;"> <span class="astro-g2bywc46" style="--depth: 0;">Returning rich content from tools</span> </a> <ul class="isMobile astro-g2bywc46" style="--depth: 1;"> <li class="astro-g2bywc46" style="--depth: 1;"> <a href="#how-it-works" class="astro-g2bywc46" style="--depth: 1;"> <span class="astro-g2bywc46" style="--depth: 1;">How it works</span> </a>  </li><li class="astro-g2bywc46" style="--depth: 1;"> <a href="#example-returning-text-and-an-image" class="astro-g2bywc46" style="--depth: 1;"> <span class="astro-g2bywc46" style="--depth: 1;">Example: Returning text and an image</span> </a>  </li> </ul>  </li><li class="astro-g2bywc46" style="--depth: 0;"> <a href="#mcp-prompts-as-slash-commands" class="astro-g2bywc46" style="--depth: 0;"> <span class="astro-g2bywc46" style="--depth: 0;">MCP prompts as slash commands</span> </a> <ul class="isMobile astro-g2bywc46" style="--depth: 1;"> <li class="astro-g2bywc46" style="--depth: 1;"> <a href="#defining-prompts-on-the-server" class="astro-g2bywc46" style="--depth: 1;"> <span class="astro-g2bywc46" style="--depth: 1;">Defining prompts on the server</span> </a>  </li><li class="astro-g2bywc46" style="--depth: 1;"> <a href="#invoking-prompts" class="astro-g2bywc46" style="--depth: 1;"> <span class="astro-g2bywc46" style="--depth: 1;">Invoking prompts</span> </a>  </li> </ul>  </li><li class="astro-g2bywc46" style="--depth: 0;"> <a href="#managing-mcp-servers-with-gemini-mcp" class="astro-g2bywc46" style="--depth: 0;"> <span class="astro-g2bywc46" style="--depth: 0;">Managing MCP servers with gemini mcp</span> </a> <ul class="isMobile astro-g2bywc46" style="--depth: 1;"> <li class="astro-g2bywc46" style="--depth: 1;"> <a href="#adding-a-server-gemini-mcp-add" class="astro-g2bywc46" style="--depth: 1;"> <span class="astro-g2bywc46" style="--depth: 1;">Adding a server (gemini mcp add)</span> </a>  </li><li class="astro-g2bywc46" style="--depth: 1;"> <a href="#listing-servers-gemini-mcp-list" class="astro-g2bywc46" style="--depth: 1;"> <span class="astro-g2bywc46" style="--depth: 1;">Listing servers (gemini mcp list)</span> </a>  </li><li class="astro-g2bywc46" style="--depth: 1;"> <a href="#removing-a-server-gemini-mcp-remove" class="astro-g2bywc46" style="--depth: 1;"> <span class="astro-g2bywc46" style="--depth: 1;">Removing a server (gemini mcp remove)</span> </a>  </li> </ul>  </li><li class="astro-g2bywc46" style="--depth: 0;"> <a href="#instructions" class="astro-g2bywc46" style="--depth: 0;"> <span class="astro-g2bywc46" style="--depth: 0;">Instructions</span> </a>  </li> </ul> </div></details></nav></mobile-starlight-toc><script type="module" src="/_astro/MobileTableOfContents.astro_astro_type_script_index_0_lang.C181hMzK.js"></script></div><div class="right-sidebar-panel sl-hidden lg:sl-block astro-pb3aqygn"><div class="sl-container astro-pb3aqygn"><starlight-toc data-min-h="2" data-max-h="3"><nav aria-labelledby="starlight__on-this-page"><h2 id="starlight__on-this-page">On this page</h2><ul class="astro-g2bywc46" style="--depth: 0;"> <li class="astro-g2bywc46" style="--depth: 0;"> <a href="#_top" class="astro-g2bywc46" style="--depth: 0;"> <span class="astro-g2bywc46" style="--depth: 0;">Introduction</span> </a>  </li><li class="astro-g2bywc46" style="--depth: 0;"> <a href="#what-is-an-mcp-server" class="astro-g2bywc46" style="--depth: 0;"> <span class="astro-g2bywc46" style="--depth: 0;">What is an MCP server?</span> </a>  </li><li class="astro-g2bywc46" style="--depth: 0;"> <a href="#core-integration-architecture" class="astro-g2bywc46" style="--depth: 0;"> <span class="astro-g2bywc46" style="--depth: 0;">Core integration architecture</span> </a> <ul class="astro-g2bywc46" style="--depth: 1;"> <li class="astro-g2bywc46" style="--depth: 1;"> <a href="#discovery-layer-mcp-clientts" class="astro-g2bywc46" style="--depth: 1;"> <span class="astro-g2bywc46" style="--depth: 1;">Discovery Layer (mcp-client.ts)</span> </a>  </li><li class="astro-g2bywc46" style="--depth: 1;"> <a href="#execution-layer-mcp-toolts" class="astro-g2bywc46" style="--depth: 1;"> <span class="astro-g2bywc46" style="--depth: 1;">Execution layer (mcp-tool.ts)</span> </a>  </li><li class="astro-g2bywc46" style="--depth: 1;"> <a href="#transport-mechanisms" class="astro-g2bywc46" style="--depth: 1;"> <span class="astro-g2bywc46" style="--depth: 1;">Transport mechanisms</span> </a>  </li> </ul>  </li><li class="astro-g2bywc46" style="--depth: 0;"> <a href="#working-with-mcp-resources" class="astro-g2bywc46" style="--depth: 0;"> <span class="astro-g2bywc46" style="--depth: 0;">Working with MCP resources</span> </a> <ul class="astro-g2bywc46" style="--depth: 1;"> <li class="astro-g2bywc46" style="--depth: 1;"> <a href="#discovery-and-listing" class="astro-g2bywc46" style="--depth: 1;"> <span class="astro-g2bywc46" style="--depth: 1;">Discovery and listing</span> </a>  </li><li class="astro-g2bywc46" style="--depth: 1;"> <a href="#referencing-resources-in-a-conversation" class="astro-g2bywc46" style="--depth: 1;"> <span class="astro-g2bywc46" style="--depth: 1;">Referencing resources in a conversation</span> </a>  </li> </ul>  </li><li class="astro-g2bywc46" style="--depth: 0;"> <a href="#how-to-set-up-your-mcp-server" class="astro-g2bywc46" style="--depth: 0;"> <span class="astro-g2bywc46" style="--depth: 0;">How to set up your MCP server</span> </a> <ul class="astro-g2bywc46" style="--depth: 1;"> <li class="astro-g2bywc46" style="--depth: 1;"> <a href="#configure-the-mcp-server-in-settingsjson" class="astro-g2bywc46" style="--depth: 1;"> <span class="astro-g2bywc46" style="--depth: 1;">Configure the MCP server in settings.json</span> </a>  </li><li class="astro-g2bywc46" style="--depth: 1;"> <a href="#configuration-structure" class="astro-g2bywc46" style="--depth: 1;"> <span class="astro-g2bywc46" style="--depth: 1;">Configuration structure</span> </a>  </li><li class="astro-g2bywc46" style="--depth: 1;"> <a href="#configuration-properties" class="astro-g2bywc46" style="--depth: 1;"> <span class="astro-g2bywc46" style="--depth: 1;">Configuration properties</span> </a>  </li><li class="astro-g2bywc46" style="--depth: 1;"> <a href="#oauth-support-for-remote-mcp-servers" class="astro-g2bywc46" style="--depth: 1;"> <span class="astro-g2bywc46" style="--depth: 1;">OAuth support for remote MCP servers</span> </a>  </li><li class="astro-g2bywc46" style="--depth: 1;"> <a href="#example-configurations" class="astro-g2bywc46" style="--depth: 1;"> <span class="astro-g2bywc46" style="--depth: 1;">Example configurations</span> </a>  </li><li class="astro-g2bywc46" style="--depth: 1;"> <a href="#sse-mcp-server-with-sa-impersonation" class="astro-g2bywc46" style="--depth: 1;"> <span class="astro-g2bywc46" style="--depth: 1;">SSE MCP server with SA impersonation</span> </a>  </li> </ul>  </li><li class="astro-g2bywc46" style="--depth: 0;"> <a href="#discovery-process-deep-dive" class="astro-g2bywc46" style="--depth: 0;"> <span class="astro-g2bywc46" style="--depth: 0;">Discovery process deep dive</span> </a> <ul class="astro-g2bywc46" style="--depth: 1;"> <li class="astro-g2bywc46" style="--depth: 1;"> <a href="#1-server-iteration-and-connection" class="astro-g2bywc46" style="--depth: 1;"> <span class="astro-g2bywc46" style="--depth: 1;">1. Server iteration and connection</span> </a>  </li><li class="astro-g2bywc46" style="--depth: 1;"> <a href="#2-tool-discovery" class="astro-g2bywc46" style="--depth: 1;"> <span class="astro-g2bywc46" style="--depth: 1;">2. Tool discovery</span> </a>  </li><li class="astro-g2bywc46" style="--depth: 1;"> <a href="#3-conflict-resolution" class="astro-g2bywc46" style="--depth: 1;"> <span class="astro-g2bywc46" style="--depth: 1;">3. Conflict resolution</span> </a>  </li><li class="astro-g2bywc46" style="--depth: 1;"> <a href="#4-schema-processing" class="astro-g2bywc46" style="--depth: 1;"> <span class="astro-g2bywc46" style="--depth: 1;">4. Schema processing</span> </a>  </li><li class="astro-g2bywc46" style="--depth: 1;"> <a href="#5-connection-management" class="astro-g2bywc46" style="--depth: 1;"> <span class="astro-g2bywc46" style="--depth: 1;">5. Connection management</span> </a>  </li> </ul>  </li><li class="astro-g2bywc46" style="--depth: 0;"> <a href="#tool-execution-flow" class="astro-g2bywc46" style="--depth: 0;"> <span class="astro-g2bywc46" style="--depth: 0;">Tool execution flow</span> </a> <ul class="astro-g2bywc46" style="--depth: 1;"> <li class="astro-g2bywc46" style="--depth: 1;"> <a href="#1-tool-invocation" class="astro-g2bywc46" style="--depth: 1;"> <span class="astro-g2bywc46" style="--depth: 1;">1. Tool invocation</span> </a>  </li><li class="astro-g2bywc46" style="--depth: 1;"> <a href="#2-confirmation-process" class="astro-g2bywc46" style="--depth: 1;"> <span class="astro-g2bywc46" style="--depth: 1;">2. Confirmation process</span> </a>  </li><li class="astro-g2bywc46" style="--depth: 1;"> <a href="#3-execution" class="astro-g2bywc46" style="--depth: 1;"> <span class="astro-g2bywc46" style="--depth: 1;">3. Execution</span> </a>  </li><li class="astro-g2bywc46" style="--depth: 1;"> <a href="#4-response-handling" class="astro-g2bywc46" style="--depth: 1;"> <span class="astro-g2bywc46" style="--depth: 1;">4. Response handling</span> </a>  </li> </ul>  </li><li class="astro-g2bywc46" style="--depth: 0;"> <a href="#how-to-interact-with-your-mcp-server" class="astro-g2bywc46" style="--depth: 0;"> <span class="astro-g2bywc46" style="--depth: 0;">How to interact with your MCP server</span> </a> <ul class="astro-g2bywc46" style="--depth: 1;"> <li class="astro-g2bywc46" style="--depth: 1;"> <a href="#using-the-mcp-command" class="astro-g2bywc46" style="--depth: 1;"> <span class="astro-g2bywc46" style="--depth: 1;">Using the /mcp command</span> </a>  </li><li class="astro-g2bywc46" style="--depth: 1;"> <a href="#example-mcp-output" class="astro-g2bywc46" style="--depth: 1;"> <span class="astro-g2bywc46" style="--depth: 1;">Example /mcp output</span> </a>  </li><li class="astro-g2bywc46" style="--depth: 1;"> <a href="#tool-usage" class="astro-g2bywc46" style="--depth: 1;"> <span class="astro-g2bywc46" style="--depth: 1;">Tool usage</span> </a>  </li> </ul>  </li><li class="astro-g2bywc46" style="--depth: 0;"> <a href="#status-monitoring-and-troubleshooting" class="astro-g2bywc46" style="--depth: 0;"> <span class="astro-g2bywc46" style="--depth: 0;">Status monitoring and troubleshooting</span> </a> <ul class="astro-g2bywc46" style="--depth: 1;"> <li class="astro-g2bywc46" style="--depth: 1;"> <a href="#connection-states" class="astro-g2bywc46" style="--depth: 1;"> <span class="astro-g2bywc46" style="--depth: 1;">Connection states</span> </a>  </li><li class="astro-g2bywc46" style="--depth: 1;"> <a href="#common-issues-and-solutions" class="astro-g2bywc46" style="--depth: 1;"> <span class="astro-g2bywc46" style="--depth: 1;">Common issues and solutions</span> </a>  </li><li class="astro-g2bywc46" style="--depth: 1;"> <a href="#debugging-tips" class="astro-g2bywc46" style="--depth: 1;"> <span class="astro-g2bywc46" style="--depth: 1;">Debugging tips</span> </a>  </li> </ul>  </li><li class="astro-g2bywc46" style="--depth: 0;"> <a href="#important-notes" class="astro-g2bywc46" style="--depth: 0;"> <span class="astro-g2bywc46" style="--depth: 0;">Important notes</span> </a> <ul class="astro-g2bywc46" style="--depth: 1;"> <li class="astro-g2bywc46" style="--depth: 1;"> <a href="#security-sonsiderations" class="astro-g2bywc46" style="--depth: 1;"> <span class="astro-g2bywc46" style="--depth: 1;">Security sonsiderations</span> </a>  </li><li class="astro-g2bywc46" style="--depth: 1;"> <a href="#performance-and-resource-management" class="astro-g2bywc46" style="--depth: 1;"> <span class="astro-g2bywc46" style="--depth: 1;">Performance and resource management</span> </a>  </li><li class="astro-g2bywc46" style="--depth: 1;"> <a href="#schema-compatibility" class="astro-g2bywc46" style="--depth: 1;"> <span class="astro-g2bywc46" style="--depth: 1;">Schema compatibility</span> </a>  </li> </ul>  </li><li class="astro-g2bywc46" style="--depth: 0;"> <a href="#returning-rich-content-from-tools" class="astro-g2bywc46" style="--depth: 0;"> <span class="astro-g2bywc46" style="--depth: 0;">Returning rich content from tools</span> </a> <ul class="astro-g2bywc46" style="--depth: 1;"> <li class="astro-g2bywc46" style="--depth: 1;"> <a href="#how-it-works" class="astro-g2bywc46" style="--depth: 1;"> <span class="astro-g2bywc46" style="--depth: 1;">How it works</span> </a>  </li><li class="astro-g2bywc46" style="--depth: 1;"> <a href="#example-returning-text-and-an-image" class="astro-g2bywc46" style="--depth: 1;"> <span class="astro-g2bywc46" style="--depth: 1;">Example: Returning text and an image</span> </a>  </li> </ul>  </li><li class="astro-g2bywc46" style="--depth: 0;"> <a href="#mcp-prompts-as-slash-commands" class="astro-g2bywc46" style="--depth: 0;"> <span class="astro-g2bywc46" style="--depth: 0;">MCP prompts as slash commands</span> </a> <ul class="astro-g2bywc46" style="--depth: 1;"> <li class="astro-g2bywc46" style="--depth: 1;"> <a href="#defining-prompts-on-the-server" class="astro-g2bywc46" style="--depth: 1;"> <span class="astro-g2bywc46" style="--depth: 1;">Defining prompts on the server</span> </a>  </li><li class="astro-g2bywc46" style="--depth: 1;"> <a href="#invoking-prompts" class="astro-g2bywc46" style="--depth: 1;"> <span class="astro-g2bywc46" style="--depth: 1;">Invoking prompts</span> </a>  </li> </ul>  </li><li class="astro-g2bywc46" style="--depth: 0;"> <a href="#managing-mcp-servers-with-gemini-mcp" class="astro-g2bywc46" style="--depth: 0;"> <span class="astro-g2bywc46" style="--depth: 0;">Managing MCP servers with gemini mcp</span> </a> <ul class="astro-g2bywc46" style="--depth: 1;"> <li class="astro-g2bywc46" style="--depth: 1;"> <a href="#adding-a-server-gemini-mcp-add" class="astro-g2bywc46" style="--depth: 1;"> <span class="astro-g2bywc46" style="--depth: 1;">Adding a server (gemini mcp add)</span> </a>  </li><li class="astro-g2bywc46" style="--depth: 1;"> <a href="#listing-servers-gemini-mcp-list" class="astro-g2bywc46" style="--depth: 1;"> <span class="astro-g2bywc46" style="--depth: 1;">Listing servers (gemini mcp list)</span> </a>  </li><li class="astro-g2bywc46" style="--depth: 1;"> <a href="#removing-a-server-gemini-mcp-remove" class="astro-g2bywc46" style="--depth: 1;"> <span class="astro-g2bywc46" style="--depth: 1;">Removing a server (gemini mcp remove)</span> </a>  </li> </ul>  </li><li class="astro-g2bywc46" style="--depth: 0;"> <a href="#instructions" class="astro-g2bywc46" style="--depth: 0;"> <span class="astro-g2bywc46" style="--depth: 0;">Instructions</span> </a>  </li> </ul> </nav></starlight-toc><script type="module" src="/_astro/TableOfContents.astro_astro_type_script_index_0_lang.CKWWgpjV.js"></script></div></div> </div> </aside> <div class="main-pane astro-67yu43on">  <main data-pagefind-body class="astro-bguv2lll" lang="en" dir="ltr">    <div class="content-panel astro-7nkwcw3z"> <div class="sl-container astro-7nkwcw3z"> <div class="flex items-center page-title astro-guvttfii"> <h1 id="_top" class="flex-1 astro-guvttfii"> MCP servers with the Gemini CLI </h1> <div class="mt-4 astro-guvttfii"> <button id="copy-markdown-btn" class="copy-markdown-button astro-guvttfii astro-ym2cbydy" type="button" aria-label="Copy page content as markdown for selected language" title="Copy as Markdown"> <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="astro-ym2cbydy"> <rect width="14" height="14" x="8" y="8" rx="2" ry="2" class="astro-ym2cbydy"></rect> <path d="m4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2" class="astro-ym2cbydy"></path> </svg> <span class="button-text astro-ym2cbydy">Copy as Markdown</span> <span class="success-text astro-ym2cbydy" style="display: none;">Copied!</span> </button>  <script type="module">class i{constructor(){this.init()}init(){document.readyState==="loading"?document.addEventListener("DOMContentLoaded",()=>this.setupEventListeners()):this.setupEventListeners()}setupEventListeners(){const t=document.getElementById("copy-markdown-btn");t&&t.addEventListener("click",()=>this.copyMarkdown())}async copyMarkdown(){const t=document.getElementById("copy-markdown-btn");if(t)try{this.setButtonState(t,"copying");const e=`${window.location.pathname.replace(/\/$/,"")}.md`,o=await fetch(e);if(!o.ok)throw new Error(`Failed to fetch markdown: ${o.status}`);const a=await o.text();await this.copyToClipboard(a),this.setButtonState(t,"success"),setTimeout(()=>{this.setButtonState(t,"default")},2e3)}catch(n){console.error("Failed to copy markdown:",n),this.setButtonState(t,"error"),setTimeout(()=>{this.setButtonState(t,"default")},2e3)}}getCurrentLanguage(){return document.documentElement.getAttribute("data-genkit-lang")||"js"}async copyToClipboard(t){if(navigator.clipboard&&window.isSecureContext)await navigator.clipboard.writeText(t);else throw new Error("Clipboard API not available.")}setButtonState(t,n){const s=t.querySelector(".button-text"),e=t.querySelector(".success-text");switch(t.classList.remove("copying","success","error"),n){case"copying":t.classList.add("copying"),s&&(s.style.display="none"),e&&(e.textContent="Copying...",e.style.display="inline");break;case"success":t.classList.add("success"),s&&(s.style.display="none"),e&&(e.textContent="Copied!",e.style.display="inline");break;case"error":t.classList.add("error"),s&&(s.style.display="none"),e&&(e.textContent="Error",e.style.display="inline");break;default:s&&(s.style.display="inline"),e&&(e.style.display="none");break}}}new i;</script> </div> </div>  </div> </div>  <div class="content-panel astro-7nkwcw3z"> <div class="sl-container astro-7nkwcw3z"> <div class="sl-markdown-content"> <p>This document provides a guide to configuring and using Model Context Protocol
(MCP) servers with the Gemini CLI.</p>
<div class="sl-heading-wrapper level-h2"><h2 id="what-is-an-mcp-server">What is an MCP server?</h2><a class="sl-anchor-link" href="#what-is-an-mcp-server"><span aria-hidden="true" class="sl-anchor-icon"><svg width="16" height="16" viewBox="0 0 24 24"><path fill="currentcolor" d="m12.11 15.39-3.88 3.88a2.52 2.52 0 0 1-3.5 0 2.47 2.47 0 0 1 0-3.5l3.88-3.88a1 1 0 0 0-1.42-1.42l-3.88 3.89a4.48 4.48 0 0 0 6.33 6.33l3.89-3.88a1 1 0 1 0-1.42-1.42Zm8.58-12.08a4.49 4.49 0 0 0-6.33 0l-3.89 3.88a1 1 0 0 0 1.42 1.42l3.88-3.88a2.52 2.52 0 0 1 3.5 0 2.47 2.47 0 0 1 0 3.5l-3.88 3.88a1 1 0 1 0 1.42 1.42l3.88-3.89a4.49 4.49 0 0 0 0-6.33ZM8.83 15.17a1 1 0 0 0 1.1.22 1 1 0 0 0 .32-.22l4.92-4.92a1 1 0 0 0-1.42-1.42l-4.92 4.92a1 1 0 0 0 0 1.42Z"></path></svg></span><span class="sr-only">Section titled â€œWhat is an MCP server?â€</span></a></div>
<p>An MCP server is an application that exposes tools and resources to the Gemini
CLI through the Model Context Protocol, allowing it to interact with external
systems and data sources. MCP servers act as a bridge between the Gemini model
and your local environment or other services like APIs.</p>
<p>An MCP server enables the Gemini CLI to:</p>
<ul>
<li><strong>Discover tools:</strong> List available tools, their descriptions, and parameters
through standardized schema definitions.</li>
<li><strong>Execute tools:</strong> Call specific tools with defined arguments and receive
structured responses.</li>
<li><strong>Access resources:</strong> Read data from specific resources that the server
exposes (files, API payloads, reports, etc.).</li>
</ul>
<p>With an MCP server, you can extend the Gemini CLIâ€™s capabilities to perform
actions beyond its built-in features, such as interacting with databases, APIs,
custom scripts, or specialized workflows.</p>
<div class="sl-heading-wrapper level-h2"><h2 id="core-integration-architecture">Core integration architecture</h2><a class="sl-anchor-link" href="#core-integration-architecture"><span aria-hidden="true" class="sl-anchor-icon"><svg width="16" height="16" viewBox="0 0 24 24"><path fill="currentcolor" d="m12.11 15.39-3.88 3.88a2.52 2.52 0 0 1-3.5 0 2.47 2.47 0 0 1 0-3.5l3.88-3.88a1 1 0 0 0-1.42-1.42l-3.88 3.89a4.48 4.48 0 0 0 6.33 6.33l3.89-3.88a1 1 0 1 0-1.42-1.42Zm8.58-12.08a4.49 4.49 0 0 0-6.33 0l-3.89 3.88a1 1 0 0 0 1.42 1.42l3.88-3.88a2.52 2.52 0 0 1 3.5 0 2.47 2.47 0 0 1 0 3.5l-3.88 3.88a1 1 0 1 0 1.42 1.42l3.88-3.89a4.49 4.49 0 0 0 0-6.33ZM8.83 15.17a1 1 0 0 0 1.1.22 1 1 0 0 0 .32-.22l4.92-4.92a1 1 0 0 0-1.42-1.42l-4.92 4.92a1 1 0 0 0 0 1.42Z"></path></svg></span><span class="sr-only">Section titled â€œCore integration architectureâ€</span></a></div>
<p>The Gemini CLI integrates with MCP servers through a sophisticated discovery and
execution system built into the core package (<code dir="auto">packages/core/src/tools/</code>):</p>
<div class="sl-heading-wrapper level-h3"><h3 id="discovery-layer-mcp-clientts">Discovery Layer (<code dir="auto">mcp-client.ts</code>)</h3><a class="sl-anchor-link" href="#discovery-layer-mcp-clientts"><span aria-hidden="true" class="sl-anchor-icon"><svg width="16" height="16" viewBox="0 0 24 24"><path fill="currentcolor" d="m12.11 15.39-3.88 3.88a2.52 2.52 0 0 1-3.5 0 2.47 2.47 0 0 1 0-3.5l3.88-3.88a1 1 0 0 0-1.42-1.42l-3.88 3.89a4.48 4.48 0 0 0 6.33 6.33l3.89-3.88a1 1 0 1 0-1.42-1.42Zm8.58-12.08a4.49 4.49 0 0 0-6.33 0l-3.89 3.88a1 1 0 0 0 1.42 1.42l3.88-3.88a2.52 2.52 0 0 1 3.5 0 2.47 2.47 0 0 1 0 3.5l-3.88 3.88a1 1 0 1 0 1.42 1.42l3.88-3.89a4.49 4.49 0 0 0 0-6.33ZM8.83 15.17a1 1 0 0 0 1.1.22 1 1 0 0 0 .32-.22l4.92-4.92a1 1 0 0 0-1.42-1.42l-4.92 4.92a1 1 0 0 0 0 1.42Z"></path></svg></span><span class="sr-only">Section titled â€œDiscovery Layer (mcp-client.ts)â€</span></a></div>
<p>The discovery process is orchestrated by <code dir="auto">discoverMcpTools()</code>, which:</p>
<ol>
<li><strong>Iterates through configured servers</strong> from your <code dir="auto">settings.json</code>
<code dir="auto">mcpServers</code> configuration</li>
<li><strong>Establishes connections</strong> using appropriate transport mechanisms (Stdio,
SSE, or Streamable HTTP)</li>
<li><strong>Fetches tool definitions</strong> from each server using the MCP protocol</li>
<li><strong>Sanitizes and validates</strong> tool schemas for compatibility with the Gemini
API</li>
<li><strong>Registers tools</strong> in the global tool registry with conflict resolution</li>
<li><strong>Fetches and registers resources</strong> if the server exposes any</li>
</ol>
<div class="sl-heading-wrapper level-h3"><h3 id="execution-layer-mcp-toolts">Execution layer (<code dir="auto">mcp-tool.ts</code>)</h3><a class="sl-anchor-link" href="#execution-layer-mcp-toolts"><span aria-hidden="true" class="sl-anchor-icon"><svg width="16" height="16" viewBox="0 0 24 24"><path fill="currentcolor" d="m12.11 15.39-3.88 3.88a2.52 2.52 0 0 1-3.5 0 2.47 2.47 0 0 1 0-3.5l3.88-3.88a1 1 0 0 0-1.42-1.42l-3.88 3.89a4.48 4.48 0 0 0 6.33 6.33l3.89-3.88a1 1 0 1 0-1.42-1.42Zm8.58-12.08a4.49 4.49 0 0 0-6.33 0l-3.89 3.88a1 1 0 0 0 1.42 1.42l3.88-3.88a2.52 2.52 0 0 1 3.5 0 2.47 2.47 0 0 1 0 3.5l-3.88 3.88a1 1 0 1 0 1.42 1.42l3.88-3.89a4.49 4.49 0 0 0 0-6.33ZM8.83 15.17a1 1 0 0 0 1.1.22 1 1 0 0 0 .32-.22l4.92-4.92a1 1 0 0 0-1.42-1.42l-4.92 4.92a1 1 0 0 0 0 1.42Z"></path></svg></span><span class="sr-only">Section titled â€œExecution layer (mcp-tool.ts)â€</span></a></div>
<p>Each discovered MCP tool is wrapped in a <code dir="auto">DiscoveredMCPTool</code> instance that:</p>
<ul>
<li><strong>Handles confirmation logic</strong> based on server trust settings and user
preferences</li>
<li><strong>Manages tool execution</strong> by calling the MCP server with proper parameters</li>
<li><strong>Processes responses</strong> for both the LLM context and user display</li>
<li><strong>Maintains connection state</strong> and handles timeouts</li>
</ul>
<div class="sl-heading-wrapper level-h3"><h3 id="transport-mechanisms">Transport mechanisms</h3><a class="sl-anchor-link" href="#transport-mechanisms"><span aria-hidden="true" class="sl-anchor-icon"><svg width="16" height="16" viewBox="0 0 24 24"><path fill="currentcolor" d="m12.11 15.39-3.88 3.88a2.52 2.52 0 0 1-3.5 0 2.47 2.47 0 0 1 0-3.5l3.88-3.88a1 1 0 0 0-1.42-1.42l-3.88 3.89a4.48 4.48 0 0 0 6.33 6.33l3.89-3.88a1 1 0 1 0-1.42-1.42Zm8.58-12.08a4.49 4.49 0 0 0-6.33 0l-3.89 3.88a1 1 0 0 0 1.42 1.42l3.88-3.88a2.52 2.52 0 0 1 3.5 0 2.47 2.47 0 0 1 0 3.5l-3.88 3.88a1 1 0 1 0 1.42 1.42l3.88-3.89a4.49 4.49 0 0 0 0-6.33ZM8.83 15.17a1 1 0 0 0 1.1.22 1 1 0 0 0 .32-.22l4.92-4.92a1 1 0 0 0-1.42-1.42l-4.92 4.92a1 1 0 0 0 0 1.42Z"></path></svg></span><span class="sr-only">Section titled â€œTransport mechanismsâ€</span></a></div>
<p>The Gemini CLI supports three MCP transport types:</p>
<ul>
<li><strong>Stdio Transport:</strong> Spawns a subprocess and communicates via stdin/stdout</li>
<li><strong>SSE Transport:</strong> Connects to Server-Sent Events endpoints</li>
<li><strong>Streamable HTTP Transport:</strong> Uses HTTP streaming for communication</li>
</ul>
<div class="sl-heading-wrapper level-h2"><h2 id="working-with-mcp-resources">Working with MCP resources</h2><a class="sl-anchor-link" href="#working-with-mcp-resources"><span aria-hidden="true" class="sl-anchor-icon"><svg width="16" height="16" viewBox="0 0 24 24"><path fill="currentcolor" d="m12.11 15.39-3.88 3.88a2.52 2.52 0 0 1-3.5 0 2.47 2.47 0 0 1 0-3.5l3.88-3.88a1 1 0 0 0-1.42-1.42l-3.88 3.89a4.48 4.48 0 0 0 6.33 6.33l3.89-3.88a1 1 0 1 0-1.42-1.42Zm8.58-12.08a4.49 4.49 0 0 0-6.33 0l-3.89 3.88a1 1 0 0 0 1.42 1.42l3.88-3.88a2.52 2.52 0 0 1 3.5 0 2.47 2.47 0 0 1 0 3.5l-3.88 3.88a1 1 0 1 0 1.42 1.42l3.88-3.89a4.49 4.49 0 0 0 0-6.33ZM8.83 15.17a1 1 0 0 0 1.1.22 1 1 0 0 0 .32-.22l4.92-4.92a1 1 0 0 0-1.42-1.42l-4.92 4.92a1 1 0 0 0 0 1.42Z"></path></svg></span><span class="sr-only">Section titled â€œWorking with MCP resourcesâ€</span></a></div>
<p>Some MCP servers expose contextual â€œresourcesâ€ in addition to the tools and
prompts. Gemini CLI discovers these automatically and gives you the possibility
to reference them in the chat.</p>
<div class="sl-heading-wrapper level-h3"><h3 id="discovery-and-listing">Discovery and listing</h3><a class="sl-anchor-link" href="#discovery-and-listing"><span aria-hidden="true" class="sl-anchor-icon"><svg width="16" height="16" viewBox="0 0 24 24"><path fill="currentcolor" d="m12.11 15.39-3.88 3.88a2.52 2.52 0 0 1-3.5 0 2.47 2.47 0 0 1 0-3.5l3.88-3.88a1 1 0 0 0-1.42-1.42l-3.88 3.89a4.48 4.48 0 0 0 6.33 6.33l3.89-3.88a1 1 0 1 0-1.42-1.42Zm8.58-12.08a4.49 4.49 0 0 0-6.33 0l-3.89 3.88a1 1 0 0 0 1.42 1.42l3.88-3.88a2.52 2.52 0 0 1 3.5 0 2.47 2.47 0 0 1 0 3.5l-3.88 3.88a1 1 0 1 0 1.42 1.42l3.88-3.89a4.49 4.49 0 0 0 0-6.33ZM8.83 15.17a1 1 0 0 0 1.1.22 1 1 0 0 0 .32-.22l4.92-4.92a1 1 0 0 0-1.42-1.42l-4.92 4.92a1 1 0 0 0 0 1.42Z"></path></svg></span><span class="sr-only">Section titled â€œDiscovery and listingâ€</span></a></div>
<ul>
<li>When discovery runs, the CLI fetches each serverâ€™s <code dir="auto">resources/list</code> results.</li>
<li>The <code dir="auto">/mcp</code> command displays a Resources section alongside Tools and Prompts
for every connected server.</li>
</ul>
<p>This returns a concise, plain-text list of URIs plus metadata.</p>
<div class="sl-heading-wrapper level-h3"><h3 id="referencing-resources-in-a-conversation">Referencing resources in a conversation</h3><a class="sl-anchor-link" href="#referencing-resources-in-a-conversation"><span aria-hidden="true" class="sl-anchor-icon"><svg width="16" height="16" viewBox="0 0 24 24"><path fill="currentcolor" d="m12.11 15.39-3.88 3.88a2.52 2.52 0 0 1-3.5 0 2.47 2.47 0 0 1 0-3.5l3.88-3.88a1 1 0 0 0-1.42-1.42l-3.88 3.89a4.48 4.48 0 0 0 6.33 6.33l3.89-3.88a1 1 0 1 0-1.42-1.42Zm8.58-12.08a4.49 4.49 0 0 0-6.33 0l-3.89 3.88a1 1 0 0 0 1.42 1.42l3.88-3.88a2.52 2.52 0 0 1 3.5 0 2.47 2.47 0 0 1 0 3.5l-3.88 3.88a1 1 0 1 0 1.42 1.42l3.88-3.89a4.49 4.49 0 0 0 0-6.33ZM8.83 15.17a1 1 0 0 0 1.1.22 1 1 0 0 0 .32-.22l4.92-4.92a1 1 0 0 0-1.42-1.42l-4.92 4.92a1 1 0 0 0 0 1.42Z"></path></svg></span><span class="sr-only">Section titled â€œReferencing resources in a conversationâ€</span></a></div>
<p>You can use the same <code dir="auto">@</code> syntax already known for referencing local files:</p>
<div class="expressive-code"><link rel="stylesheet" href="/_astro/ec.me98n.css"><script type="module" src="/_astro/ec.p1z7b.js"></script><figure class="frame not-content"><figcaption class="header"></figcaption><pre data-language="plaintext"><code><div class="ec-line"><div class="code"><span style="--0:#e1dfdf;--1:#292929">@server://resource/path</span></div></div></code></pre><div class="copy"><button title="Copy to clipboard" data-copied="Copied!" data-code="@server://resource/path"><div></div></button></div></figure></div>
<p>Resource URIs appear in the completion menu together with filesystem paths. When
you submit the message, the CLI calls <code dir="auto">resources/read</code> and injects the content
in the conversation.</p>
<div class="sl-heading-wrapper level-h2"><h2 id="how-to-set-up-your-mcp-server">How to set up your MCP server</h2><a class="sl-anchor-link" href="#how-to-set-up-your-mcp-server"><span aria-hidden="true" class="sl-anchor-icon"><svg width="16" height="16" viewBox="0 0 24 24"><path fill="currentcolor" d="m12.11 15.39-3.88 3.88a2.52 2.52 0 0 1-3.5 0 2.47 2.47 0 0 1 0-3.5l3.88-3.88a1 1 0 0 0-1.42-1.42l-3.88 3.89a4.48 4.48 0 0 0 6.33 6.33l3.89-3.88a1 1 0 1 0-1.42-1.42Zm8.58-12.08a4.49 4.49 0 0 0-6.33 0l-3.89 3.88a1 1 0 0 0 1.42 1.42l3.88-3.88a2.52 2.52 0 0 1 3.5 0 2.47 2.47 0 0 1 0 3.5l-3.88 3.88a1 1 0 1 0 1.42 1.42l3.88-3.89a4.49 4.49 0 0 0 0-6.33ZM8.83 15.17a1 1 0 0 0 1.1.22 1 1 0 0 0 .32-.22l4.92-4.92a1 1 0 0 0-1.42-1.42l-4.92 4.92a1 1 0 0 0 0 1.42Z"></path></svg></span><span class="sr-only">Section titled â€œHow to set up your MCP serverâ€</span></a></div>
<p>The Gemini CLI uses the <code dir="auto">mcpServers</code> configuration in your <code dir="auto">settings.json</code> file
to locate and connect to MCP servers. This configuration supports multiple
servers with different transport mechanisms.</p>
<div class="sl-heading-wrapper level-h3"><h3 id="configure-the-mcp-server-in-settingsjson">Configure the MCP server in settings.json</h3><a class="sl-anchor-link" href="#configure-the-mcp-server-in-settingsjson"><span aria-hidden="true" class="sl-anchor-icon"><svg width="16" height="16" viewBox="0 0 24 24"><path fill="currentcolor" d="m12.11 15.39-3.88 3.88a2.52 2.52 0 0 1-3.5 0 2.47 2.47 0 0 1 0-3.5l3.88-3.88a1 1 0 0 0-1.42-1.42l-3.88 3.89a4.48 4.48 0 0 0 6.33 6.33l3.89-3.88a1 1 0 1 0-1.42-1.42Zm8.58-12.08a4.49 4.49 0 0 0-6.33 0l-3.89 3.88a1 1 0 0 0 1.42 1.42l3.88-3.88a2.52 2.52 0 0 1 3.5 0 2.47 2.47 0 0 1 0 3.5l-3.88 3.88a1 1 0 1 0 1.42 1.42l3.88-3.89a4.49 4.49 0 0 0 0-6.33ZM8.83 15.17a1 1 0 0 0 1.1.22 1 1 0 0 0 .32-.22l4.92-4.92a1 1 0 0 0-1.42-1.42l-4.92 4.92a1 1 0 0 0 0 1.42Z"></path></svg></span><span class="sr-only">Section titled â€œConfigure the MCP server in settings.jsonâ€</span></a></div>
<p>You can configure MCP servers in your <code dir="auto">settings.json</code> file in two main ways:
through the top-level <code dir="auto">mcpServers</code> object for specific server definitions, and
through the <code dir="auto">mcp</code> object for global settings that control server discovery and
execution.</p>
<div class="sl-heading-wrapper level-h4"><h4 id="global-mcp-settings-mcp">Global MCP settings (<code dir="auto">mcp</code>)</h4><a class="sl-anchor-link" href="#global-mcp-settings-mcp"><span aria-hidden="true" class="sl-anchor-icon"><svg width="16" height="16" viewBox="0 0 24 24"><path fill="currentcolor" d="m12.11 15.39-3.88 3.88a2.52 2.52 0 0 1-3.5 0 2.47 2.47 0 0 1 0-3.5l3.88-3.88a1 1 0 0 0-1.42-1.42l-3.88 3.89a4.48 4.48 0 0 0 6.33 6.33l3.89-3.88a1 1 0 1 0-1.42-1.42Zm8.58-12.08a4.49 4.49 0 0 0-6.33 0l-3.89 3.88a1 1 0 0 0 1.42 1.42l3.88-3.88a2.52 2.52 0 0 1 3.5 0 2.47 2.47 0 0 1 0 3.5l-3.88 3.88a1 1 0 1 0 1.42 1.42l3.88-3.89a4.49 4.49 0 0 0 0-6.33ZM8.83 15.17a1 1 0 0 0 1.1.22 1 1 0 0 0 .32-.22l4.92-4.92a1 1 0 0 0-1.42-1.42l-4.92 4.92a1 1 0 0 0 0 1.42Z"></path></svg></span><span class="sr-only">Section titled â€œGlobal MCP settings (mcp)â€</span></a></div>
<p>The <code dir="auto">mcp</code> object in your <code dir="auto">settings.json</code> allows you to define global rules for
all MCP servers.</p>
<ul>
<li><strong><code dir="auto">mcp.serverCommand</code></strong> (string): A global command to start an MCP server.</li>
<li><strong><code dir="auto">mcp.allowed</code></strong> (array of strings): A list of MCP server names to allow. If
this is set, only servers from this list (matching the keys in the
<code dir="auto">mcpServers</code> object) will be connected to.</li>
<li><strong><code dir="auto">mcp.excluded</code></strong> (array of strings): A list of MCP server names to exclude.
Servers in this list will not be connected to.</li>
</ul>
<p><strong>Example:</strong></p>
<div class="expressive-code"><figure class="frame not-content"><figcaption class="header"></figcaption><pre data-language="json"><code><div class="ec-line"><div class="code"><span style="--0:#E1DFDF;--1:#292929">{</span></div></div><div class="ec-line"><div class="code"><span class="indent">  </span><span style="--0:#85CDF1;--1:#00709A">"mcp"</span><span style="--0:#E1DFDF;--1:#292929">: {</span></div></div><div class="ec-line"><div class="code"><span class="indent">    </span><span style="--0:#85CDF1;--1:#00709A">"allowed"</span><span style="--0:#E1DFDF;--1:#292929">: [</span><span style="--0:#77D5A3;--1:#007847">"my-trusted-server"</span><span style="--0:#E1DFDF;--1:#292929">],</span></div></div><div class="ec-line"><div class="code"><span class="indent">    </span><span style="--0:#85CDF1;--1:#00709A">"excluded"</span><span style="--0:#E1DFDF;--1:#292929">: [</span><span style="--0:#77D5A3;--1:#007847">"experimental-server"</span><span style="--0:#E1DFDF;--1:#292929">]</span></div></div><div class="ec-line"><div class="code"><span class="indent"><span style="--0:#E1DFDF;--1:#292929">  </span></span><span style="--0:#E1DFDF;--1:#292929">}</span></div></div><div class="ec-line"><div class="code"><span style="--0:#E1DFDF;--1:#292929">}</span></div></div></code></pre><div class="copy"><button title="Copy to clipboard" data-copied="Copied!" data-code="{  &#x22;mcp&#x22;: {    &#x22;allowed&#x22;: [&#x22;my-trusted-server&#x22;],    &#x22;excluded&#x22;: [&#x22;experimental-server&#x22;]  }}"><div></div></button></div></figure></div>
<div class="sl-heading-wrapper level-h4"><h4 id="server-specific-configuration-mcpservers">Server-specific configuration (<code dir="auto">mcpServers</code>)</h4><a class="sl-anchor-link" href="#server-specific-configuration-mcpservers"><span aria-hidden="true" class="sl-anchor-icon"><svg width="16" height="16" viewBox="0 0 24 24"><path fill="currentcolor" d="m12.11 15.39-3.88 3.88a2.52 2.52 0 0 1-3.5 0 2.47 2.47 0 0 1 0-3.5l3.88-3.88a1 1 0 0 0-1.42-1.42l-3.88 3.89a4.48 4.48 0 0 0 6.33 6.33l3.89-3.88a1 1 0 1 0-1.42-1.42Zm8.58-12.08a4.49 4.49 0 0 0-6.33 0l-3.89 3.88a1 1 0 0 0 1.42 1.42l3.88-3.88a2.52 2.52 0 0 1 3.5 0 2.47 2.47 0 0 1 0 3.5l-3.88 3.88a1 1 0 1 0 1.42 1.42l3.88-3.89a4.49 4.49 0 0 0 0-6.33ZM8.83 15.17a1 1 0 0 0 1.1.22 1 1 0 0 0 .32-.22l4.92-4.92a1 1 0 0 0-1.42-1.42l-4.92 4.92a1 1 0 0 0 0 1.42Z"></path></svg></span><span class="sr-only">Section titled â€œServer-specific configuration (mcpServers)â€</span></a></div>
<p>The <code dir="auto">mcpServers</code> object is where you define each individual MCP server you want
the CLI to connect to.</p>
<div class="sl-heading-wrapper level-h3"><h3 id="configuration-structure">Configuration structure</h3><a class="sl-anchor-link" href="#configuration-structure"><span aria-hidden="true" class="sl-anchor-icon"><svg width="16" height="16" viewBox="0 0 24 24"><path fill="currentcolor" d="m12.11 15.39-3.88 3.88a2.52 2.52 0 0 1-3.5 0 2.47 2.47 0 0 1 0-3.5l3.88-3.88a1 1 0 0 0-1.42-1.42l-3.88 3.89a4.48 4.48 0 0 0 6.33 6.33l3.89-3.88a1 1 0 1 0-1.42-1.42Zm8.58-12.08a4.49 4.49 0 0 0-6.33 0l-3.89 3.88a1 1 0 0 0 1.42 1.42l3.88-3.88a2.52 2.52 0 0 1 3.5 0 2.47 2.47 0 0 1 0 3.5l-3.88 3.88a1 1 0 1 0 1.42 1.42l3.88-3.89a4.49 4.49 0 0 0 0-6.33ZM8.83 15.17a1 1 0 0 0 1.1.22 1 1 0 0 0 .32-.22l4.92-4.92a1 1 0 0 0-1.42-1.42l-4.92 4.92a1 1 0 0 0 0 1.42Z"></path></svg></span><span class="sr-only">Section titled â€œConfiguration structureâ€</span></a></div>
<p>Add an <code dir="auto">mcpServers</code> object to your <code dir="auto">settings.json</code> file:</p>
<div class="expressive-code"><figure class="frame not-content"><figcaption class="header"></figcaption><pre data-language="json"><code><div class="ec-line"><div class="code"><span style="--0:#E1DFDF;--1:#292929">{ </span><span style="--0:#FFC6D0;--0fs:italic;--1:#AD1C48;--1fs:italic">...file</span><span style="--0:#E1DFDF;--1:#292929"> </span><span style="--0:#FFC6D0;--0fs:italic;--1:#AD1C48;--1fs:italic">contains</span><span style="--0:#E1DFDF;--1:#292929"> </span><span style="--0:#FFC6D0;--0fs:italic;--1:#AD1C48;--1fs:italic">other</span><span style="--0:#E1DFDF;--1:#292929"> </span><span style="--0:#FFC6D0;--0fs:italic;--1:#AD1C48;--1fs:italic">config</span><span style="--0:#E1DFDF;--1:#292929"> </span><span style="--0:#FFC6D0;--0fs:italic;--1:#AD1C48;--1fs:italic">objects</span></div></div><div class="ec-line"><div class="code"><span class="indent">  </span><span style="--0:#85CDF1;--1:#00709A">"mcpServers"</span><span style="--0:#E1DFDF;--1:#292929">: {</span></div></div><div class="ec-line"><div class="code"><span class="indent">    </span><span style="--0:#85CDF1;--1:#00709A">"serverName"</span><span style="--0:#E1DFDF;--1:#292929">: {</span></div></div><div class="ec-line"><div class="code"><span class="indent">      </span><span style="--0:#85CDF1;--1:#00709A">"command"</span><span style="--0:#E1DFDF;--1:#292929">: </span><span style="--0:#77D5A3;--1:#007847">"path/to/server"</span><span style="--0:#E1DFDF;--1:#292929">,</span></div></div><div class="ec-line"><div class="code"><span class="indent">      </span><span style="--0:#85CDF1;--1:#00709A">"args"</span><span style="--0:#E1DFDF;--1:#292929">: [</span><span style="--0:#77D5A3;--1:#007847">"--arg1"</span><span style="--0:#E1DFDF;--1:#292929">, </span><span style="--0:#77D5A3;--1:#007847">"value1"</span><span style="--0:#E1DFDF;--1:#292929">],</span></div></div><div class="ec-line"><div class="code"><span class="indent">      </span><span style="--0:#85CDF1;--1:#00709A">"env"</span><span style="--0:#E1DFDF;--1:#292929">: {</span></div></div><div class="ec-line"><div class="code"><span class="indent">        </span><span style="--0:#85CDF1;--1:#00709A">"API_KEY"</span><span style="--0:#E1DFDF;--1:#292929">: </span><span style="--0:#77D5A3;--1:#007847">"$MY_API_TOKEN"</span></div></div><div class="ec-line"><div class="code"><span class="indent"><span style="--0:#E1DFDF;--1:#292929">      </span></span><span style="--0:#E1DFDF;--1:#292929">},</span></div></div><div class="ec-line"><div class="code"><span class="indent">      </span><span style="--0:#85CDF1;--1:#00709A">"cwd"</span><span style="--0:#E1DFDF;--1:#292929">: </span><span style="--0:#77D5A3;--1:#007847">"./server-directory"</span><span style="--0:#E1DFDF;--1:#292929">,</span></div></div><div class="ec-line"><div class="code"><span class="indent">      </span><span style="--0:#85CDF1;--1:#00709A">"timeout"</span><span style="--0:#E1DFDF;--1:#292929">: </span><span style="--0:#8DA8FF;--1:#3252B8">30000</span><span style="--0:#E1DFDF;--1:#292929">,</span></div></div><div class="ec-line"><div class="code"><span class="indent">      </span><span style="--0:#85CDF1;--1:#00709A">"trust"</span><span style="--0:#E1DFDF;--1:#292929">: </span><span style="--0:#8DA8FF;--1:#3252B8">false</span></div></div><div class="ec-line"><div class="code"><span class="indent"><span style="--0:#E1DFDF;--1:#292929">    </span></span><span style="--0:#E1DFDF;--1:#292929">}</span></div></div><div class="ec-line"><div class="code"><span class="indent"><span style="--0:#E1DFDF;--1:#292929">  </span></span><span style="--0:#E1DFDF;--1:#292929">}</span></div></div><div class="ec-line"><div class="code"><span style="--0:#E1DFDF;--1:#292929">}</span></div></div></code></pre><div class="copy"><button title="Copy to clipboard" data-copied="Copied!" data-code="{ ...file contains other config objects  &#x22;mcpServers&#x22;: {    &#x22;serverName&#x22;: {      &#x22;command&#x22;: &#x22;path/to/server&#x22;,      &#x22;args&#x22;: [&#x22;--arg1&#x22;, &#x22;value1&#x22;],      &#x22;env&#x22;: {        &#x22;API_KEY&#x22;: &#x22;$MY_API_TOKEN&#x22;      },      &#x22;cwd&#x22;: &#x22;./server-directory&#x22;,      &#x22;timeout&#x22;: 30000,      &#x22;trust&#x22;: false    }  }}"><div></div></button></div></figure></div>
<div class="sl-heading-wrapper level-h3"><h3 id="configuration-properties">Configuration properties</h3><a class="sl-anchor-link" href="#configuration-properties"><span aria-hidden="true" class="sl-anchor-icon"><svg width="16" height="16" viewBox="0 0 24 24"><path fill="currentcolor" d="m12.11 15.39-3.88 3.88a2.52 2.52 0 0 1-3.5 0 2.47 2.47 0 0 1 0-3.5l3.88-3.88a1 1 0 0 0-1.42-1.42l-3.88 3.89a4.48 4.48 0 0 0 6.33 6.33l3.89-3.88a1 1 0 1 0-1.42-1.42Zm8.58-12.08a4.49 4.49 0 0 0-6.33 0l-3.89 3.88a1 1 0 0 0 1.42 1.42l3.88-3.88a2.52 2.52 0 0 1 3.5 0 2.47 2.47 0 0 1 0 3.5l-3.88 3.88a1 1 0 1 0 1.42 1.42l3.88-3.89a4.49 4.49 0 0 0 0-6.33ZM8.83 15.17a1 1 0 0 0 1.1.22 1 1 0 0 0 .32-.22l4.92-4.92a1 1 0 0 0-1.42-1.42l-4.92 4.92a1 1 0 0 0 0 1.42Z"></path></svg></span><span class="sr-only">Section titled â€œConfiguration propertiesâ€</span></a></div>
<p>Each server configuration supports the following properties:</p>
<div class="sl-heading-wrapper level-h4"><h4 id="required-one-of-the-following">Required (one of the following)</h4><a class="sl-anchor-link" href="#required-one-of-the-following"><span aria-hidden="true" class="sl-anchor-icon"><svg width="16" height="16" viewBox="0 0 24 24"><path fill="currentcolor" d="m12.11 15.39-3.88 3.88a2.52 2.52 0 0 1-3.5 0 2.47 2.47 0 0 1 0-3.5l3.88-3.88a1 1 0 0 0-1.42-1.42l-3.88 3.89a4.48 4.48 0 0 0 6.33 6.33l3.89-3.88a1 1 0 1 0-1.42-1.42Zm8.58-12.08a4.49 4.49 0 0 0-6.33 0l-3.89 3.88a1 1 0 0 0 1.42 1.42l3.88-3.88a2.52 2.52 0 0 1 3.5 0 2.47 2.47 0 0 1 0 3.5l-3.88 3.88a1 1 0 1 0 1.42 1.42l3.88-3.89a4.49 4.49 0 0 0 0-6.33ZM8.83 15.17a1 1 0 0 0 1.1.22 1 1 0 0 0 .32-.22l4.92-4.92a1 1 0 0 0-1.42-1.42l-4.92 4.92a1 1 0 0 0 0 1.42Z"></path></svg></span><span class="sr-only">Section titled â€œRequired (one of the following)â€</span></a></div>
<ul>
<li><strong><code dir="auto">command</code></strong> (string): Path to the executable for Stdio transport</li>
<li><strong><code dir="auto">url</code></strong> (string): SSE endpoint URL (e.g., <code dir="auto">"http://localhost:8080/sse"</code>)</li>
<li><strong><code dir="auto">httpUrl</code></strong> (string): HTTP streaming endpoint URL</li>
</ul>
<div class="sl-heading-wrapper level-h4"><h4 id="optional">Optional</h4><a class="sl-anchor-link" href="#optional"><span aria-hidden="true" class="sl-anchor-icon"><svg width="16" height="16" viewBox="0 0 24 24"><path fill="currentcolor" d="m12.11 15.39-3.88 3.88a2.52 2.52 0 0 1-3.5 0 2.47 2.47 0 0 1 0-3.5l3.88-3.88a1 1 0 0 0-1.42-1.42l-3.88 3.89a4.48 4.48 0 0 0 6.33 6.33l3.89-3.88a1 1 0 1 0-1.42-1.42Zm8.58-12.08a4.49 4.49 0 0 0-6.33 0l-3.89 3.88a1 1 0 0 0 1.42 1.42l3.88-3.88a2.52 2.52 0 0 1 3.5 0 2.47 2.47 0 0 1 0 3.5l-3.88 3.88a1 1 0 1 0 1.42 1.42l3.88-3.89a4.49 4.49 0 0 0 0-6.33ZM8.83 15.17a1 1 0 0 0 1.1.22 1 1 0 0 0 .32-.22l4.92-4.92a1 1 0 0 0-1.42-1.42l-4.92 4.92a1 1 0 0 0 0 1.42Z"></path></svg></span><span class="sr-only">Section titled â€œOptionalâ€</span></a></div>
<ul>
<li><strong><code dir="auto">args</code></strong> (string[]): Command-line arguments for Stdio transport</li>
<li><strong><code dir="auto">headers</code></strong> (object): Custom HTTP headers when using <code dir="auto">url</code> or <code dir="auto">httpUrl</code></li>
<li><strong><code dir="auto">env</code></strong> (object): Environment variables for the server process. Values can
reference environment variables using <code dir="auto">$VAR_NAME</code> or <code dir="auto">${VAR_NAME}</code> syntax</li>
<li><strong><code dir="auto">cwd</code></strong> (string): Working directory for Stdio transport</li>
<li><strong><code dir="auto">timeout</code></strong> (number): Request timeout in milliseconds (default: 600,000ms =
10 minutes)</li>
<li><strong><code dir="auto">trust</code></strong> (boolean): When <code dir="auto">true</code>, bypasses all tool call confirmations for
this server (default: <code dir="auto">false</code>)</li>
<li><strong><code dir="auto">includeTools</code></strong> (string[]): List of tool names to include from this MCP
server. When specified, only the tools listed here will be available from this
server (allowlist behavior). If not specified, all tools from the server are
enabled by default.</li>
<li><strong><code dir="auto">excludeTools</code></strong> (string[]): List of tool names to exclude from this MCP
server. Tools listed here will not be available to the model, even if they are
exposed by the server. <strong>Note:</strong> <code dir="auto">excludeTools</code> takes precedence over
<code dir="auto">includeTools</code> - if a tool is in both lists, it will be excluded.</li>
<li><strong><code dir="auto">targetAudience</code></strong> (string): The OAuth Client ID allowlisted on the
IAP-protected application you are trying to access. Used with
<code dir="auto">authProviderType: 'service_account_impersonation'</code>.</li>
<li><strong><code dir="auto">targetServiceAccount</code></strong> (string): The email address of the Google Cloud
Service Account to impersonate. Used with
<code dir="auto">authProviderType: 'service_account_impersonation'</code>.</li>
</ul>
<div class="sl-heading-wrapper level-h3"><h3 id="oauth-support-for-remote-mcp-servers">OAuth support for remote MCP servers</h3><a class="sl-anchor-link" href="#oauth-support-for-remote-mcp-servers"><span aria-hidden="true" class="sl-anchor-icon"><svg width="16" height="16" viewBox="0 0 24 24"><path fill="currentcolor" d="m12.11 15.39-3.88 3.88a2.52 2.52 0 0 1-3.5 0 2.47 2.47 0 0 1 0-3.5l3.88-3.88a1 1 0 0 0-1.42-1.42l-3.88 3.89a4.48 4.48 0 0 0 6.33 6.33l3.89-3.88a1 1 0 1 0-1.42-1.42Zm8.58-12.08a4.49 4.49 0 0 0-6.33 0l-3.89 3.88a1 1 0 0 0 1.42 1.42l3.88-3.88a2.52 2.52 0 0 1 3.5 0 2.47 2.47 0 0 1 0 3.5l-3.88 3.88a1 1 0 1 0 1.42 1.42l3.88-3.89a4.49 4.49 0 0 0 0-6.33ZM8.83 15.17a1 1 0 0 0 1.1.22 1 1 0 0 0 .32-.22l4.92-4.92a1 1 0 0 0-1.42-1.42l-4.92 4.92a1 1 0 0 0 0 1.42Z"></path></svg></span><span class="sr-only">Section titled â€œOAuth support for remote MCP serversâ€</span></a></div>
<p>The Gemini CLI supports OAuth 2.0 authentication for remote MCP servers using
SSE or HTTP transports. This enables secure access to MCP servers that require
authentication.</p>
<div class="sl-heading-wrapper level-h4"><h4 id="automatic-oauth-discovery">Automatic OAuth discovery</h4><a class="sl-anchor-link" href="#automatic-oauth-discovery"><span aria-hidden="true" class="sl-anchor-icon"><svg width="16" height="16" viewBox="0 0 24 24"><path fill="currentcolor" d="m12.11 15.39-3.88 3.88a2.52 2.52 0 0 1-3.5 0 2.47 2.47 0 0 1 0-3.5l3.88-3.88a1 1 0 0 0-1.42-1.42l-3.88 3.89a4.48 4.48 0 0 0 6.33 6.33l3.89-3.88a1 1 0 1 0-1.42-1.42Zm8.58-12.08a4.49 4.49 0 0 0-6.33 0l-3.89 3.88a1 1 0 0 0 1.42 1.42l3.88-3.88a2.52 2.52 0 0 1 3.5 0 2.47 2.47 0 0 1 0 3.5l-3.88 3.88a1 1 0 1 0 1.42 1.42l3.88-3.89a4.49 4.49 0 0 0 0-6.33ZM8.83 15.17a1 1 0 0 0 1.1.22 1 1 0 0 0 .32-.22l4.92-4.92a1 1 0 0 0-1.42-1.42l-4.92 4.92a1 1 0 0 0 0 1.42Z"></path></svg></span><span class="sr-only">Section titled â€œAutomatic OAuth discoveryâ€</span></a></div>
<p>For servers that support OAuth discovery, you can omit the OAuth configuration
and let the CLI discover it automatically:</p>
<div class="expressive-code"><figure class="frame not-content"><figcaption class="header"></figcaption><pre data-language="json"><code><div class="ec-line"><div class="code"><span style="--0:#E1DFDF;--1:#292929">{</span></div></div><div class="ec-line"><div class="code"><span class="indent">  </span><span style="--0:#85CDF1;--1:#00709A">"mcpServers"</span><span style="--0:#E1DFDF;--1:#292929">: {</span></div></div><div class="ec-line"><div class="code"><span class="indent">    </span><span style="--0:#85CDF1;--1:#00709A">"discoveredServer"</span><span style="--0:#E1DFDF;--1:#292929">: {</span></div></div><div class="ec-line"><div class="code"><span class="indent">      </span><span style="--0:#85CDF1;--1:#00709A">"url"</span><span style="--0:#E1DFDF;--1:#292929">: </span><span style="--0:#77D5A3;--1:#007847">"https://api.example.com/sse"</span></div></div><div class="ec-line"><div class="code"><span class="indent"><span style="--0:#E1DFDF;--1:#292929">    </span></span><span style="--0:#E1DFDF;--1:#292929">}</span></div></div><div class="ec-line"><div class="code"><span class="indent"><span style="--0:#E1DFDF;--1:#292929">  </span></span><span style="--0:#E1DFDF;--1:#292929">}</span></div></div><div class="ec-line"><div class="code"><span style="--0:#E1DFDF;--1:#292929">}</span></div></div></code></pre><div class="copy"><button title="Copy to clipboard" data-copied="Copied!" data-code="{  &#x22;mcpServers&#x22;: {    &#x22;discoveredServer&#x22;: {      &#x22;url&#x22;: &#x22;https://api.example.com/sse&#x22;    }  }}"><div></div></button></div></figure></div>
<p>The CLI will automatically:</p>
<ul>
<li>Detect when a server requires OAuth authentication (401 responses)</li>
<li>Discover OAuth endpoints from server metadata</li>
<li>Perform dynamic client registration if supported</li>
<li>Handle the OAuth flow and token management</li>
</ul>
<div class="sl-heading-wrapper level-h4"><h4 id="authentication-flow">Authentication flow</h4><a class="sl-anchor-link" href="#authentication-flow"><span aria-hidden="true" class="sl-anchor-icon"><svg width="16" height="16" viewBox="0 0 24 24"><path fill="currentcolor" d="m12.11 15.39-3.88 3.88a2.52 2.52 0 0 1-3.5 0 2.47 2.47 0 0 1 0-3.5l3.88-3.88a1 1 0 0 0-1.42-1.42l-3.88 3.89a4.48 4.48 0 0 0 6.33 6.33l3.89-3.88a1 1 0 1 0-1.42-1.42Zm8.58-12.08a4.49 4.49 0 0 0-6.33 0l-3.89 3.88a1 1 0 0 0 1.42 1.42l3.88-3.88a2.52 2.52 0 0 1 3.5 0 2.47 2.47 0 0 1 0 3.5l-3.88 3.88a1 1 0 1 0 1.42 1.42l3.88-3.89a4.49 4.49 0 0 0 0-6.33ZM8.83 15.17a1 1 0 0 0 1.1.22 1 1 0 0 0 .32-.22l4.92-4.92a1 1 0 0 0-1.42-1.42l-4.92 4.92a1 1 0 0 0 0 1.42Z"></path></svg></span><span class="sr-only">Section titled â€œAuthentication flowâ€</span></a></div>
<p>When connecting to an OAuth-enabled server:</p>
<ol>
<li><strong>Initial connection attempt</strong> fails with 401 Unauthorized</li>
<li><strong>OAuth discovery</strong> finds authorization and token endpoints</li>
<li><strong>Browser opens</strong> for user authentication (requires local browser access)</li>
<li><strong>Authorization code</strong> is exchanged for access tokens</li>
<li><strong>Tokens are stored</strong> securely for future use</li>
<li><strong>Connection retry</strong> succeeds with valid tokens</li>
</ol>
<div class="sl-heading-wrapper level-h4"><h4 id="browser-redirect-requirements">Browser redirect requirements</h4><a class="sl-anchor-link" href="#browser-redirect-requirements"><span aria-hidden="true" class="sl-anchor-icon"><svg width="16" height="16" viewBox="0 0 24 24"><path fill="currentcolor" d="m12.11 15.39-3.88 3.88a2.52 2.52 0 0 1-3.5 0 2.47 2.47 0 0 1 0-3.5l3.88-3.88a1 1 0 0 0-1.42-1.42l-3.88 3.89a4.48 4.48 0 0 0 6.33 6.33l3.89-3.88a1 1 0 1 0-1.42-1.42Zm8.58-12.08a4.49 4.49 0 0 0-6.33 0l-3.89 3.88a1 1 0 0 0 1.42 1.42l3.88-3.88a2.52 2.52 0 0 1 3.5 0 2.47 2.47 0 0 1 0 3.5l-3.88 3.88a1 1 0 1 0 1.42 1.42l3.88-3.89a4.49 4.49 0 0 0 0-6.33ZM8.83 15.17a1 1 0 0 0 1.1.22 1 1 0 0 0 .32-.22l4.92-4.92a1 1 0 0 0-1.42-1.42l-4.92 4.92a1 1 0 0 0 0 1.42Z"></path></svg></span><span class="sr-only">Section titled â€œBrowser redirect requirementsâ€</span></a></div>
<p><strong>Important:</strong> OAuth authentication requires that your local machine can:</p>
<ul>
<li>Open a web browser for authentication</li>
<li>Receive redirects on <code dir="auto">http://localhost:7777/oauth/callback</code></li>
</ul>
<p>This feature will not work in:</p>
<ul>
<li>Headless environments without browser access</li>
<li>Remote SSH sessions without X11 forwarding</li>
<li>Containerized environments without browser support</li>
</ul>
<div class="sl-heading-wrapper level-h4"><h4 id="managing-oauth-authentication">Managing OAuth authentication</h4><a class="sl-anchor-link" href="#managing-oauth-authentication"><span aria-hidden="true" class="sl-anchor-icon"><svg width="16" height="16" viewBox="0 0 24 24"><path fill="currentcolor" d="m12.11 15.39-3.88 3.88a2.52 2.52 0 0 1-3.5 0 2.47 2.47 0 0 1 0-3.5l3.88-3.88a1 1 0 0 0-1.42-1.42l-3.88 3.89a4.48 4.48 0 0 0 6.33 6.33l3.89-3.88a1 1 0 1 0-1.42-1.42Zm8.58-12.08a4.49 4.49 0 0 0-6.33 0l-3.89 3.88a1 1 0 0 0 1.42 1.42l3.88-3.88a2.52 2.52 0 0 1 3.5 0 2.47 2.47 0 0 1 0 3.5l-3.88 3.88a1 1 0 1 0 1.42 1.42l3.88-3.89a4.49 4.49 0 0 0 0-6.33ZM8.83 15.17a1 1 0 0 0 1.1.22 1 1 0 0 0 .32-.22l4.92-4.92a1 1 0 0 0-1.42-1.42l-4.92 4.92a1 1 0 0 0 0 1.42Z"></path></svg></span><span class="sr-only">Section titled â€œManaging OAuth authenticationâ€</span></a></div>
<p>Use the <code dir="auto">/mcp auth</code> command to manage OAuth authentication:</p>
<div class="expressive-code"><figure class="frame is-terminal not-content"><figcaption class="header"><span class="title"></span><span class="sr-only">Terminal window</span></figcaption><pre data-language="bash"><code><div class="ec-line"><div class="code"><span style="--0:#8E8E8E;--1:#686868"># List servers requiring authentication</span></div></div><div class="ec-line"><div class="code"><span style="--0:#BD9CFE;--1:#6F4CDE">/mcp</span><span style="--0:#E1DFDF;--1:#292929"> </span><span style="--0:#77D5A3;--1:#007847">auth</span></div></div><div class="ec-line"><div class="code">
</div></div><div class="ec-line"><div class="code"><span style="--0:#8E8E8E;--1:#686868"># Authenticate with a specific server</span></div></div><div class="ec-line"><div class="code"><span style="--0:#BD9CFE;--1:#6F4CDE">/mcp</span><span style="--0:#E1DFDF;--1:#292929"> </span><span style="--0:#77D5A3;--1:#007847">auth</span><span style="--0:#E1DFDF;--1:#292929"> </span><span style="--0:#77D5A3;--1:#007847">serverName</span></div></div><div class="ec-line"><div class="code">
</div></div><div class="ec-line"><div class="code"><span style="--0:#8E8E8E;--1:#686868"># Re-authenticate if tokens expire</span></div></div><div class="ec-line"><div class="code"><span style="--0:#BD9CFE;--1:#6F4CDE">/mcp</span><span style="--0:#E1DFDF;--1:#292929"> </span><span style="--0:#77D5A3;--1:#007847">auth</span><span style="--0:#E1DFDF;--1:#292929"> </span><span style="--0:#77D5A3;--1:#007847">serverName</span></div></div></code></pre><div class="copy"><button title="Copy to clipboard" data-copied="Copied!" data-code="/mcp auth/mcp auth serverName/mcp auth serverName"><div></div></button></div></figure></div>
<div class="sl-heading-wrapper level-h4"><h4 id="oauth-configuration-properties">OAuth configuration properties</h4><a class="sl-anchor-link" href="#oauth-configuration-properties"><span aria-hidden="true" class="sl-anchor-icon"><svg width="16" height="16" viewBox="0 0 24 24"><path fill="currentcolor" d="m12.11 15.39-3.88 3.88a2.52 2.52 0 0 1-3.5 0 2.47 2.47 0 0 1 0-3.5l3.88-3.88a1 1 0 0 0-1.42-1.42l-3.88 3.89a4.48 4.48 0 0 0 6.33 6.33l3.89-3.88a1 1 0 1 0-1.42-1.42Zm8.58-12.08a4.49 4.49 0 0 0-6.33 0l-3.89 3.88a1 1 0 0 0 1.42 1.42l3.88-3.88a2.52 2.52 0 0 1 3.5 0 2.47 2.47 0 0 1 0 3.5l-3.88 3.88a1 1 0 1 0 1.42 1.42l3.88-3.89a4.49 4.49 0 0 0 0-6.33ZM8.83 15.17a1 1 0 0 0 1.1.22 1 1 0 0 0 .32-.22l4.92-4.92a1 1 0 0 0-1.42-1.42l-4.92 4.92a1 1 0 0 0 0 1.42Z"></path></svg></span><span class="sr-only">Section titled â€œOAuth configuration propertiesâ€</span></a></div>
<ul>
<li><strong><code dir="auto">enabled</code></strong> (boolean): Enable OAuth for this server</li>
<li><strong><code dir="auto">clientId</code></strong> (string): OAuth client identifier (optional with dynamic
registration)</li>
<li><strong><code dir="auto">clientSecret</code></strong> (string): OAuth client secret (optional for public clients)</li>
<li><strong><code dir="auto">authorizationUrl</code></strong> (string): OAuth authorization endpoint (auto-discovered
if omitted)</li>
<li><strong><code dir="auto">tokenUrl</code></strong> (string): OAuth token endpoint (auto-discovered if omitted)</li>
<li><strong><code dir="auto">scopes</code></strong> (string[]): Required OAuth scopes</li>
<li><strong><code dir="auto">redirectUri</code></strong> (string): Custom redirect URI (defaults to
<code dir="auto">http://localhost:7777/oauth/callback</code>)</li>
<li><strong><code dir="auto">tokenParamName</code></strong> (string): Query parameter name for tokens in SSE URLs</li>
<li><strong><code dir="auto">audiences</code></strong> (string[]): Audiences the token is valid for</li>
</ul>
<div class="sl-heading-wrapper level-h4"><h4 id="token-management">Token management</h4><a class="sl-anchor-link" href="#token-management"><span aria-hidden="true" class="sl-anchor-icon"><svg width="16" height="16" viewBox="0 0 24 24"><path fill="currentcolor" d="m12.11 15.39-3.88 3.88a2.52 2.52 0 0 1-3.5 0 2.47 2.47 0 0 1 0-3.5l3.88-3.88a1 1 0 0 0-1.42-1.42l-3.88 3.89a4.48 4.48 0 0 0 6.33 6.33l3.89-3.88a1 1 0 1 0-1.42-1.42Zm8.58-12.08a4.49 4.49 0 0 0-6.33 0l-3.89 3.88a1 1 0 0 0 1.42 1.42l3.88-3.88a2.52 2.52 0 0 1 3.5 0 2.47 2.47 0 0 1 0 3.5l-3.88 3.88a1 1 0 1 0 1.42 1.42l3.88-3.89a4.49 4.49 0 0 0 0-6.33ZM8.83 15.17a1 1 0 0 0 1.1.22 1 1 0 0 0 .32-.22l4.92-4.92a1 1 0 0 0-1.42-1.42l-4.92 4.92a1 1 0 0 0 0 1.42Z"></path></svg></span><span class="sr-only">Section titled â€œToken managementâ€</span></a></div>
<p>OAuth tokens are automatically:</p>
<ul>
<li><strong>Stored securely</strong> in <code dir="auto">~/.gemini/mcp-oauth-tokens.json</code></li>
<li><strong>Refreshed</strong> when expired (if refresh tokens are available)</li>
<li><strong>Validated</strong> before each connection attempt</li>
<li><strong>Cleaned up</strong> when invalid or expired</li>
</ul>
<div class="sl-heading-wrapper level-h4"><h4 id="authentication-provider-type">Authentication provider type</h4><a class="sl-anchor-link" href="#authentication-provider-type"><span aria-hidden="true" class="sl-anchor-icon"><svg width="16" height="16" viewBox="0 0 24 24"><path fill="currentcolor" d="m12.11 15.39-3.88 3.88a2.52 2.52 0 0 1-3.5 0 2.47 2.47 0 0 1 0-3.5l3.88-3.88a1 1 0 0 0-1.42-1.42l-3.88 3.89a4.48 4.48 0 0 0 6.33 6.33l3.89-3.88a1 1 0 1 0-1.42-1.42Zm8.58-12.08a4.49 4.49 0 0 0-6.33 0l-3.89 3.88a1 1 0 0 0 1.42 1.42l3.88-3.88a2.52 2.52 0 0 1 3.5 0 2.47 2.47 0 0 1 0 3.5l-3.88 3.88a1 1 0 1 0 1.42 1.42l3.88-3.89a4.49 4.49 0 0 0 0-6.33ZM8.83 15.17a1 1 0 0 0 1.1.22 1 1 0 0 0 .32-.22l4.92-4.92a1 1 0 0 0-1.42-1.42l-4.92 4.92a1 1 0 0 0 0 1.42Z"></path></svg></span><span class="sr-only">Section titled â€œAuthentication provider typeâ€</span></a></div>
<p>You can specify the authentication provider type using the <code dir="auto">authProviderType</code>
property:</p>
<ul>
<li><strong><code dir="auto">authProviderType</code></strong> (string): Specifies the authentication provider. Can be
one of the following:
<ul>
<li><strong><code dir="auto">dynamic_discovery</code></strong> (default): The CLI will automatically discover the
OAuth configuration from the server.</li>
<li><strong><code dir="auto">google_credentials</code></strong>: The CLI will use the Google Application Default
Credentials (ADC) to authenticate with the server. When using this provider,
you must specify the required scopes.</li>
<li><strong><code dir="auto">service_account_impersonation</code></strong>: The CLI will impersonate a Google Cloud
Service Account to authenticate with the server. This is useful for
accessing IAP-protected services (this was specifically designed for Cloud
Run services).</li>
</ul>
</li>
</ul>
<div class="sl-heading-wrapper level-h4"><h4 id="google-credentials">Google credentials</h4><a class="sl-anchor-link" href="#google-credentials"><span aria-hidden="true" class="sl-anchor-icon"><svg width="16" height="16" viewBox="0 0 24 24"><path fill="currentcolor" d="m12.11 15.39-3.88 3.88a2.52 2.52 0 0 1-3.5 0 2.47 2.47 0 0 1 0-3.5l3.88-3.88a1 1 0 0 0-1.42-1.42l-3.88 3.89a4.48 4.48 0 0 0 6.33 6.33l3.89-3.88a1 1 0 1 0-1.42-1.42Zm8.58-12.08a4.49 4.49 0 0 0-6.33 0l-3.89 3.88a1 1 0 0 0 1.42 1.42l3.88-3.88a2.52 2.52 0 0 1 3.5 0 2.47 2.47 0 0 1 0 3.5l-3.88 3.88a1 1 0 1 0 1.42 1.42l3.88-3.89a4.49 4.49 0 0 0 0-6.33ZM8.83 15.17a1 1 0 0 0 1.1.22 1 1 0 0 0 .32-.22l4.92-4.92a1 1 0 0 0-1.42-1.42l-4.92 4.92a1 1 0 0 0 0 1.42Z"></path></svg></span><span class="sr-only">Section titled â€œGoogle credentialsâ€</span></a></div>
<div class="expressive-code"><figure class="frame not-content"><figcaption class="header"></figcaption><pre data-language="json"><code><div class="ec-line"><div class="code"><span style="--0:#E1DFDF;--1:#292929">{</span></div></div><div class="ec-line"><div class="code"><span class="indent">  </span><span style="--0:#85CDF1;--1:#00709A">"mcpServers"</span><span style="--0:#E1DFDF;--1:#292929">: {</span></div></div><div class="ec-line"><div class="code"><span class="indent">    </span><span style="--0:#85CDF1;--1:#00709A">"googleCloudServer"</span><span style="--0:#E1DFDF;--1:#292929">: {</span></div></div><div class="ec-line"><div class="code"><span class="indent">      </span><span style="--0:#85CDF1;--1:#00709A">"httpUrl"</span><span style="--0:#E1DFDF;--1:#292929">: </span><span style="--0:#77D5A3;--1:#007847">"https://my-gcp-service.run.app/mcp"</span><span style="--0:#E1DFDF;--1:#292929">,</span></div></div><div class="ec-line"><div class="code"><span class="indent">      </span><span style="--0:#85CDF1;--1:#00709A">"authProviderType"</span><span style="--0:#E1DFDF;--1:#292929">: </span><span style="--0:#77D5A3;--1:#007847">"google_credentials"</span><span style="--0:#E1DFDF;--1:#292929">,</span></div></div><div class="ec-line"><div class="code"><span class="indent">      </span><span style="--0:#85CDF1;--1:#00709A">"oauth"</span><span style="--0:#E1DFDF;--1:#292929">: {</span></div></div><div class="ec-line"><div class="code"><span class="indent">        </span><span style="--0:#85CDF1;--1:#00709A">"scopes"</span><span style="--0:#E1DFDF;--1:#292929">: [</span><span style="--0:#77D5A3;--1:#007847">"https://www.googleapis.com/auth/userinfo.email"</span><span style="--0:#E1DFDF;--1:#292929">]</span></div></div><div class="ec-line"><div class="code"><span class="indent"><span style="--0:#E1DFDF;--1:#292929">      </span></span><span style="--0:#E1DFDF;--1:#292929">}</span></div></div><div class="ec-line"><div class="code"><span class="indent"><span style="--0:#E1DFDF;--1:#292929">    </span></span><span style="--0:#E1DFDF;--1:#292929">}</span></div></div><div class="ec-line"><div class="code"><span class="indent"><span style="--0:#E1DFDF;--1:#292929">  </span></span><span style="--0:#E1DFDF;--1:#292929">}</span></div></div><div class="ec-line"><div class="code"><span style="--0:#E1DFDF;--1:#292929">}</span></div></div></code></pre><div class="copy"><button title="Copy to clipboard" data-copied="Copied!" data-code="{  &#x22;mcpServers&#x22;: {    &#x22;googleCloudServer&#x22;: {      &#x22;httpUrl&#x22;: &#x22;https://my-gcp-service.run.app/mcp&#x22;,      &#x22;authProviderType&#x22;: &#x22;google_credentials&#x22;,      &#x22;oauth&#x22;: {        &#x22;scopes&#x22;: [&#x22;https://www.googleapis.com/auth/userinfo.email&#x22;]      }    }  }}"><div></div></button></div></figure></div>
<div class="sl-heading-wrapper level-h4"><h4 id="service-account-impersonation">Service account impersonation</h4><a class="sl-anchor-link" href="#service-account-impersonation"><span aria-hidden="true" class="sl-anchor-icon"><svg width="16" height="16" viewBox="0 0 24 24"><path fill="currentcolor" d="m12.11 15.39-3.88 3.88a2.52 2.52 0 0 1-3.5 0 2.47 2.47 0 0 1 0-3.5l3.88-3.88a1 1 0 0 0-1.42-1.42l-3.88 3.89a4.48 4.48 0 0 0 6.33 6.33l3.89-3.88a1 1 0 1 0-1.42-1.42Zm8.58-12.08a4.49 4.49 0 0 0-6.33 0l-3.89 3.88a1 1 0 0 0 1.42 1.42l3.88-3.88a2.52 2.52 0 0 1 3.5 0 2.47 2.47 0 0 1 0 3.5l-3.88 3.88a1 1 0 1 0 1.42 1.42l3.88-3.89a4.49 4.49 0 0 0 0-6.33ZM8.83 15.17a1 1 0 0 0 1.1.22 1 1 0 0 0 .32-.22l4.92-4.92a1 1 0 0 0-1.42-1.42l-4.92 4.92a1 1 0 0 0 0 1.42Z"></path></svg></span><span class="sr-only">Section titled â€œService account impersonationâ€</span></a></div>
<p>To authenticate with a server using Service Account Impersonation, you must set
the <code dir="auto">authProviderType</code> to <code dir="auto">service_account_impersonation</code> and provide the
following properties:</p>
<ul>
<li><strong><code dir="auto">targetAudience</code></strong> (string): The OAuth Client ID allowslisted on the
IAP-protected application you are trying to access.</li>
<li><strong><code dir="auto">targetServiceAccount</code></strong> (string): The email address of the Google Cloud
Service Account to impersonate.</li>
</ul>
<p>The CLI will use your local Application Default Credentials (ADC) to generate an
OIDC ID token for the specified service account and audience. This token will
then be used to authenticate with the MCP server.</p>
<div class="sl-heading-wrapper level-h4"><h4 id="setup-instructions">Setup instructions</h4><a class="sl-anchor-link" href="#setup-instructions"><span aria-hidden="true" class="sl-anchor-icon"><svg width="16" height="16" viewBox="0 0 24 24"><path fill="currentcolor" d="m12.11 15.39-3.88 3.88a2.52 2.52 0 0 1-3.5 0 2.47 2.47 0 0 1 0-3.5l3.88-3.88a1 1 0 0 0-1.42-1.42l-3.88 3.89a4.48 4.48 0 0 0 6.33 6.33l3.89-3.88a1 1 0 1 0-1.42-1.42Zm8.58-12.08a4.49 4.49 0 0 0-6.33 0l-3.89 3.88a1 1 0 0 0 1.42 1.42l3.88-3.88a2.52 2.52 0 0 1 3.5 0 2.47 2.47 0 0 1 0 3.5l-3.88 3.88a1 1 0 1 0 1.42 1.42l3.88-3.89a4.49 4.49 0 0 0 0-6.33ZM8.83 15.17a1 1 0 0 0 1.1.22 1 1 0 0 0 .32-.22l4.92-4.92a1 1 0 0 0-1.42-1.42l-4.92 4.92a1 1 0 0 0 0 1.42Z"></path></svg></span><span class="sr-only">Section titled â€œSetup instructionsâ€</span></a></div>
<ol>
<li><strong><a href="https://cloud.google.com/iap/docs/oauth-client-creation">Create</a> or use an
existing OAuth 2.0 client ID.</strong> To use an existing OAuth 2.0 client ID,
follow the steps in
<a href="https://cloud.google.com/iap/docs/sharing-oauth-clients">How to share OAuth Clients</a>.</li>
<li><strong>Add the OAuth ID to the allowlist for
<a href="https://cloud.google.com/iap/docs/sharing-oauth-clients#programmatic_access">programmatic access</a>
for the application.</strong> Since Cloud Run is not yet a supported resource type
in gcloud iap, you must allowlist the Client ID on the project.</li>
<li><strong>Create a service account.</strong>
<a href="https://cloud.google.com/iam/docs/service-accounts-create#creating">Documentation</a>,
<a href="https://console.cloud.google.com/iam-admin/serviceaccounts">Cloud Console Link</a></li>
<li><strong>Add both the service account and users to the IAP Policy</strong> in the
â€œSecurityâ€ tab of the Cloud Run service itself or via gcloud.</li>
<li><strong>Grant all users and groups</strong> who will access the MCP Server the necessary
permissions to
<a href="https://cloud.google.com/docs/authentication/use-service-account-impersonation">impersonate the service account</a>
(i.e., <code dir="auto">roles/iam.serviceAccountTokenCreator</code>).</li>
<li><strong><a href="https://console.cloud.google.com/apis/library/iamcredentials.googleapis.com">Enable</a>
the IAM Credentials API</strong> for your project.</li>
</ol>
<div class="sl-heading-wrapper level-h3"><h3 id="example-configurations">Example configurations</h3><a class="sl-anchor-link" href="#example-configurations"><span aria-hidden="true" class="sl-anchor-icon"><svg width="16" height="16" viewBox="0 0 24 24"><path fill="currentcolor" d="m12.11 15.39-3.88 3.88a2.52 2.52 0 0 1-3.5 0 2.47 2.47 0 0 1 0-3.5l3.88-3.88a1 1 0 0 0-1.42-1.42l-3.88 3.89a4.48 4.48 0 0 0 6.33 6.33l3.89-3.88a1 1 0 1 0-1.42-1.42Zm8.58-12.08a4.49 4.49 0 0 0-6.33 0l-3.89 3.88a1 1 0 0 0 1.42 1.42l3.88-3.88a2.52 2.52 0 0 1 3.5 0 2.47 2.47 0 0 1 0 3.5l-3.88 3.88a1 1 0 1 0 1.42 1.42l3.88-3.89a4.49 4.49 0 0 0 0-6.33ZM8.83 15.17a1 1 0 0 0 1.1.22 1 1 0 0 0 .32-.22l4.92-4.92a1 1 0 0 0-1.42-1.42l-4.92 4.92a1 1 0 0 0 0 1.42Z"></path></svg></span><span class="sr-only">Section titled â€œExample configurationsâ€</span></a></div>
<div class="sl-heading-wrapper level-h4"><h4 id="python-mcp-server-stdio">Python MCP server (stdio)</h4><a class="sl-anchor-link" href="#python-mcp-server-stdio"><span aria-hidden="true" class="sl-anchor-icon"><svg width="16" height="16" viewBox="0 0 24 24"><path fill="currentcolor" d="m12.11 15.39-3.88 3.88a2.52 2.52 0 0 1-3.5 0 2.47 2.47 0 0 1 0-3.5l3.88-3.88a1 1 0 0 0-1.42-1.42l-3.88 3.89a4.48 4.48 0 0 0 6.33 6.33l3.89-3.88a1 1 0 1 0-1.42-1.42Zm8.58-12.08a4.49 4.49 0 0 0-6.33 0l-3.89 3.88a1 1 0 0 0 1.42 1.42l3.88-3.88a2.52 2.52 0 0 1 3.5 0 2.47 2.47 0 0 1 0 3.5l-3.88 3.88a1 1 0 1 0 1.42 1.42l3.88-3.89a4.49 4.49 0 0 0 0-6.33ZM8.83 15.17a1 1 0 0 0 1.1.22 1 1 0 0 0 .32-.22l4.92-4.92a1 1 0 0 0-1.42-1.42l-4.92 4.92a1 1 0 0 0 0 1.42Z"></path></svg></span><span class="sr-only">Section titled â€œPython MCP server (stdio)â€</span></a></div>
<div class="expressive-code"><figure class="frame not-content"><figcaption class="header"></figcaption><pre data-language="json"><code><div class="ec-line"><div class="code"><span style="--0:#E1DFDF;--1:#292929">{</span></div></div><div class="ec-line"><div class="code"><span class="indent">  </span><span style="--0:#85CDF1;--1:#00709A">"mcpServers"</span><span style="--0:#E1DFDF;--1:#292929">: {</span></div></div><div class="ec-line"><div class="code"><span class="indent">    </span><span style="--0:#85CDF1;--1:#00709A">"pythonTools"</span><span style="--0:#E1DFDF;--1:#292929">: {</span></div></div><div class="ec-line"><div class="code"><span class="indent">      </span><span style="--0:#85CDF1;--1:#00709A">"command"</span><span style="--0:#E1DFDF;--1:#292929">: </span><span style="--0:#77D5A3;--1:#007847">"python"</span><span style="--0:#E1DFDF;--1:#292929">,</span></div></div><div class="ec-line"><div class="code"><span class="indent">      </span><span style="--0:#85CDF1;--1:#00709A">"args"</span><span style="--0:#E1DFDF;--1:#292929">: [</span><span style="--0:#77D5A3;--1:#007847">"-m"</span><span style="--0:#E1DFDF;--1:#292929">, </span><span style="--0:#77D5A3;--1:#007847">"my_mcp_server"</span><span style="--0:#E1DFDF;--1:#292929">, </span><span style="--0:#77D5A3;--1:#007847">"--port"</span><span style="--0:#E1DFDF;--1:#292929">, </span><span style="--0:#77D5A3;--1:#007847">"8080"</span><span style="--0:#E1DFDF;--1:#292929">],</span></div></div><div class="ec-line"><div class="code"><span class="indent">      </span><span style="--0:#85CDF1;--1:#00709A">"cwd"</span><span style="--0:#E1DFDF;--1:#292929">: </span><span style="--0:#77D5A3;--1:#007847">"./mcp-servers/python"</span><span style="--0:#E1DFDF;--1:#292929">,</span></div></div><div class="ec-line"><div class="code"><span class="indent">      </span><span style="--0:#85CDF1;--1:#00709A">"env"</span><span style="--0:#E1DFDF;--1:#292929">: {</span></div></div><div class="ec-line"><div class="code"><span class="indent">        </span><span style="--0:#85CDF1;--1:#00709A">"DATABASE_URL"</span><span style="--0:#E1DFDF;--1:#292929">: </span><span style="--0:#77D5A3;--1:#007847">"$DB_CONNECTION_STRING"</span><span style="--0:#E1DFDF;--1:#292929">,</span></div></div><div class="ec-line"><div class="code"><span class="indent">        </span><span style="--0:#85CDF1;--1:#00709A">"API_KEY"</span><span style="--0:#E1DFDF;--1:#292929">: </span><span style="--0:#77D5A3;--1:#007847">"${EXTERNAL_API_KEY}"</span></div></div><div class="ec-line"><div class="code"><span class="indent"><span style="--0:#E1DFDF;--1:#292929">      </span></span><span style="--0:#E1DFDF;--1:#292929">},</span></div></div><div class="ec-line"><div class="code"><span class="indent">      </span><span style="--0:#85CDF1;--1:#00709A">"timeout"</span><span style="--0:#E1DFDF;--1:#292929">: </span><span style="--0:#8DA8FF;--1:#3252B8">15000</span></div></div><div class="ec-line"><div class="code"><span class="indent"><span style="--0:#E1DFDF;--1:#292929">    </span></span><span style="--0:#E1DFDF;--1:#292929">}</span></div></div><div class="ec-line"><div class="code"><span class="indent"><span style="--0:#E1DFDF;--1:#292929">  </span></span><span style="--0:#E1DFDF;--1:#292929">}</span></div></div><div class="ec-line"><div class="code"><span style="--0:#E1DFDF;--1:#292929">}</span></div></div></code></pre><div class="copy"><button title="Copy to clipboard" data-copied="Copied!" data-code="{  &#x22;mcpServers&#x22;: {    &#x22;pythonTools&#x22;: {      &#x22;command&#x22;: &#x22;python&#x22;,      &#x22;args&#x22;: [&#x22;-m&#x22;, &#x22;my_mcp_server&#x22;, &#x22;--port&#x22;, &#x22;8080&#x22;],      &#x22;cwd&#x22;: &#x22;./mcp-servers/python&#x22;,      &#x22;env&#x22;: {        &#x22;DATABASE_URL&#x22;: &#x22;$DB_CONNECTION_STRING&#x22;,        &#x22;API_KEY&#x22;: &#x22;${EXTERNAL_API_KEY}&#x22;      },      &#x22;timeout&#x22;: 15000    }  }}"><div></div></button></div></figure></div>
<div class="sl-heading-wrapper level-h4"><h4 id="nodejs-mcp-server-stdio">Node.js MCP server (stdio)</h4><a class="sl-anchor-link" href="#nodejs-mcp-server-stdio"><span aria-hidden="true" class="sl-anchor-icon"><svg width="16" height="16" viewBox="0 0 24 24"><path fill="currentcolor" d="m12.11 15.39-3.88 3.88a2.52 2.52 0 0 1-3.5 0 2.47 2.47 0 0 1 0-3.5l3.88-3.88a1 1 0 0 0-1.42-1.42l-3.88 3.89a4.48 4.48 0 0 0 6.33 6.33l3.89-3.88a1 1 0 1 0-1.42-1.42Zm8.58-12.08a4.49 4.49 0 0 0-6.33 0l-3.89 3.88a1 1 0 0 0 1.42 1.42l3.88-3.88a2.52 2.52 0 0 1 3.5 0 2.47 2.47 0 0 1 0 3.5l-3.88 3.88a1 1 0 1 0 1.42 1.42l3.88-3.89a4.49 4.49 0 0 0 0-6.33ZM8.83 15.17a1 1 0 0 0 1.1.22 1 1 0 0 0 .32-.22l4.92-4.92a1 1 0 0 0-1.42-1.42l-4.92 4.92a1 1 0 0 0 0 1.42Z"></path></svg></span><span class="sr-only">Section titled â€œNode.js MCP server (stdio)â€</span></a></div>
<div class="expressive-code"><figure class="frame not-content"><figcaption class="header"></figcaption><pre data-language="json"><code><div class="ec-line"><div class="code"><span style="--0:#E1DFDF;--1:#292929">{</span></div></div><div class="ec-line"><div class="code"><span class="indent">  </span><span style="--0:#85CDF1;--1:#00709A">"mcpServers"</span><span style="--0:#E1DFDF;--1:#292929">: {</span></div></div><div class="ec-line"><div class="code"><span class="indent">    </span><span style="--0:#85CDF1;--1:#00709A">"nodeServer"</span><span style="--0:#E1DFDF;--1:#292929">: {</span></div></div><div class="ec-line"><div class="code"><span class="indent">      </span><span style="--0:#85CDF1;--1:#00709A">"command"</span><span style="--0:#E1DFDF;--1:#292929">: </span><span style="--0:#77D5A3;--1:#007847">"node"</span><span style="--0:#E1DFDF;--1:#292929">,</span></div></div><div class="ec-line"><div class="code"><span class="indent">      </span><span style="--0:#85CDF1;--1:#00709A">"args"</span><span style="--0:#E1DFDF;--1:#292929">: [</span><span style="--0:#77D5A3;--1:#007847">"dist/server.js"</span><span style="--0:#E1DFDF;--1:#292929">, </span><span style="--0:#77D5A3;--1:#007847">"--verbose"</span><span style="--0:#E1DFDF;--1:#292929">],</span></div></div><div class="ec-line"><div class="code"><span class="indent">      </span><span style="--0:#85CDF1;--1:#00709A">"cwd"</span><span style="--0:#E1DFDF;--1:#292929">: </span><span style="--0:#77D5A3;--1:#007847">"./mcp-servers/node"</span><span style="--0:#E1DFDF;--1:#292929">,</span></div></div><div class="ec-line"><div class="code"><span class="indent">      </span><span style="--0:#85CDF1;--1:#00709A">"trust"</span><span style="--0:#E1DFDF;--1:#292929">: </span><span style="--0:#8DA8FF;--1:#3252B8">true</span></div></div><div class="ec-line"><div class="code"><span class="indent"><span style="--0:#E1DFDF;--1:#292929">    </span></span><span style="--0:#E1DFDF;--1:#292929">}</span></div></div><div class="ec-line"><div class="code"><span class="indent"><span style="--0:#E1DFDF;--1:#292929">  </span></span><span style="--0:#E1DFDF;--1:#292929">}</span></div></div><div class="ec-line"><div class="code"><span style="--0:#E1DFDF;--1:#292929">}</span></div></div></code></pre><div class="copy"><button title="Copy to clipboard" data-copied="Copied!" data-code="{  &#x22;mcpServers&#x22;: {    &#x22;nodeServer&#x22;: {      &#x22;command&#x22;: &#x22;node&#x22;,      &#x22;args&#x22;: [&#x22;dist/server.js&#x22;, &#x22;--verbose&#x22;],      &#x22;cwd&#x22;: &#x22;./mcp-servers/node&#x22;,      &#x22;trust&#x22;: true    }  }}"><div></div></button></div></figure></div>
<div class="sl-heading-wrapper level-h4"><h4 id="docker-based-mcp-server">Docker-based MCP server</h4><a class="sl-anchor-link" href="#docker-based-mcp-server"><span aria-hidden="true" class="sl-anchor-icon"><svg width="16" height="16" viewBox="0 0 24 24"><path fill="currentcolor" d="m12.11 15.39-3.88 3.88a2.52 2.52 0 0 1-3.5 0 2.47 2.47 0 0 1 0-3.5l3.88-3.88a1 1 0 0 0-1.42-1.42l-3.88 3.89a4.48 4.48 0 0 0 6.33 6.33l3.89-3.88a1 1 0 1 0-1.42-1.42Zm8.58-12.08a4.49 4.49 0 0 0-6.33 0l-3.89 3.88a1 1 0 0 0 1.42 1.42l3.88-3.88a2.52 2.52 0 0 1 3.5 0 2.47 2.47 0 0 1 0 3.5l-3.88 3.88a1 1 0 1 0 1.42 1.42l3.88-3.89a4.49 4.49 0 0 0 0-6.33ZM8.83 15.17a1 1 0 0 0 1.1.22 1 1 0 0 0 .32-.22l4.92-4.92a1 1 0 0 0-1.42-1.42l-4.92 4.92a1 1 0 0 0 0 1.42Z"></path></svg></span><span class="sr-only">Section titled â€œDocker-based MCP serverâ€</span></a></div>
<div class="expressive-code"><figure class="frame not-content"><figcaption class="header"></figcaption><pre data-language="json"><code><div class="ec-line"><div class="code"><span style="--0:#E1DFDF;--1:#292929">{</span></div></div><div class="ec-line"><div class="code"><span class="indent">  </span><span style="--0:#85CDF1;--1:#00709A">"mcpServers"</span><span style="--0:#E1DFDF;--1:#292929">: {</span></div></div><div class="ec-line"><div class="code"><span class="indent">    </span><span style="--0:#85CDF1;--1:#00709A">"dockerizedServer"</span><span style="--0:#E1DFDF;--1:#292929">: {</span></div></div><div class="ec-line"><div class="code"><span class="indent">      </span><span style="--0:#85CDF1;--1:#00709A">"command"</span><span style="--0:#E1DFDF;--1:#292929">: </span><span style="--0:#77D5A3;--1:#007847">"docker"</span><span style="--0:#E1DFDF;--1:#292929">,</span></div></div><div class="ec-line"><div class="code"><span class="indent">      </span><span style="--0:#85CDF1;--1:#00709A">"args"</span><span style="--0:#E1DFDF;--1:#292929">: [</span></div></div><div class="ec-line"><div class="code"><span class="indent">        </span><span style="--0:#77D5A3;--1:#007847">"run"</span><span style="--0:#E1DFDF;--1:#292929">,</span></div></div><div class="ec-line"><div class="code"><span class="indent">        </span><span style="--0:#77D5A3;--1:#007847">"-i"</span><span style="--0:#E1DFDF;--1:#292929">,</span></div></div><div class="ec-line"><div class="code"><span class="indent">        </span><span style="--0:#77D5A3;--1:#007847">"--rm"</span><span style="--0:#E1DFDF;--1:#292929">,</span></div></div><div class="ec-line"><div class="code"><span class="indent">        </span><span style="--0:#77D5A3;--1:#007847">"-e"</span><span style="--0:#E1DFDF;--1:#292929">,</span></div></div><div class="ec-line"><div class="code"><span class="indent">        </span><span style="--0:#77D5A3;--1:#007847">"API_KEY"</span><span style="--0:#E1DFDF;--1:#292929">,</span></div></div><div class="ec-line"><div class="code"><span class="indent">        </span><span style="--0:#77D5A3;--1:#007847">"-v"</span><span style="--0:#E1DFDF;--1:#292929">,</span></div></div><div class="ec-line"><div class="code"><span class="indent">        </span><span style="--0:#77D5A3;--1:#007847">"${PWD}:/workspace"</span><span style="--0:#E1DFDF;--1:#292929">,</span></div></div><div class="ec-line"><div class="code"><span class="indent">        </span><span style="--0:#77D5A3;--1:#007847">"my-mcp-server:latest"</span></div></div><div class="ec-line"><div class="code"><span class="indent"><span style="--0:#E1DFDF;--1:#292929">      </span></span><span style="--0:#E1DFDF;--1:#292929">],</span></div></div><div class="ec-line"><div class="code"><span class="indent">      </span><span style="--0:#85CDF1;--1:#00709A">"env"</span><span style="--0:#E1DFDF;--1:#292929">: {</span></div></div><div class="ec-line"><div class="code"><span class="indent">        </span><span style="--0:#85CDF1;--1:#00709A">"API_KEY"</span><span style="--0:#E1DFDF;--1:#292929">: </span><span style="--0:#77D5A3;--1:#007847">"$EXTERNAL_SERVICE_TOKEN"</span></div></div><div class="ec-line"><div class="code"><span class="indent"><span style="--0:#E1DFDF;--1:#292929">      </span></span><span style="--0:#E1DFDF;--1:#292929">}</span></div></div><div class="ec-line"><div class="code"><span class="indent"><span style="--0:#E1DFDF;--1:#292929">    </span></span><span style="--0:#E1DFDF;--1:#292929">}</span></div></div><div class="ec-line"><div class="code"><span class="indent"><span style="--0:#E1DFDF;--1:#292929">  </span></span><span style="--0:#E1DFDF;--1:#292929">}</span></div></div><div class="ec-line"><div class="code"><span style="--0:#E1DFDF;--1:#292929">}</span></div></div></code></pre><div class="copy"><button title="Copy to clipboard" data-copied="Copied!" data-code="{  &#x22;mcpServers&#x22;: {    &#x22;dockerizedServer&#x22;: {      &#x22;command&#x22;: &#x22;docker&#x22;,      &#x22;args&#x22;: [        &#x22;run&#x22;,        &#x22;-i&#x22;,        &#x22;--rm&#x22;,        &#x22;-e&#x22;,        &#x22;API_KEY&#x22;,        &#x22;-v&#x22;,        &#x22;${PWD}:/workspace&#x22;,        &#x22;my-mcp-server:latest&#x22;      ],      &#x22;env&#x22;: {        &#x22;API_KEY&#x22;: &#x22;$EXTERNAL_SERVICE_TOKEN&#x22;      }    }  }}"><div></div></button></div></figure></div>
<div class="sl-heading-wrapper level-h4"><h4 id="http-based-mcp-server">HTTP-based MCP server</h4><a class="sl-anchor-link" href="#http-based-mcp-server"><span aria-hidden="true" class="sl-anchor-icon"><svg width="16" height="16" viewBox="0 0 24 24"><path fill="currentcolor" d="m12.11 15.39-3.88 3.88a2.52 2.52 0 0 1-3.5 0 2.47 2.47 0 0 1 0-3.5l3.88-3.88a1 1 0 0 0-1.42-1.42l-3.88 3.89a4.48 4.48 0 0 0 6.33 6.33l3.89-3.88a1 1 0 1 0-1.42-1.42Zm8.58-12.08a4.49 4.49 0 0 0-6.33 0l-3.89 3.88a1 1 0 0 0 1.42 1.42l3.88-3.88a2.52 2.52 0 0 1 3.5 0 2.47 2.47 0 0 1 0 3.5l-3.88 3.88a1 1 0 1 0 1.42 1.42l3.88-3.89a4.49 4.49 0 0 0 0-6.33ZM8.83 15.17a1 1 0 0 0 1.1.22 1 1 0 0 0 .32-.22l4.92-4.92a1 1 0 0 0-1.42-1.42l-4.92 4.92a1 1 0 0 0 0 1.42Z"></path></svg></span><span class="sr-only">Section titled â€œHTTP-based MCP serverâ€</span></a></div>
<div class="expressive-code"><figure class="frame not-content"><figcaption class="header"></figcaption><pre data-language="json"><code><div class="ec-line"><div class="code"><span style="--0:#E1DFDF;--1:#292929">{</span></div></div><div class="ec-line"><div class="code"><span class="indent">  </span><span style="--0:#85CDF1;--1:#00709A">"mcpServers"</span><span style="--0:#E1DFDF;--1:#292929">: {</span></div></div><div class="ec-line"><div class="code"><span class="indent">    </span><span style="--0:#85CDF1;--1:#00709A">"httpServer"</span><span style="--0:#E1DFDF;--1:#292929">: {</span></div></div><div class="ec-line"><div class="code"><span class="indent">      </span><span style="--0:#85CDF1;--1:#00709A">"httpUrl"</span><span style="--0:#E1DFDF;--1:#292929">: </span><span style="--0:#77D5A3;--1:#007847">"http://localhost:3000/mcp"</span><span style="--0:#E1DFDF;--1:#292929">,</span></div></div><div class="ec-line"><div class="code"><span class="indent">      </span><span style="--0:#85CDF1;--1:#00709A">"timeout"</span><span style="--0:#E1DFDF;--1:#292929">: </span><span style="--0:#8DA8FF;--1:#3252B8">5000</span></div></div><div class="ec-line"><div class="code"><span class="indent"><span style="--0:#E1DFDF;--1:#292929">    </span></span><span style="--0:#E1DFDF;--1:#292929">}</span></div></div><div class="ec-line"><div class="code"><span class="indent"><span style="--0:#E1DFDF;--1:#292929">  </span></span><span style="--0:#E1DFDF;--1:#292929">}</span></div></div><div class="ec-line"><div class="code"><span style="--0:#E1DFDF;--1:#292929">}</span></div></div></code></pre><div class="copy"><button title="Copy to clipboard" data-copied="Copied!" data-code="{  &#x22;mcpServers&#x22;: {    &#x22;httpServer&#x22;: {      &#x22;httpUrl&#x22;: &#x22;http://localhost:3000/mcp&#x22;,      &#x22;timeout&#x22;: 5000    }  }}"><div></div></button></div></figure></div>
<div class="sl-heading-wrapper level-h4"><h4 id="http-based-mcp-server-with-custom-headers">HTTP-based MCP Server with custom headers</h4><a class="sl-anchor-link" href="#http-based-mcp-server-with-custom-headers"><span aria-hidden="true" class="sl-anchor-icon"><svg width="16" height="16" viewBox="0 0 24 24"><path fill="currentcolor" d="m12.11 15.39-3.88 3.88a2.52 2.52 0 0 1-3.5 0 2.47 2.47 0 0 1 0-3.5l3.88-3.88a1 1 0 0 0-1.42-1.42l-3.88 3.89a4.48 4.48 0 0 0 6.33 6.33l3.89-3.88a1 1 0 1 0-1.42-1.42Zm8.58-12.08a4.49 4.49 0 0 0-6.33 0l-3.89 3.88a1 1 0 0 0 1.42 1.42l3.88-3.88a2.52 2.52 0 0 1 3.5 0 2.47 2.47 0 0 1 0 3.5l-3.88 3.88a1 1 0 1 0 1.42 1.42l3.88-3.89a4.49 4.49 0 0 0 0-6.33ZM8.83 15.17a1 1 0 0 0 1.1.22 1 1 0 0 0 .32-.22l4.92-4.92a1 1 0 0 0-1.42-1.42l-4.92 4.92a1 1 0 0 0 0 1.42Z"></path></svg></span><span class="sr-only">Section titled â€œHTTP-based MCP Server with custom headersâ€</span></a></div>
<div class="expressive-code"><figure class="frame not-content"><figcaption class="header"></figcaption><pre data-language="json"><code><div class="ec-line"><div class="code"><span style="--0:#E1DFDF;--1:#292929">{</span></div></div><div class="ec-line"><div class="code"><span class="indent">  </span><span style="--0:#85CDF1;--1:#00709A">"mcpServers"</span><span style="--0:#E1DFDF;--1:#292929">: {</span></div></div><div class="ec-line"><div class="code"><span class="indent">    </span><span style="--0:#85CDF1;--1:#00709A">"httpServerWithAuth"</span><span style="--0:#E1DFDF;--1:#292929">: {</span></div></div><div class="ec-line"><div class="code"><span class="indent">      </span><span style="--0:#85CDF1;--1:#00709A">"httpUrl"</span><span style="--0:#E1DFDF;--1:#292929">: </span><span style="--0:#77D5A3;--1:#007847">"http://localhost:3000/mcp"</span><span style="--0:#E1DFDF;--1:#292929">,</span></div></div><div class="ec-line"><div class="code"><span class="indent">      </span><span style="--0:#85CDF1;--1:#00709A">"headers"</span><span style="--0:#E1DFDF;--1:#292929">: {</span></div></div><div class="ec-line"><div class="code"><span class="indent">        </span><span style="--0:#85CDF1;--1:#00709A">"Authorization"</span><span style="--0:#E1DFDF;--1:#292929">: </span><span style="--0:#77D5A3;--1:#007847">"Bearer your-api-token"</span><span style="--0:#E1DFDF;--1:#292929">,</span></div></div><div class="ec-line"><div class="code"><span class="indent">        </span><span style="--0:#85CDF1;--1:#00709A">"X-Custom-Header"</span><span style="--0:#E1DFDF;--1:#292929">: </span><span style="--0:#77D5A3;--1:#007847">"custom-value"</span><span style="--0:#E1DFDF;--1:#292929">,</span></div></div><div class="ec-line"><div class="code"><span class="indent">        </span><span style="--0:#85CDF1;--1:#00709A">"Content-Type"</span><span style="--0:#E1DFDF;--1:#292929">: </span><span style="--0:#77D5A3;--1:#007847">"application/json"</span></div></div><div class="ec-line"><div class="code"><span class="indent"><span style="--0:#E1DFDF;--1:#292929">      </span></span><span style="--0:#E1DFDF;--1:#292929">},</span></div></div><div class="ec-line"><div class="code"><span class="indent">      </span><span style="--0:#85CDF1;--1:#00709A">"timeout"</span><span style="--0:#E1DFDF;--1:#292929">: </span><span style="--0:#8DA8FF;--1:#3252B8">5000</span></div></div><div class="ec-line"><div class="code"><span class="indent"><span style="--0:#E1DFDF;--1:#292929">    </span></span><span style="--0:#E1DFDF;--1:#292929">}</span></div></div><div class="ec-line"><div class="code"><span class="indent"><span style="--0:#E1DFDF;--1:#292929">  </span></span><span style="--0:#E1DFDF;--1:#292929">}</span></div></div><div class="ec-line"><div class="code"><span style="--0:#E1DFDF;--1:#292929">}</span></div></div></code></pre><div class="copy"><button title="Copy to clipboard" data-copied="Copied!" data-code="{  &#x22;mcpServers&#x22;: {    &#x22;httpServerWithAuth&#x22;: {      &#x22;httpUrl&#x22;: &#x22;http://localhost:3000/mcp&#x22;,      &#x22;headers&#x22;: {        &#x22;Authorization&#x22;: &#x22;Bearer your-api-token&#x22;,        &#x22;X-Custom-Header&#x22;: &#x22;custom-value&#x22;,        &#x22;Content-Type&#x22;: &#x22;application/json&#x22;      },      &#x22;timeout&#x22;: 5000    }  }}"><div></div></button></div></figure></div>
<div class="sl-heading-wrapper level-h4"><h4 id="mcp-server-with-tool-filtering">MCP server with tool filtering</h4><a class="sl-anchor-link" href="#mcp-server-with-tool-filtering"><span aria-hidden="true" class="sl-anchor-icon"><svg width="16" height="16" viewBox="0 0 24 24"><path fill="currentcolor" d="m12.11 15.39-3.88 3.88a2.52 2.52 0 0 1-3.5 0 2.47 2.47 0 0 1 0-3.5l3.88-3.88a1 1 0 0 0-1.42-1.42l-3.88 3.89a4.48 4.48 0 0 0 6.33 6.33l3.89-3.88a1 1 0 1 0-1.42-1.42Zm8.58-12.08a4.49 4.49 0 0 0-6.33 0l-3.89 3.88a1 1 0 0 0 1.42 1.42l3.88-3.88a2.52 2.52 0 0 1 3.5 0 2.47 2.47 0 0 1 0 3.5l-3.88 3.88a1 1 0 1 0 1.42 1.42l3.88-3.89a4.49 4.49 0 0 0 0-6.33ZM8.83 15.17a1 1 0 0 0 1.1.22 1 1 0 0 0 .32-.22l4.92-4.92a1 1 0 0 0-1.42-1.42l-4.92 4.92a1 1 0 0 0 0 1.42Z"></path></svg></span><span class="sr-only">Section titled â€œMCP server with tool filteringâ€</span></a></div>
<div class="expressive-code"><figure class="frame not-content"><figcaption class="header"></figcaption><pre data-language="json"><code><div class="ec-line"><div class="code"><span style="--0:#E1DFDF;--1:#292929">{</span></div></div><div class="ec-line"><div class="code"><span class="indent">  </span><span style="--0:#85CDF1;--1:#00709A">"mcpServers"</span><span style="--0:#E1DFDF;--1:#292929">: {</span></div></div><div class="ec-line"><div class="code"><span class="indent">    </span><span style="--0:#85CDF1;--1:#00709A">"filteredServer"</span><span style="--0:#E1DFDF;--1:#292929">: {</span></div></div><div class="ec-line"><div class="code"><span class="indent">      </span><span style="--0:#85CDF1;--1:#00709A">"command"</span><span style="--0:#E1DFDF;--1:#292929">: </span><span style="--0:#77D5A3;--1:#007847">"python"</span><span style="--0:#E1DFDF;--1:#292929">,</span></div></div><div class="ec-line"><div class="code"><span class="indent">      </span><span style="--0:#85CDF1;--1:#00709A">"args"</span><span style="--0:#E1DFDF;--1:#292929">: [</span><span style="--0:#77D5A3;--1:#007847">"-m"</span><span style="--0:#E1DFDF;--1:#292929">, </span><span style="--0:#77D5A3;--1:#007847">"my_mcp_server"</span><span style="--0:#E1DFDF;--1:#292929">],</span></div></div><div class="ec-line"><div class="code"><span class="indent">      </span><span style="--0:#85CDF1;--1:#00709A">"includeTools"</span><span style="--0:#E1DFDF;--1:#292929">: [</span><span style="--0:#77D5A3;--1:#007847">"safe_tool"</span><span style="--0:#E1DFDF;--1:#292929">, </span><span style="--0:#77D5A3;--1:#007847">"file_reader"</span><span style="--0:#E1DFDF;--1:#292929">, </span><span style="--0:#77D5A3;--1:#007847">"data_processor"</span><span style="--0:#E1DFDF;--1:#292929">],</span></div></div><div class="ec-line"><div class="code"><span class="indent">      </span><span style="--0:#8E8E8E;--1:#686868">// "excludeTools": ["dangerous_tool", "file_deleter"],</span></div></div><div class="ec-line"><div class="code"><span class="indent">      </span><span style="--0:#85CDF1;--1:#00709A">"timeout"</span><span style="--0:#E1DFDF;--1:#292929">: </span><span style="--0:#8DA8FF;--1:#3252B8">30000</span></div></div><div class="ec-line"><div class="code"><span class="indent"><span style="--0:#E1DFDF;--1:#292929">    </span></span><span style="--0:#E1DFDF;--1:#292929">}</span></div></div><div class="ec-line"><div class="code"><span class="indent"><span style="--0:#E1DFDF;--1:#292929">  </span></span><span style="--0:#E1DFDF;--1:#292929">}</span></div></div><div class="ec-line"><div class="code"><span style="--0:#E1DFDF;--1:#292929">}</span></div></div></code></pre><div class="copy"><button title="Copy to clipboard" data-copied="Copied!" data-code="{  &#x22;mcpServers&#x22;: {    &#x22;filteredServer&#x22;: {      &#x22;command&#x22;: &#x22;python&#x22;,      &#x22;args&#x22;: [&#x22;-m&#x22;, &#x22;my_mcp_server&#x22;],      &#x22;includeTools&#x22;: [&#x22;safe_tool&#x22;, &#x22;file_reader&#x22;, &#x22;data_processor&#x22;],      // &#x22;excludeTools&#x22;: [&#x22;dangerous_tool&#x22;, &#x22;file_deleter&#x22;],      &#x22;timeout&#x22;: 30000    }  }}"><div></div></button></div></figure></div>
<div class="sl-heading-wrapper level-h3"><h3 id="sse-mcp-server-with-sa-impersonation">SSE MCP server with SA impersonation</h3><a class="sl-anchor-link" href="#sse-mcp-server-with-sa-impersonation"><span aria-hidden="true" class="sl-anchor-icon"><svg width="16" height="16" viewBox="0 0 24 24"><path fill="currentcolor" d="m12.11 15.39-3.88 3.88a2.52 2.52 0 0 1-3.5 0 2.47 2.47 0 0 1 0-3.5l3.88-3.88a1 1 0 0 0-1.42-1.42l-3.88 3.89a4.48 4.48 0 0 0 6.33 6.33l3.89-3.88a1 1 0 1 0-1.42-1.42Zm8.58-12.08a4.49 4.49 0 0 0-6.33 0l-3.89 3.88a1 1 0 0 0 1.42 1.42l3.88-3.88a2.52 2.52 0 0 1 3.5 0 2.47 2.47 0 0 1 0 3.5l-3.88 3.88a1 1 0 1 0 1.42 1.42l3.88-3.89a4.49 4.49 0 0 0 0-6.33ZM8.83 15.17a1 1 0 0 0 1.1.22 1 1 0 0 0 .32-.22l4.92-4.92a1 1 0 0 0-1.42-1.42l-4.92 4.92a1 1 0 0 0 0 1.42Z"></path></svg></span><span class="sr-only">Section titled â€œSSE MCP server with SA impersonationâ€</span></a></div>
<div class="expressive-code"><figure class="frame not-content"><figcaption class="header"></figcaption><pre data-language="json"><code><div class="ec-line"><div class="code"><span style="--0:#E1DFDF;--1:#292929">{</span></div></div><div class="ec-line"><div class="code"><span class="indent">  </span><span style="--0:#85CDF1;--1:#00709A">"mcpServers"</span><span style="--0:#E1DFDF;--1:#292929">: {</span></div></div><div class="ec-line"><div class="code"><span class="indent">    </span><span style="--0:#85CDF1;--1:#00709A">"myIapProtectedServer"</span><span style="--0:#E1DFDF;--1:#292929">: {</span></div></div><div class="ec-line"><div class="code"><span class="indent">      </span><span style="--0:#85CDF1;--1:#00709A">"url"</span><span style="--0:#E1DFDF;--1:#292929">: </span><span style="--0:#77D5A3;--1:#007847">"https://my-iap-service.run.app/sse"</span><span style="--0:#E1DFDF;--1:#292929">,</span></div></div><div class="ec-line"><div class="code"><span class="indent">      </span><span style="--0:#85CDF1;--1:#00709A">"authProviderType"</span><span style="--0:#E1DFDF;--1:#292929">: </span><span style="--0:#77D5A3;--1:#007847">"service_account_impersonation"</span><span style="--0:#E1DFDF;--1:#292929">,</span></div></div><div class="ec-line"><div class="code"><span class="indent">      </span><span style="--0:#85CDF1;--1:#00709A">"targetAudience"</span><span style="--0:#E1DFDF;--1:#292929">: </span><span style="--0:#77D5A3;--1:#007847">"YOUR_IAP_CLIENT_ID.apps.googleusercontent.com"</span><span style="--0:#E1DFDF;--1:#292929">,</span></div></div><div class="ec-line"><div class="code"><span class="indent">      </span><span style="--0:#85CDF1;--1:#00709A">"targetServiceAccount"</span><span style="--0:#E1DFDF;--1:#292929">: </span><span style="--0:#77D5A3;--1:#007847">"your-sa@your-project.iam.gserviceaccount.com"</span></div></div><div class="ec-line"><div class="code"><span class="indent"><span style="--0:#E1DFDF;--1:#292929">    </span></span><span style="--0:#E1DFDF;--1:#292929">}</span></div></div><div class="ec-line"><div class="code"><span class="indent"><span style="--0:#E1DFDF;--1:#292929">  </span></span><span style="--0:#E1DFDF;--1:#292929">}</span></div></div><div class="ec-line"><div class="code"><span style="--0:#E1DFDF;--1:#292929">}</span></div></div></code></pre><div class="copy"><button title="Copy to clipboard" data-copied="Copied!" data-code="{  &#x22;mcpServers&#x22;: {    &#x22;myIapProtectedServer&#x22;: {      &#x22;url&#x22;: &#x22;https://my-iap-service.run.app/sse&#x22;,      &#x22;authProviderType&#x22;: &#x22;service_account_impersonation&#x22;,      &#x22;targetAudience&#x22;: &#x22;YOUR_IAP_CLIENT_ID.apps.googleusercontent.com&#x22;,      &#x22;targetServiceAccount&#x22;: &#x22;your-sa@your-project.iam.gserviceaccount.com&#x22;    }  }}"><div></div></button></div></figure></div>
<div class="sl-heading-wrapper level-h2"><h2 id="discovery-process-deep-dive">Discovery process deep dive</h2><a class="sl-anchor-link" href="#discovery-process-deep-dive"><span aria-hidden="true" class="sl-anchor-icon"><svg width="16" height="16" viewBox="0 0 24 24"><path fill="currentcolor" d="m12.11 15.39-3.88 3.88a2.52 2.52 0 0 1-3.5 0 2.47 2.47 0 0 1 0-3.5l3.88-3.88a1 1 0 0 0-1.42-1.42l-3.88 3.89a4.48 4.48 0 0 0 6.33 6.33l3.89-3.88a1 1 0 1 0-1.42-1.42Zm8.58-12.08a4.49 4.49 0 0 0-6.33 0l-3.89 3.88a1 1 0 0 0 1.42 1.42l3.88-3.88a2.52 2.52 0 0 1 3.5 0 2.47 2.47 0 0 1 0 3.5l-3.88 3.88a1 1 0 1 0 1.42 1.42l3.88-3.89a4.49 4.49 0 0 0 0-6.33ZM8.83 15.17a1 1 0 0 0 1.1.22 1 1 0 0 0 .32-.22l4.92-4.92a1 1 0 0 0-1.42-1.42l-4.92 4.92a1 1 0 0 0 0 1.42Z"></path></svg></span><span class="sr-only">Section titled â€œDiscovery process deep diveâ€</span></a></div>
<p>When the Gemini CLI starts, it performs MCP server discovery through the
following detailed process:</p>
<div class="sl-heading-wrapper level-h3"><h3 id="1-server-iteration-and-connection">1. Server iteration and connection</h3><a class="sl-anchor-link" href="#1-server-iteration-and-connection"><span aria-hidden="true" class="sl-anchor-icon"><svg width="16" height="16" viewBox="0 0 24 24"><path fill="currentcolor" d="m12.11 15.39-3.88 3.88a2.52 2.52 0 0 1-3.5 0 2.47 2.47 0 0 1 0-3.5l3.88-3.88a1 1 0 0 0-1.42-1.42l-3.88 3.89a4.48 4.48 0 0 0 6.33 6.33l3.89-3.88a1 1 0 1 0-1.42-1.42Zm8.58-12.08a4.49 4.49 0 0 0-6.33 0l-3.89 3.88a1 1 0 0 0 1.42 1.42l3.88-3.88a2.52 2.52 0 0 1 3.5 0 2.47 2.47 0 0 1 0 3.5l-3.88 3.88a1 1 0 1 0 1.42 1.42l3.88-3.89a4.49 4.49 0 0 0 0-6.33ZM8.83 15.17a1 1 0 0 0 1.1.22 1 1 0 0 0 .32-.22l4.92-4.92a1 1 0 0 0-1.42-1.42l-4.92 4.92a1 1 0 0 0 0 1.42Z"></path></svg></span><span class="sr-only">Section titled â€œ1. Server iteration and connectionâ€</span></a></div>
<p>For each configured server in <code dir="auto">mcpServers</code>:</p>
<ol>
<li><strong>Status tracking begins:</strong> Server status is set to <code dir="auto">CONNECTING</code></li>
<li><strong>Transport selection:</strong> Based on configuration properties:
<ul>
<li><code dir="auto">httpUrl</code> â†’ <code dir="auto">StreamableHTTPClientTransport</code></li>
<li><code dir="auto">url</code> â†’ <code dir="auto">SSEClientTransport</code></li>
<li><code dir="auto">command</code> â†’ <code dir="auto">StdioClientTransport</code></li>
</ul>
</li>
<li><strong>Connection establishment:</strong> The MCP client attempts to connect with the
configured timeout</li>
<li><strong>Error handling:</strong> Connection failures are logged and the server status is
set to <code dir="auto">DISCONNECTED</code></li>
</ol>
<div class="sl-heading-wrapper level-h3"><h3 id="2-tool-discovery">2. Tool discovery</h3><a class="sl-anchor-link" href="#2-tool-discovery"><span aria-hidden="true" class="sl-anchor-icon"><svg width="16" height="16" viewBox="0 0 24 24"><path fill="currentcolor" d="m12.11 15.39-3.88 3.88a2.52 2.52 0 0 1-3.5 0 2.47 2.47 0 0 1 0-3.5l3.88-3.88a1 1 0 0 0-1.42-1.42l-3.88 3.89a4.48 4.48 0 0 0 6.33 6.33l3.89-3.88a1 1 0 1 0-1.42-1.42Zm8.58-12.08a4.49 4.49 0 0 0-6.33 0l-3.89 3.88a1 1 0 0 0 1.42 1.42l3.88-3.88a2.52 2.52 0 0 1 3.5 0 2.47 2.47 0 0 1 0 3.5l-3.88 3.88a1 1 0 1 0 1.42 1.42l3.88-3.89a4.49 4.49 0 0 0 0-6.33ZM8.83 15.17a1 1 0 0 0 1.1.22 1 1 0 0 0 .32-.22l4.92-4.92a1 1 0 0 0-1.42-1.42l-4.92 4.92a1 1 0 0 0 0 1.42Z"></path></svg></span><span class="sr-only">Section titled â€œ2. Tool discoveryâ€</span></a></div>
<p>Upon successful connection:</p>
<ol>
<li><strong>Tool listing:</strong> The client calls the MCP serverâ€™s tool listing endpoint</li>
<li><strong>Schema validation:</strong> Each toolâ€™s function declaration is validated</li>
<li><strong>Tool filtering:</strong> Tools are filtered based on <code dir="auto">includeTools</code> and
<code dir="auto">excludeTools</code> configuration</li>
<li><strong>Name sanitization:</strong> Tool names are cleaned to meet Gemini API
requirements:
<ul>
<li>Invalid characters (non-alphanumeric, underscore, dot, hyphen) are replaced
with underscores</li>
<li>Names longer than 63 characters are truncated with middle replacement
(<code dir="auto">___</code>)</li>
</ul>
</li>
</ol>
<div class="sl-heading-wrapper level-h3"><h3 id="3-conflict-resolution">3. Conflict resolution</h3><a class="sl-anchor-link" href="#3-conflict-resolution"><span aria-hidden="true" class="sl-anchor-icon"><svg width="16" height="16" viewBox="0 0 24 24"><path fill="currentcolor" d="m12.11 15.39-3.88 3.88a2.52 2.52 0 0 1-3.5 0 2.47 2.47 0 0 1 0-3.5l3.88-3.88a1 1 0 0 0-1.42-1.42l-3.88 3.89a4.48 4.48 0 0 0 6.33 6.33l3.89-3.88a1 1 0 1 0-1.42-1.42Zm8.58-12.08a4.49 4.49 0 0 0-6.33 0l-3.89 3.88a1 1 0 0 0 1.42 1.42l3.88-3.88a2.52 2.52 0 0 1 3.5 0 2.47 2.47 0 0 1 0 3.5l-3.88 3.88a1 1 0 1 0 1.42 1.42l3.88-3.89a4.49 4.49 0 0 0 0-6.33ZM8.83 15.17a1 1 0 0 0 1.1.22 1 1 0 0 0 .32-.22l4.92-4.92a1 1 0 0 0-1.42-1.42l-4.92 4.92a1 1 0 0 0 0 1.42Z"></path></svg></span><span class="sr-only">Section titled â€œ3. Conflict resolutionâ€</span></a></div>
<p>When multiple servers expose tools with the same name:</p>
<ol>
<li><strong>First registration wins:</strong> The first server to register a tool name gets
the unprefixed name</li>
<li><strong>Automatic prefixing:</strong> Subsequent servers get prefixed names:
<code dir="auto">serverName__toolName</code></li>
<li><strong>Registry tracking:</strong> The tool registry maintains mappings between server
names and their tools</li>
</ol>
<div class="sl-heading-wrapper level-h3"><h3 id="4-schema-processing">4. Schema processing</h3><a class="sl-anchor-link" href="#4-schema-processing"><span aria-hidden="true" class="sl-anchor-icon"><svg width="16" height="16" viewBox="0 0 24 24"><path fill="currentcolor" d="m12.11 15.39-3.88 3.88a2.52 2.52 0 0 1-3.5 0 2.47 2.47 0 0 1 0-3.5l3.88-3.88a1 1 0 0 0-1.42-1.42l-3.88 3.89a4.48 4.48 0 0 0 6.33 6.33l3.89-3.88a1 1 0 1 0-1.42-1.42Zm8.58-12.08a4.49 4.49 0 0 0-6.33 0l-3.89 3.88a1 1 0 0 0 1.42 1.42l3.88-3.88a2.52 2.52 0 0 1 3.5 0 2.47 2.47 0 0 1 0 3.5l-3.88 3.88a1 1 0 1 0 1.42 1.42l3.88-3.89a4.49 4.49 0 0 0 0-6.33ZM8.83 15.17a1 1 0 0 0 1.1.22 1 1 0 0 0 .32-.22l4.92-4.92a1 1 0 0 0-1.42-1.42l-4.92 4.92a1 1 0 0 0 0 1.42Z"></path></svg></span><span class="sr-only">Section titled â€œ4. Schema processingâ€</span></a></div>
<p>Tool parameter schemas undergo sanitization for Gemini API compatibility:</p>
<ul>
<li><strong><code dir="auto">$schema</code> properties</strong> are removed</li>
<li><strong><code dir="auto">additionalProperties</code></strong> are stripped</li>
<li><strong><code dir="auto">anyOf</code> with <code dir="auto">default</code></strong> have their default values removed (Vertex AI
compatibility)</li>
<li><strong>Recursive processing</strong> applies to nested schemas</li>
</ul>
<div class="sl-heading-wrapper level-h3"><h3 id="5-connection-management">5. Connection management</h3><a class="sl-anchor-link" href="#5-connection-management"><span aria-hidden="true" class="sl-anchor-icon"><svg width="16" height="16" viewBox="0 0 24 24"><path fill="currentcolor" d="m12.11 15.39-3.88 3.88a2.52 2.52 0 0 1-3.5 0 2.47 2.47 0 0 1 0-3.5l3.88-3.88a1 1 0 0 0-1.42-1.42l-3.88 3.89a4.48 4.48 0 0 0 6.33 6.33l3.89-3.88a1 1 0 1 0-1.42-1.42Zm8.58-12.08a4.49 4.49 0 0 0-6.33 0l-3.89 3.88a1 1 0 0 0 1.42 1.42l3.88-3.88a2.52 2.52 0 0 1 3.5 0 2.47 2.47 0 0 1 0 3.5l-3.88 3.88a1 1 0 1 0 1.42 1.42l3.88-3.89a4.49 4.49 0 0 0 0-6.33ZM8.83 15.17a1 1 0 0 0 1.1.22 1 1 0 0 0 .32-.22l4.92-4.92a1 1 0 0 0-1.42-1.42l-4.92 4.92a1 1 0 0 0 0 1.42Z"></path></svg></span><span class="sr-only">Section titled â€œ5. Connection managementâ€</span></a></div>
<p>After discovery:</p>
<ul>
<li><strong>Persistent connections:</strong> Servers that successfully register tools maintain
their connections</li>
<li><strong>Cleanup:</strong> Servers that provide no usable tools have their connections
closed</li>
<li><strong>Status updates:</strong> Final server statuses are set to <code dir="auto">CONNECTED</code> or
<code dir="auto">DISCONNECTED</code></li>
</ul>
<div class="sl-heading-wrapper level-h2"><h2 id="tool-execution-flow">Tool execution flow</h2><a class="sl-anchor-link" href="#tool-execution-flow"><span aria-hidden="true" class="sl-anchor-icon"><svg width="16" height="16" viewBox="0 0 24 24"><path fill="currentcolor" d="m12.11 15.39-3.88 3.88a2.52 2.52 0 0 1-3.5 0 2.47 2.47 0 0 1 0-3.5l3.88-3.88a1 1 0 0 0-1.42-1.42l-3.88 3.89a4.48 4.48 0 0 0 6.33 6.33l3.89-3.88a1 1 0 1 0-1.42-1.42Zm8.58-12.08a4.49 4.49 0 0 0-6.33 0l-3.89 3.88a1 1 0 0 0 1.42 1.42l3.88-3.88a2.52 2.52 0 0 1 3.5 0 2.47 2.47 0 0 1 0 3.5l-3.88 3.88a1 1 0 1 0 1.42 1.42l3.88-3.89a4.49 4.49 0 0 0 0-6.33ZM8.83 15.17a1 1 0 0 0 1.1.22 1 1 0 0 0 .32-.22l4.92-4.92a1 1 0 0 0-1.42-1.42l-4.92 4.92a1 1 0 0 0 0 1.42Z"></path></svg></span><span class="sr-only">Section titled â€œTool execution flowâ€</span></a></div>
<p>When the Gemini model decides to use an MCP tool, the following execution flow
occurs:</p>
<div class="sl-heading-wrapper level-h3"><h3 id="1-tool-invocation">1. Tool invocation</h3><a class="sl-anchor-link" href="#1-tool-invocation"><span aria-hidden="true" class="sl-anchor-icon"><svg width="16" height="16" viewBox="0 0 24 24"><path fill="currentcolor" d="m12.11 15.39-3.88 3.88a2.52 2.52 0 0 1-3.5 0 2.47 2.47 0 0 1 0-3.5l3.88-3.88a1 1 0 0 0-1.42-1.42l-3.88 3.89a4.48 4.48 0 0 0 6.33 6.33l3.89-3.88a1 1 0 1 0-1.42-1.42Zm8.58-12.08a4.49 4.49 0 0 0-6.33 0l-3.89 3.88a1 1 0 0 0 1.42 1.42l3.88-3.88a2.52 2.52 0 0 1 3.5 0 2.47 2.47 0 0 1 0 3.5l-3.88 3.88a1 1 0 1 0 1.42 1.42l3.88-3.89a4.49 4.49 0 0 0 0-6.33ZM8.83 15.17a1 1 0 0 0 1.1.22 1 1 0 0 0 .32-.22l4.92-4.92a1 1 0 0 0-1.42-1.42l-4.92 4.92a1 1 0 0 0 0 1.42Z"></path></svg></span><span class="sr-only">Section titled â€œ1. Tool invocationâ€</span></a></div>
<p>The model generates a <code dir="auto">FunctionCall</code> with:</p>
<ul>
<li><strong>Tool name:</strong> The registered name (potentially prefixed)</li>
<li><strong>Arguments:</strong> JSON object matching the toolâ€™s parameter schema</li>
</ul>
<div class="sl-heading-wrapper level-h3"><h3 id="2-confirmation-process">2. Confirmation process</h3><a class="sl-anchor-link" href="#2-confirmation-process"><span aria-hidden="true" class="sl-anchor-icon"><svg width="16" height="16" viewBox="0 0 24 24"><path fill="currentcolor" d="m12.11 15.39-3.88 3.88a2.52 2.52 0 0 1-3.5 0 2.47 2.47 0 0 1 0-3.5l3.88-3.88a1 1 0 0 0-1.42-1.42l-3.88 3.89a4.48 4.48 0 0 0 6.33 6.33l3.89-3.88a1 1 0 1 0-1.42-1.42Zm8.58-12.08a4.49 4.49 0 0 0-6.33 0l-3.89 3.88a1 1 0 0 0 1.42 1.42l3.88-3.88a2.52 2.52 0 0 1 3.5 0 2.47 2.47 0 0 1 0 3.5l-3.88 3.88a1 1 0 1 0 1.42 1.42l3.88-3.89a4.49 4.49 0 0 0 0-6.33ZM8.83 15.17a1 1 0 0 0 1.1.22 1 1 0 0 0 .32-.22l4.92-4.92a1 1 0 0 0-1.42-1.42l-4.92 4.92a1 1 0 0 0 0 1.42Z"></path></svg></span><span class="sr-only">Section titled â€œ2. Confirmation processâ€</span></a></div>
<p>Each <code dir="auto">DiscoveredMCPTool</code> implements sophisticated confirmation logic:</p>
<div class="sl-heading-wrapper level-h4"><h4 id="trust-based-bypass">Trust-based bypass</h4><a class="sl-anchor-link" href="#trust-based-bypass"><span aria-hidden="true" class="sl-anchor-icon"><svg width="16" height="16" viewBox="0 0 24 24"><path fill="currentcolor" d="m12.11 15.39-3.88 3.88a2.52 2.52 0 0 1-3.5 0 2.47 2.47 0 0 1 0-3.5l3.88-3.88a1 1 0 0 0-1.42-1.42l-3.88 3.89a4.48 4.48 0 0 0 6.33 6.33l3.89-3.88a1 1 0 1 0-1.42-1.42Zm8.58-12.08a4.49 4.49 0 0 0-6.33 0l-3.89 3.88a1 1 0 0 0 1.42 1.42l3.88-3.88a2.52 2.52 0 0 1 3.5 0 2.47 2.47 0 0 1 0 3.5l-3.88 3.88a1 1 0 1 0 1.42 1.42l3.88-3.89a4.49 4.49 0 0 0 0-6.33ZM8.83 15.17a1 1 0 0 0 1.1.22 1 1 0 0 0 .32-.22l4.92-4.92a1 1 0 0 0-1.42-1.42l-4.92 4.92a1 1 0 0 0 0 1.42Z"></path></svg></span><span class="sr-only">Section titled â€œTrust-based bypassâ€</span></a></div>
<div class="expressive-code"><figure class="frame not-content"><figcaption class="header"></figcaption><pre data-language="typescript"><code><div class="ec-line"><div class="code"><span style="--0:#FD8DA3;--1:#C12F57">if</span><span style="--0:#E1DFDF;--1:#292929"> (</span><span style="--0:#8DA8FF;--1:#3252B8">this</span><span style="--0:#E1DFDF;--1:#292929">.trust) {</span></div></div><div class="ec-line"><div class="code"><span class="indent">  </span><span style="--0:#FD8DA3;--1:#C12F57">return</span><span style="--0:#E1DFDF;--1:#292929"> </span><span style="--0:#8DA8FF;--1:#3252B8">false</span><span style="--0:#E1DFDF;--1:#292929">; </span><span style="--0:#8E8E8E;--1:#686868">// No confirmation needed</span></div></div><div class="ec-line"><div class="code"><span style="--0:#E1DFDF;--1:#292929">}</span></div></div></code></pre><div class="copy"><button title="Copy to clipboard" data-copied="Copied!" data-code="if (this.trust) {  return false; // No confirmation needed}"><div></div></button></div></figure></div>
<div class="sl-heading-wrapper level-h4"><h4 id="dynamic-allow-listing">Dynamic allow-listing</h4><a class="sl-anchor-link" href="#dynamic-allow-listing"><span aria-hidden="true" class="sl-anchor-icon"><svg width="16" height="16" viewBox="0 0 24 24"><path fill="currentcolor" d="m12.11 15.39-3.88 3.88a2.52 2.52 0 0 1-3.5 0 2.47 2.47 0 0 1 0-3.5l3.88-3.88a1 1 0 0 0-1.42-1.42l-3.88 3.89a4.48 4.48 0 0 0 6.33 6.33l3.89-3.88a1 1 0 1 0-1.42-1.42Zm8.58-12.08a4.49 4.49 0 0 0-6.33 0l-3.89 3.88a1 1 0 0 0 1.42 1.42l3.88-3.88a2.52 2.52 0 0 1 3.5 0 2.47 2.47 0 0 1 0 3.5l-3.88 3.88a1 1 0 1 0 1.42 1.42l3.88-3.89a4.49 4.49 0 0 0 0-6.33ZM8.83 15.17a1 1 0 0 0 1.1.22 1 1 0 0 0 .32-.22l4.92-4.92a1 1 0 0 0-1.42-1.42l-4.92 4.92a1 1 0 0 0 0 1.42Z"></path></svg></span><span class="sr-only">Section titled â€œDynamic allow-listingâ€</span></a></div>
<p>The system maintains internal allow-lists for:</p>
<ul>
<li><strong>Server-level:</strong> <code dir="auto">serverName</code> â†’ All tools from this server are trusted</li>
<li><strong>Tool-level:</strong> <code dir="auto">serverName.toolName</code> â†’ This specific tool is trusted</li>
</ul>
<div class="sl-heading-wrapper level-h4"><h4 id="user-choice-handling">User choice handling</h4><a class="sl-anchor-link" href="#user-choice-handling"><span aria-hidden="true" class="sl-anchor-icon"><svg width="16" height="16" viewBox="0 0 24 24"><path fill="currentcolor" d="m12.11 15.39-3.88 3.88a2.52 2.52 0 0 1-3.5 0 2.47 2.47 0 0 1 0-3.5l3.88-3.88a1 1 0 0 0-1.42-1.42l-3.88 3.89a4.48 4.48 0 0 0 6.33 6.33l3.89-3.88a1 1 0 1 0-1.42-1.42Zm8.58-12.08a4.49 4.49 0 0 0-6.33 0l-3.89 3.88a1 1 0 0 0 1.42 1.42l3.88-3.88a2.52 2.52 0 0 1 3.5 0 2.47 2.47 0 0 1 0 3.5l-3.88 3.88a1 1 0 1 0 1.42 1.42l3.88-3.89a4.49 4.49 0 0 0 0-6.33ZM8.83 15.17a1 1 0 0 0 1.1.22 1 1 0 0 0 .32-.22l4.92-4.92a1 1 0 0 0-1.42-1.42l-4.92 4.92a1 1 0 0 0 0 1.42Z"></path></svg></span><span class="sr-only">Section titled â€œUser choice handlingâ€</span></a></div>
<p>When confirmation is required, users can choose:</p>
<ul>
<li><strong>Proceed once:</strong> Execute this time only</li>
<li><strong>Always allow this tool:</strong> Add to tool-level allow-list</li>
<li><strong>Always allow this server:</strong> Add to server-level allow-list</li>
<li><strong>Cancel:</strong> Abort execution</li>
</ul>
<div class="sl-heading-wrapper level-h3"><h3 id="3-execution">3. Execution</h3><a class="sl-anchor-link" href="#3-execution"><span aria-hidden="true" class="sl-anchor-icon"><svg width="16" height="16" viewBox="0 0 24 24"><path fill="currentcolor" d="m12.11 15.39-3.88 3.88a2.52 2.52 0 0 1-3.5 0 2.47 2.47 0 0 1 0-3.5l3.88-3.88a1 1 0 0 0-1.42-1.42l-3.88 3.89a4.48 4.48 0 0 0 6.33 6.33l3.89-3.88a1 1 0 1 0-1.42-1.42Zm8.58-12.08a4.49 4.49 0 0 0-6.33 0l-3.89 3.88a1 1 0 0 0 1.42 1.42l3.88-3.88a2.52 2.52 0 0 1 3.5 0 2.47 2.47 0 0 1 0 3.5l-3.88 3.88a1 1 0 1 0 1.42 1.42l3.88-3.89a4.49 4.49 0 0 0 0-6.33ZM8.83 15.17a1 1 0 0 0 1.1.22 1 1 0 0 0 .32-.22l4.92-4.92a1 1 0 0 0-1.42-1.42l-4.92 4.92a1 1 0 0 0 0 1.42Z"></path></svg></span><span class="sr-only">Section titled â€œ3. Executionâ€</span></a></div>
<p>Upon confirmation (or trust bypass):</p>
<ol>
<li>
<p><strong>Parameter preparation:</strong> Arguments are validated against the toolâ€™s schema</p>
</li>
<li>
<p><strong>MCP call:</strong> The underlying <code dir="auto">CallableTool</code> invokes the server with:</p>
<div class="expressive-code"><figure class="frame not-content"><figcaption class="header"></figcaption><pre data-language="typescript"><code><div class="ec-line"><div class="code"><span style="--0:#FD8DA3;--1:#C12F57">const</span><span style="--0:#E1DFDF;--1:#292929"> </span><span style="--0:#8DA8FF;--1:#3252B8">functionCalls</span><span style="--0:#E1DFDF;--1:#292929"> </span><span style="--0:#FD8DA3;--1:#C12F57">=</span><span style="--0:#E1DFDF;--1:#292929"> [</span></div></div><div class="ec-line"><div class="code"><span class="indent"><span style="--0:#E1DFDF;--1:#292929">  </span></span><span style="--0:#E1DFDF;--1:#292929">{</span></div></div><div class="ec-line"><div class="code"><span class="indent"><span style="--0:#E1DFDF;--1:#292929">    </span></span><span style="--0:#E1DFDF;--1:#292929">name: </span><span style="--0:#8DA8FF;--1:#3252B8">this</span><span style="--0:#E1DFDF;--1:#292929">.serverToolName, </span><span style="--0:#8E8E8E;--1:#686868">// Original server tool name</span></div></div><div class="ec-line"><div class="code"><span class="indent"><span style="--0:#E1DFDF;--1:#292929">    </span></span><span style="--0:#E1DFDF;--1:#292929">args: params,</span></div></div><div class="ec-line"><div class="code"><span class="indent"><span style="--0:#E1DFDF;--1:#292929">  </span></span><span style="--0:#E1DFDF;--1:#292929">},</span></div></div><div class="ec-line"><div class="code"><span style="--0:#E1DFDF;--1:#292929">];</span></div></div></code></pre><div class="copy"><button title="Copy to clipboard" data-copied="Copied!" data-code="const functionCalls = [  {    name: this.serverToolName, // Original server tool name    args: params,  },];"><div></div></button></div></figure></div>
</li>
<li>
<p><strong>Response processing:</strong> Results are formatted for both LLM context and user
display</p>
</li>
</ol>
<div class="sl-heading-wrapper level-h3"><h3 id="4-response-handling">4. Response handling</h3><a class="sl-anchor-link" href="#4-response-handling"><span aria-hidden="true" class="sl-anchor-icon"><svg width="16" height="16" viewBox="0 0 24 24"><path fill="currentcolor" d="m12.11 15.39-3.88 3.88a2.52 2.52 0 0 1-3.5 0 2.47 2.47 0 0 1 0-3.5l3.88-3.88a1 1 0 0 0-1.42-1.42l-3.88 3.89a4.48 4.48 0 0 0 6.33 6.33l3.89-3.88a1 1 0 1 0-1.42-1.42Zm8.58-12.08a4.49 4.49 0 0 0-6.33 0l-3.89 3.88a1 1 0 0 0 1.42 1.42l3.88-3.88a2.52 2.52 0 0 1 3.5 0 2.47 2.47 0 0 1 0 3.5l-3.88 3.88a1 1 0 1 0 1.42 1.42l3.88-3.89a4.49 4.49 0 0 0 0-6.33ZM8.83 15.17a1 1 0 0 0 1.1.22 1 1 0 0 0 .32-.22l4.92-4.92a1 1 0 0 0-1.42-1.42l-4.92 4.92a1 1 0 0 0 0 1.42Z"></path></svg></span><span class="sr-only">Section titled â€œ4. Response handlingâ€</span></a></div>
<p>The execution result contains:</p>
<ul>
<li><strong><code dir="auto">llmContent</code>:</strong> Raw response parts for the language modelâ€™s context</li>
<li><strong><code dir="auto">returnDisplay</code>:</strong> Formatted output for user display (often JSON in markdown
code blocks)</li>
</ul>
<div class="sl-heading-wrapper level-h2"><h2 id="how-to-interact-with-your-mcp-server">How to interact with your MCP server</h2><a class="sl-anchor-link" href="#how-to-interact-with-your-mcp-server"><span aria-hidden="true" class="sl-anchor-icon"><svg width="16" height="16" viewBox="0 0 24 24"><path fill="currentcolor" d="m12.11 15.39-3.88 3.88a2.52 2.52 0 0 1-3.5 0 2.47 2.47 0 0 1 0-3.5l3.88-3.88a1 1 0 0 0-1.42-1.42l-3.88 3.89a4.48 4.48 0 0 0 6.33 6.33l3.89-3.88a1 1 0 1 0-1.42-1.42Zm8.58-12.08a4.49 4.49 0 0 0-6.33 0l-3.89 3.88a1 1 0 0 0 1.42 1.42l3.88-3.88a2.52 2.52 0 0 1 3.5 0 2.47 2.47 0 0 1 0 3.5l-3.88 3.88a1 1 0 1 0 1.42 1.42l3.88-3.89a4.49 4.49 0 0 0 0-6.33ZM8.83 15.17a1 1 0 0 0 1.1.22 1 1 0 0 0 .32-.22l4.92-4.92a1 1 0 0 0-1.42-1.42l-4.92 4.92a1 1 0 0 0 0 1.42Z"></path></svg></span><span class="sr-only">Section titled â€œHow to interact with your MCP serverâ€</span></a></div>
<div class="sl-heading-wrapper level-h3"><h3 id="using-the-mcp-command">Using the <code dir="auto">/mcp</code> command</h3><a class="sl-anchor-link" href="#using-the-mcp-command"><span aria-hidden="true" class="sl-anchor-icon"><svg width="16" height="16" viewBox="0 0 24 24"><path fill="currentcolor" d="m12.11 15.39-3.88 3.88a2.52 2.52 0 0 1-3.5 0 2.47 2.47 0 0 1 0-3.5l3.88-3.88a1 1 0 0 0-1.42-1.42l-3.88 3.89a4.48 4.48 0 0 0 6.33 6.33l3.89-3.88a1 1 0 1 0-1.42-1.42Zm8.58-12.08a4.49 4.49 0 0 0-6.33 0l-3.89 3.88a1 1 0 0 0 1.42 1.42l3.88-3.88a2.52 2.52 0 0 1 3.5 0 2.47 2.47 0 0 1 0 3.5l-3.88 3.88a1 1 0 1 0 1.42 1.42l3.88-3.89a4.49 4.49 0 0 0 0-6.33ZM8.83 15.17a1 1 0 0 0 1.1.22 1 1 0 0 0 .32-.22l4.92-4.92a1 1 0 0 0-1.42-1.42l-4.92 4.92a1 1 0 0 0 0 1.42Z"></path></svg></span><span class="sr-only">Section titled â€œUsing the /mcp commandâ€</span></a></div>
<p>The <code dir="auto">/mcp</code> command provides comprehensive information about your MCP server
setup:</p>
<div class="expressive-code"><figure class="frame is-terminal not-content"><figcaption class="header"><span class="title"></span><span class="sr-only">Terminal window</span></figcaption><pre data-language="bash"><code><div class="ec-line"><div class="code"><span style="--0:#BD9CFE;--1:#6F4CDE">/mcp</span></div></div></code></pre><div class="copy"><button title="Copy to clipboard" data-copied="Copied!" data-code="/mcp"><div></div></button></div></figure></div>
<p>This displays:</p>
<ul>
<li><strong>Server list:</strong> All configured MCP servers</li>
<li><strong>Connection status:</strong> <code dir="auto">CONNECTED</code>, <code dir="auto">CONNECTING</code>, or <code dir="auto">DISCONNECTED</code></li>
<li><strong>Server details:</strong> Configuration summary (excluding sensitive data)</li>
<li><strong>Available tools:</strong> List of tools from each server with descriptions</li>
<li><strong>Discovery state:</strong> Overall discovery process status</li>
</ul>
<div class="sl-heading-wrapper level-h3"><h3 id="example-mcp-output">Example <code dir="auto">/mcp</code> output</h3><a class="sl-anchor-link" href="#example-mcp-output"><span aria-hidden="true" class="sl-anchor-icon"><svg width="16" height="16" viewBox="0 0 24 24"><path fill="currentcolor" d="m12.11 15.39-3.88 3.88a2.52 2.52 0 0 1-3.5 0 2.47 2.47 0 0 1 0-3.5l3.88-3.88a1 1 0 0 0-1.42-1.42l-3.88 3.89a4.48 4.48 0 0 0 6.33 6.33l3.89-3.88a1 1 0 1 0-1.42-1.42Zm8.58-12.08a4.49 4.49 0 0 0-6.33 0l-3.89 3.88a1 1 0 0 0 1.42 1.42l3.88-3.88a2.52 2.52 0 0 1 3.5 0 2.47 2.47 0 0 1 0 3.5l-3.88 3.88a1 1 0 1 0 1.42 1.42l3.88-3.89a4.49 4.49 0 0 0 0-6.33ZM8.83 15.17a1 1 0 0 0 1.1.22 1 1 0 0 0 .32-.22l4.92-4.92a1 1 0 0 0-1.42-1.42l-4.92 4.92a1 1 0 0 0 0 1.42Z"></path></svg></span><span class="sr-only">Section titled â€œExample /mcp outputâ€</span></a></div>
<div class="expressive-code"><figure class="frame not-content"><figcaption class="header"></figcaption><pre data-language="plaintext"><code><div class="ec-line"><div class="code"><span style="--0:#e1dfdf;--1:#292929">MCP Servers Status:</span></div></div><div class="ec-line"><div class="code">
</div></div><div class="ec-line"><div class="code"><span style="--0:#e1dfdf;--1:#292929">ðŸ“¡ pythonTools (CONNECTED)</span></div></div><div class="ec-line"><div class="code"><span class="indent"><span style="--0:#e1dfdf;--1:#292929">  </span></span><span style="--0:#e1dfdf;--1:#292929">Command: python -m my_mcp_server --port 8080</span></div></div><div class="ec-line"><div class="code"><span class="indent"><span style="--0:#e1dfdf;--1:#292929">  </span></span><span style="--0:#e1dfdf;--1:#292929">Working Directory: ./mcp-servers/python</span></div></div><div class="ec-line"><div class="code"><span class="indent"><span style="--0:#e1dfdf;--1:#292929">  </span></span><span style="--0:#e1dfdf;--1:#292929">Timeout: 15000ms</span></div></div><div class="ec-line"><div class="code"><span class="indent"><span style="--0:#e1dfdf;--1:#292929">  </span></span><span style="--0:#e1dfdf;--1:#292929">Tools: calculate_sum, file_analyzer, data_processor</span></div></div><div class="ec-line"><div class="code">
</div></div><div class="ec-line"><div class="code"><span style="--0:#e1dfdf;--1:#292929">ðŸ”Œ nodeServer (DISCONNECTED)</span></div></div><div class="ec-line"><div class="code"><span class="indent"><span style="--0:#e1dfdf;--1:#292929">  </span></span><span style="--0:#e1dfdf;--1:#292929">Command: node dist/server.js --verbose</span></div></div><div class="ec-line"><div class="code"><span class="indent"><span style="--0:#e1dfdf;--1:#292929">  </span></span><span style="--0:#e1dfdf;--1:#292929">Error: Connection refused</span></div></div><div class="ec-line"><div class="code">
</div></div><div class="ec-line"><div class="code"><span style="--0:#e1dfdf;--1:#292929">ðŸ³ dockerizedServer (CONNECTED)</span></div></div><div class="ec-line"><div class="code"><span class="indent"><span style="--0:#e1dfdf;--1:#292929">  </span></span><span style="--0:#e1dfdf;--1:#292929">Command: docker run -i --rm -e API_KEY my-mcp-server:latest</span></div></div><div class="ec-line"><div class="code"><span class="indent"><span style="--0:#e1dfdf;--1:#292929">  </span></span><span style="--0:#e1dfdf;--1:#292929">Tools: docker__deploy, docker__status</span></div></div><div class="ec-line"><div class="code">
</div></div><div class="ec-line"><div class="code"><span style="--0:#e1dfdf;--1:#292929">Discovery State: COMPLETED</span></div></div></code></pre><div class="copy"><button title="Copy to clipboard" data-copied="Copied!" data-code="MCP Servers Status:ðŸ“¡ pythonTools (CONNECTED)  Command: python -m my_mcp_server --port 8080  Working Directory: ./mcp-servers/python  Timeout: 15000ms  Tools: calculate_sum, file_analyzer, data_processorðŸ”Œ nodeServer (DISCONNECTED)  Command: node dist/server.js --verbose  Error: Connection refusedðŸ³ dockerizedServer (CONNECTED)  Command: docker run -i --rm -e API_KEY my-mcp-server:latest  Tools: docker__deploy, docker__statusDiscovery State: COMPLETED"><div></div></button></div></figure></div>
<div class="sl-heading-wrapper level-h3"><h3 id="tool-usage">Tool usage</h3><a class="sl-anchor-link" href="#tool-usage"><span aria-hidden="true" class="sl-anchor-icon"><svg width="16" height="16" viewBox="0 0 24 24"><path fill="currentcolor" d="m12.11 15.39-3.88 3.88a2.52 2.52 0 0 1-3.5 0 2.47 2.47 0 0 1 0-3.5l3.88-3.88a1 1 0 0 0-1.42-1.42l-3.88 3.89a4.48 4.48 0 0 0 6.33 6.33l3.89-3.88a1 1 0 1 0-1.42-1.42Zm8.58-12.08a4.49 4.49 0 0 0-6.33 0l-3.89 3.88a1 1 0 0 0 1.42 1.42l3.88-3.88a2.52 2.52 0 0 1 3.5 0 2.47 2.47 0 0 1 0 3.5l-3.88 3.88a1 1 0 1 0 1.42 1.42l3.88-3.89a4.49 4.49 0 0 0 0-6.33ZM8.83 15.17a1 1 0 0 0 1.1.22 1 1 0 0 0 .32-.22l4.92-4.92a1 1 0 0 0-1.42-1.42l-4.92 4.92a1 1 0 0 0 0 1.42Z"></path></svg></span><span class="sr-only">Section titled â€œTool usageâ€</span></a></div>
<p>Once discovered, MCP tools are available to the Gemini model like built-in
tools. The model will automatically:</p>
<ol>
<li><strong>Select appropriate tools</strong> based on your requests</li>
<li><strong>Present confirmation dialogs</strong> (unless the server is trusted)</li>
<li><strong>Execute tools</strong> with proper parameters</li>
<li><strong>Display results</strong> in a user-friendly format</li>
</ol>
<div class="sl-heading-wrapper level-h2"><h2 id="status-monitoring-and-troubleshooting">Status monitoring and troubleshooting</h2><a class="sl-anchor-link" href="#status-monitoring-and-troubleshooting"><span aria-hidden="true" class="sl-anchor-icon"><svg width="16" height="16" viewBox="0 0 24 24"><path fill="currentcolor" d="m12.11 15.39-3.88 3.88a2.52 2.52 0 0 1-3.5 0 2.47 2.47 0 0 1 0-3.5l3.88-3.88a1 1 0 0 0-1.42-1.42l-3.88 3.89a4.48 4.48 0 0 0 6.33 6.33l3.89-3.88a1 1 0 1 0-1.42-1.42Zm8.58-12.08a4.49 4.49 0 0 0-6.33 0l-3.89 3.88a1 1 0 0 0 1.42 1.42l3.88-3.88a2.52 2.52 0 0 1 3.5 0 2.47 2.47 0 0 1 0 3.5l-3.88 3.88a1 1 0 1 0 1.42 1.42l3.88-3.89a4.49 4.49 0 0 0 0-6.33ZM8.83 15.17a1 1 0 0 0 1.1.22 1 1 0 0 0 .32-.22l4.92-4.92a1 1 0 0 0-1.42-1.42l-4.92 4.92a1 1 0 0 0 0 1.42Z"></path></svg></span><span class="sr-only">Section titled â€œStatus monitoring and troubleshootingâ€</span></a></div>
<div class="sl-heading-wrapper level-h3"><h3 id="connection-states">Connection states</h3><a class="sl-anchor-link" href="#connection-states"><span aria-hidden="true" class="sl-anchor-icon"><svg width="16" height="16" viewBox="0 0 24 24"><path fill="currentcolor" d="m12.11 15.39-3.88 3.88a2.52 2.52 0 0 1-3.5 0 2.47 2.47 0 0 1 0-3.5l3.88-3.88a1 1 0 0 0-1.42-1.42l-3.88 3.89a4.48 4.48 0 0 0 6.33 6.33l3.89-3.88a1 1 0 1 0-1.42-1.42Zm8.58-12.08a4.49 4.49 0 0 0-6.33 0l-3.89 3.88a1 1 0 0 0 1.42 1.42l3.88-3.88a2.52 2.52 0 0 1 3.5 0 2.47 2.47 0 0 1 0 3.5l-3.88 3.88a1 1 0 1 0 1.42 1.42l3.88-3.89a4.49 4.49 0 0 0 0-6.33ZM8.83 15.17a1 1 0 0 0 1.1.22 1 1 0 0 0 .32-.22l4.92-4.92a1 1 0 0 0-1.42-1.42l-4.92 4.92a1 1 0 0 0 0 1.42Z"></path></svg></span><span class="sr-only">Section titled â€œConnection statesâ€</span></a></div>
<p>The MCP integration tracks several states:</p>
<div class="sl-heading-wrapper level-h4"><h4 id="server-status-mcpserverstatus">Server status (<code dir="auto">MCPServerStatus</code>)</h4><a class="sl-anchor-link" href="#server-status-mcpserverstatus"><span aria-hidden="true" class="sl-anchor-icon"><svg width="16" height="16" viewBox="0 0 24 24"><path fill="currentcolor" d="m12.11 15.39-3.88 3.88a2.52 2.52 0 0 1-3.5 0 2.47 2.47 0 0 1 0-3.5l3.88-3.88a1 1 0 0 0-1.42-1.42l-3.88 3.89a4.48 4.48 0 0 0 6.33 6.33l3.89-3.88a1 1 0 1 0-1.42-1.42Zm8.58-12.08a4.49 4.49 0 0 0-6.33 0l-3.89 3.88a1 1 0 0 0 1.42 1.42l3.88-3.88a2.52 2.52 0 0 1 3.5 0 2.47 2.47 0 0 1 0 3.5l-3.88 3.88a1 1 0 1 0 1.42 1.42l3.88-3.89a4.49 4.49 0 0 0 0-6.33ZM8.83 15.17a1 1 0 0 0 1.1.22 1 1 0 0 0 .32-.22l4.92-4.92a1 1 0 0 0-1.42-1.42l-4.92 4.92a1 1 0 0 0 0 1.42Z"></path></svg></span><span class="sr-only">Section titled â€œServer status (MCPServerStatus)â€</span></a></div>
<ul>
<li><strong><code dir="auto">DISCONNECTED</code>:</strong> Server is not connected or has errors</li>
<li><strong><code dir="auto">CONNECTING</code>:</strong> Connection attempt in progress</li>
<li><strong><code dir="auto">CONNECTED</code>:</strong> Server is connected and ready</li>
</ul>
<div class="sl-heading-wrapper level-h4"><h4 id="discovery-state-mcpdiscoverystate">Discovery state (<code dir="auto">MCPDiscoveryState</code>)</h4><a class="sl-anchor-link" href="#discovery-state-mcpdiscoverystate"><span aria-hidden="true" class="sl-anchor-icon"><svg width="16" height="16" viewBox="0 0 24 24"><path fill="currentcolor" d="m12.11 15.39-3.88 3.88a2.52 2.52 0 0 1-3.5 0 2.47 2.47 0 0 1 0-3.5l3.88-3.88a1 1 0 0 0-1.42-1.42l-3.88 3.89a4.48 4.48 0 0 0 6.33 6.33l3.89-3.88a1 1 0 1 0-1.42-1.42Zm8.58-12.08a4.49 4.49 0 0 0-6.33 0l-3.89 3.88a1 1 0 0 0 1.42 1.42l3.88-3.88a2.52 2.52 0 0 1 3.5 0 2.47 2.47 0 0 1 0 3.5l-3.88 3.88a1 1 0 1 0 1.42 1.42l3.88-3.89a4.49 4.49 0 0 0 0-6.33ZM8.83 15.17a1 1 0 0 0 1.1.22 1 1 0 0 0 .32-.22l4.92-4.92a1 1 0 0 0-1.42-1.42l-4.92 4.92a1 1 0 0 0 0 1.42Z"></path></svg></span><span class="sr-only">Section titled â€œDiscovery state (MCPDiscoveryState)â€</span></a></div>
<ul>
<li><strong><code dir="auto">NOT_STARTED</code>:</strong> Discovery hasnâ€™t begun</li>
<li><strong><code dir="auto">IN_PROGRESS</code>:</strong> Currently discovering servers</li>
<li><strong><code dir="auto">COMPLETED</code>:</strong> Discovery finished (with or without errors)</li>
</ul>
<div class="sl-heading-wrapper level-h3"><h3 id="common-issues-and-solutions">Common issues and solutions</h3><a class="sl-anchor-link" href="#common-issues-and-solutions"><span aria-hidden="true" class="sl-anchor-icon"><svg width="16" height="16" viewBox="0 0 24 24"><path fill="currentcolor" d="m12.11 15.39-3.88 3.88a2.52 2.52 0 0 1-3.5 0 2.47 2.47 0 0 1 0-3.5l3.88-3.88a1 1 0 0 0-1.42-1.42l-3.88 3.89a4.48 4.48 0 0 0 6.33 6.33l3.89-3.88a1 1 0 1 0-1.42-1.42Zm8.58-12.08a4.49 4.49 0 0 0-6.33 0l-3.89 3.88a1 1 0 0 0 1.42 1.42l3.88-3.88a2.52 2.52 0 0 1 3.5 0 2.47 2.47 0 0 1 0 3.5l-3.88 3.88a1 1 0 1 0 1.42 1.42l3.88-3.89a4.49 4.49 0 0 0 0-6.33ZM8.83 15.17a1 1 0 0 0 1.1.22 1 1 0 0 0 .32-.22l4.92-4.92a1 1 0 0 0-1.42-1.42l-4.92 4.92a1 1 0 0 0 0 1.42Z"></path></svg></span><span class="sr-only">Section titled â€œCommon issues and solutionsâ€</span></a></div>
<div class="sl-heading-wrapper level-h4"><h4 id="server-wont-connect">Server wonâ€™t connect</h4><a class="sl-anchor-link" href="#server-wont-connect"><span aria-hidden="true" class="sl-anchor-icon"><svg width="16" height="16" viewBox="0 0 24 24"><path fill="currentcolor" d="m12.11 15.39-3.88 3.88a2.52 2.52 0 0 1-3.5 0 2.47 2.47 0 0 1 0-3.5l3.88-3.88a1 1 0 0 0-1.42-1.42l-3.88 3.89a4.48 4.48 0 0 0 6.33 6.33l3.89-3.88a1 1 0 1 0-1.42-1.42Zm8.58-12.08a4.49 4.49 0 0 0-6.33 0l-3.89 3.88a1 1 0 0 0 1.42 1.42l3.88-3.88a2.52 2.52 0 0 1 3.5 0 2.47 2.47 0 0 1 0 3.5l-3.88 3.88a1 1 0 1 0 1.42 1.42l3.88-3.89a4.49 4.49 0 0 0 0-6.33ZM8.83 15.17a1 1 0 0 0 1.1.22 1 1 0 0 0 .32-.22l4.92-4.92a1 1 0 0 0-1.42-1.42l-4.92 4.92a1 1 0 0 0 0 1.42Z"></path></svg></span><span class="sr-only">Section titled â€œServer wonâ€™t connectâ€</span></a></div>
<p><strong>Symptoms:</strong> Server shows <code dir="auto">DISCONNECTED</code> status</p>
<p><strong>Troubleshooting:</strong></p>
<ol>
<li><strong>Check configuration:</strong> Verify <code dir="auto">command</code>, <code dir="auto">args</code>, and <code dir="auto">cwd</code> are correct</li>
<li><strong>Test manually:</strong> Run the server command directly to ensure it works</li>
<li><strong>Check dependencies:</strong> Ensure all required packages are installed</li>
<li><strong>Review logs:</strong> Look for error messages in the CLI output</li>
<li><strong>Verify permissions:</strong> Ensure the CLI can execute the server command</li>
</ol>
<div class="sl-heading-wrapper level-h4"><h4 id="no-tools-discovered">No tools discovered</h4><a class="sl-anchor-link" href="#no-tools-discovered"><span aria-hidden="true" class="sl-anchor-icon"><svg width="16" height="16" viewBox="0 0 24 24"><path fill="currentcolor" d="m12.11 15.39-3.88 3.88a2.52 2.52 0 0 1-3.5 0 2.47 2.47 0 0 1 0-3.5l3.88-3.88a1 1 0 0 0-1.42-1.42l-3.88 3.89a4.48 4.48 0 0 0 6.33 6.33l3.89-3.88a1 1 0 1 0-1.42-1.42Zm8.58-12.08a4.49 4.49 0 0 0-6.33 0l-3.89 3.88a1 1 0 0 0 1.42 1.42l3.88-3.88a2.52 2.52 0 0 1 3.5 0 2.47 2.47 0 0 1 0 3.5l-3.88 3.88a1 1 0 1 0 1.42 1.42l3.88-3.89a4.49 4.49 0 0 0 0-6.33ZM8.83 15.17a1 1 0 0 0 1.1.22 1 1 0 0 0 .32-.22l4.92-4.92a1 1 0 0 0-1.42-1.42l-4.92 4.92a1 1 0 0 0 0 1.42Z"></path></svg></span><span class="sr-only">Section titled â€œNo tools discoveredâ€</span></a></div>
<p><strong>Symptoms:</strong> Server connects but no tools are available</p>
<p><strong>Troubleshooting:</strong></p>
<ol>
<li><strong>Verify tool registration:</strong> Ensure your server actually registers tools</li>
<li><strong>Check MCP protocol:</strong> Confirm your server implements the MCP tool listing
correctly</li>
<li><strong>Review server logs:</strong> Check stderr output for server-side errors</li>
<li><strong>Test tool listing:</strong> Manually test your serverâ€™s tool discovery endpoint</li>
</ol>
<div class="sl-heading-wrapper level-h4"><h4 id="tools-not-executing">Tools not executing</h4><a class="sl-anchor-link" href="#tools-not-executing"><span aria-hidden="true" class="sl-anchor-icon"><svg width="16" height="16" viewBox="0 0 24 24"><path fill="currentcolor" d="m12.11 15.39-3.88 3.88a2.52 2.52 0 0 1-3.5 0 2.47 2.47 0 0 1 0-3.5l3.88-3.88a1 1 0 0 0-1.42-1.42l-3.88 3.89a4.48 4.48 0 0 0 6.33 6.33l3.89-3.88a1 1 0 1 0-1.42-1.42Zm8.58-12.08a4.49 4.49 0 0 0-6.33 0l-3.89 3.88a1 1 0 0 0 1.42 1.42l3.88-3.88a2.52 2.52 0 0 1 3.5 0 2.47 2.47 0 0 1 0 3.5l-3.88 3.88a1 1 0 1 0 1.42 1.42l3.88-3.89a4.49 4.49 0 0 0 0-6.33ZM8.83 15.17a1 1 0 0 0 1.1.22 1 1 0 0 0 .32-.22l4.92-4.92a1 1 0 0 0-1.42-1.42l-4.92 4.92a1 1 0 0 0 0 1.42Z"></path></svg></span><span class="sr-only">Section titled â€œTools not executingâ€</span></a></div>
<p><strong>Symptoms:</strong> Tools are discovered but fail during execution</p>
<p><strong>Troubleshooting:</strong></p>
<ol>
<li><strong>Parameter validation:</strong> Ensure your tool accepts the expected parameters</li>
<li><strong>Schema compatibility:</strong> Verify your input schemas are valid JSON Schema</li>
<li><strong>Error handling:</strong> Check if your tool is throwing unhandled exceptions</li>
<li><strong>Timeout issues:</strong> Consider increasing the <code dir="auto">timeout</code> setting</li>
</ol>
<div class="sl-heading-wrapper level-h4"><h4 id="sandbox-compatibility">Sandbox compatibility</h4><a class="sl-anchor-link" href="#sandbox-compatibility"><span aria-hidden="true" class="sl-anchor-icon"><svg width="16" height="16" viewBox="0 0 24 24"><path fill="currentcolor" d="m12.11 15.39-3.88 3.88a2.52 2.52 0 0 1-3.5 0 2.47 2.47 0 0 1 0-3.5l3.88-3.88a1 1 0 0 0-1.42-1.42l-3.88 3.89a4.48 4.48 0 0 0 6.33 6.33l3.89-3.88a1 1 0 1 0-1.42-1.42Zm8.58-12.08a4.49 4.49 0 0 0-6.33 0l-3.89 3.88a1 1 0 0 0 1.42 1.42l3.88-3.88a2.52 2.52 0 0 1 3.5 0 2.47 2.47 0 0 1 0 3.5l-3.88 3.88a1 1 0 1 0 1.42 1.42l3.88-3.89a4.49 4.49 0 0 0 0-6.33ZM8.83 15.17a1 1 0 0 0 1.1.22 1 1 0 0 0 .32-.22l4.92-4.92a1 1 0 0 0-1.42-1.42l-4.92 4.92a1 1 0 0 0 0 1.42Z"></path></svg></span><span class="sr-only">Section titled â€œSandbox compatibilityâ€</span></a></div>
<p><strong>Symptoms:</strong> MCP servers fail when sandboxing is enabled</p>
<p><strong>Solutions:</strong></p>
<ol>
<li><strong>Docker-based servers:</strong> Use Docker containers that include all dependencies</li>
<li><strong>Path accessibility:</strong> Ensure server executables are available in the
sandbox</li>
<li><strong>Network access:</strong> Configure sandbox to allow necessary network connections</li>
<li><strong>Environment variables:</strong> Verify required environment variables are passed
through</li>
</ol>
<div class="sl-heading-wrapper level-h3"><h3 id="debugging-tips">Debugging tips</h3><a class="sl-anchor-link" href="#debugging-tips"><span aria-hidden="true" class="sl-anchor-icon"><svg width="16" height="16" viewBox="0 0 24 24"><path fill="currentcolor" d="m12.11 15.39-3.88 3.88a2.52 2.52 0 0 1-3.5 0 2.47 2.47 0 0 1 0-3.5l3.88-3.88a1 1 0 0 0-1.42-1.42l-3.88 3.89a4.48 4.48 0 0 0 6.33 6.33l3.89-3.88a1 1 0 1 0-1.42-1.42Zm8.58-12.08a4.49 4.49 0 0 0-6.33 0l-3.89 3.88a1 1 0 0 0 1.42 1.42l3.88-3.88a2.52 2.52 0 0 1 3.5 0 2.47 2.47 0 0 1 0 3.5l-3.88 3.88a1 1 0 1 0 1.42 1.42l3.88-3.89a4.49 4.49 0 0 0 0-6.33ZM8.83 15.17a1 1 0 0 0 1.1.22 1 1 0 0 0 .32-.22l4.92-4.92a1 1 0 0 0-1.42-1.42l-4.92 4.92a1 1 0 0 0 0 1.42Z"></path></svg></span><span class="sr-only">Section titled â€œDebugging tipsâ€</span></a></div>
<ol>
<li><strong>Enable debug mode:</strong> Run the CLI with <code dir="auto">--debug</code> for verbose output</li>
<li><strong>Check stderr:</strong> MCP server stderr is captured and logged (INFO messages
filtered)</li>
<li><strong>Test isolation:</strong> Test your MCP server independently before integrating</li>
<li><strong>Incremental setup:</strong> Start with simple tools before adding complex
functionality</li>
<li><strong>Use <code dir="auto">/mcp</code> frequently:</strong> Monitor server status during development</li>
</ol>
<div class="sl-heading-wrapper level-h2"><h2 id="important-notes">Important notes</h2><a class="sl-anchor-link" href="#important-notes"><span aria-hidden="true" class="sl-anchor-icon"><svg width="16" height="16" viewBox="0 0 24 24"><path fill="currentcolor" d="m12.11 15.39-3.88 3.88a2.52 2.52 0 0 1-3.5 0 2.47 2.47 0 0 1 0-3.5l3.88-3.88a1 1 0 0 0-1.42-1.42l-3.88 3.89a4.48 4.48 0 0 0 6.33 6.33l3.89-3.88a1 1 0 1 0-1.42-1.42Zm8.58-12.08a4.49 4.49 0 0 0-6.33 0l-3.89 3.88a1 1 0 0 0 1.42 1.42l3.88-3.88a2.52 2.52 0 0 1 3.5 0 2.47 2.47 0 0 1 0 3.5l-3.88 3.88a1 1 0 1 0 1.42 1.42l3.88-3.89a4.49 4.49 0 0 0 0-6.33ZM8.83 15.17a1 1 0 0 0 1.1.22 1 1 0 0 0 .32-.22l4.92-4.92a1 1 0 0 0-1.42-1.42l-4.92 4.92a1 1 0 0 0 0 1.42Z"></path></svg></span><span class="sr-only">Section titled â€œImportant notesâ€</span></a></div>
<div class="sl-heading-wrapper level-h3"><h3 id="security-sonsiderations">Security sonsiderations</h3><a class="sl-anchor-link" href="#security-sonsiderations"><span aria-hidden="true" class="sl-anchor-icon"><svg width="16" height="16" viewBox="0 0 24 24"><path fill="currentcolor" d="m12.11 15.39-3.88 3.88a2.52 2.52 0 0 1-3.5 0 2.47 2.47 0 0 1 0-3.5l3.88-3.88a1 1 0 0 0-1.42-1.42l-3.88 3.89a4.48 4.48 0 0 0 6.33 6.33l3.89-3.88a1 1 0 1 0-1.42-1.42Zm8.58-12.08a4.49 4.49 0 0 0-6.33 0l-3.89 3.88a1 1 0 0 0 1.42 1.42l3.88-3.88a2.52 2.52 0 0 1 3.5 0 2.47 2.47 0 0 1 0 3.5l-3.88 3.88a1 1 0 1 0 1.42 1.42l3.88-3.89a4.49 4.49 0 0 0 0-6.33ZM8.83 15.17a1 1 0 0 0 1.1.22 1 1 0 0 0 .32-.22l4.92-4.92a1 1 0 0 0-1.42-1.42l-4.92 4.92a1 1 0 0 0 0 1.42Z"></path></svg></span><span class="sr-only">Section titled â€œSecurity sonsiderationsâ€</span></a></div>
<ul>
<li><strong>Trust settings:</strong> The <code dir="auto">trust</code> option bypasses all confirmation dialogs. Use
cautiously and only for servers you completely control</li>
<li><strong>Access tokens:</strong> Be security-aware when configuring environment variables
containing API keys or tokens</li>
<li><strong>Sandbox compatibility:</strong> When using sandboxing, ensure MCP servers are
available within the sandbox environment</li>
<li><strong>Private data:</strong> Using broadly scoped personal access tokens can lead to
information leakage between repositories</li>
</ul>
<div class="sl-heading-wrapper level-h3"><h3 id="performance-and-resource-management">Performance and resource management</h3><a class="sl-anchor-link" href="#performance-and-resource-management"><span aria-hidden="true" class="sl-anchor-icon"><svg width="16" height="16" viewBox="0 0 24 24"><path fill="currentcolor" d="m12.11 15.39-3.88 3.88a2.52 2.52 0 0 1-3.5 0 2.47 2.47 0 0 1 0-3.5l3.88-3.88a1 1 0 0 0-1.42-1.42l-3.88 3.89a4.48 4.48 0 0 0 6.33 6.33l3.89-3.88a1 1 0 1 0-1.42-1.42Zm8.58-12.08a4.49 4.49 0 0 0-6.33 0l-3.89 3.88a1 1 0 0 0 1.42 1.42l3.88-3.88a2.52 2.52 0 0 1 3.5 0 2.47 2.47 0 0 1 0 3.5l-3.88 3.88a1 1 0 1 0 1.42 1.42l3.88-3.89a4.49 4.49 0 0 0 0-6.33ZM8.83 15.17a1 1 0 0 0 1.1.22 1 1 0 0 0 .32-.22l4.92-4.92a1 1 0 0 0-1.42-1.42l-4.92 4.92a1 1 0 0 0 0 1.42Z"></path></svg></span><span class="sr-only">Section titled â€œPerformance and resource managementâ€</span></a></div>
<ul>
<li><strong>Connection persistence:</strong> The CLI maintains persistent connections to
servers that successfully register tools</li>
<li><strong>Automatic cleanup:</strong> Connections to servers providing no tools are
automatically closed</li>
<li><strong>Timeout management:</strong> Configure appropriate timeouts based on your serverâ€™s
response characteristics</li>
<li><strong>Resource monitoring:</strong> MCP servers run as separate processes and consume
system resources</li>
</ul>
<div class="sl-heading-wrapper level-h3"><h3 id="schema-compatibility">Schema compatibility</h3><a class="sl-anchor-link" href="#schema-compatibility"><span aria-hidden="true" class="sl-anchor-icon"><svg width="16" height="16" viewBox="0 0 24 24"><path fill="currentcolor" d="m12.11 15.39-3.88 3.88a2.52 2.52 0 0 1-3.5 0 2.47 2.47 0 0 1 0-3.5l3.88-3.88a1 1 0 0 0-1.42-1.42l-3.88 3.89a4.48 4.48 0 0 0 6.33 6.33l3.89-3.88a1 1 0 1 0-1.42-1.42Zm8.58-12.08a4.49 4.49 0 0 0-6.33 0l-3.89 3.88a1 1 0 0 0 1.42 1.42l3.88-3.88a2.52 2.52 0 0 1 3.5 0 2.47 2.47 0 0 1 0 3.5l-3.88 3.88a1 1 0 1 0 1.42 1.42l3.88-3.89a4.49 4.49 0 0 0 0-6.33ZM8.83 15.17a1 1 0 0 0 1.1.22 1 1 0 0 0 .32-.22l4.92-4.92a1 1 0 0 0-1.42-1.42l-4.92 4.92a1 1 0 0 0 0 1.42Z"></path></svg></span><span class="sr-only">Section titled â€œSchema compatibilityâ€</span></a></div>
<ul>
<li><strong>Property stripping:</strong> The system automatically removes certain schema
properties (<code dir="auto">$schema</code>, <code dir="auto">additionalProperties</code>) for Gemini API compatibility</li>
<li><strong>Name sanitization:</strong> Tool names are automatically sanitized to meet API
requirements</li>
<li><strong>Conflict resolution:</strong> Tool name conflicts between servers are resolved
through automatic prefixing</li>
</ul>
<p>This comprehensive integration makes MCP servers a powerful way to extend the
Gemini CLIâ€™s capabilities while maintaining security, reliability, and ease of
use.</p>
<div class="sl-heading-wrapper level-h2"><h2 id="returning-rich-content-from-tools">Returning rich content from tools</h2><a class="sl-anchor-link" href="#returning-rich-content-from-tools"><span aria-hidden="true" class="sl-anchor-icon"><svg width="16" height="16" viewBox="0 0 24 24"><path fill="currentcolor" d="m12.11 15.39-3.88 3.88a2.52 2.52 0 0 1-3.5 0 2.47 2.47 0 0 1 0-3.5l3.88-3.88a1 1 0 0 0-1.42-1.42l-3.88 3.89a4.48 4.48 0 0 0 6.33 6.33l3.89-3.88a1 1 0 1 0-1.42-1.42Zm8.58-12.08a4.49 4.49 0 0 0-6.33 0l-3.89 3.88a1 1 0 0 0 1.42 1.42l3.88-3.88a2.52 2.52 0 0 1 3.5 0 2.47 2.47 0 0 1 0 3.5l-3.88 3.88a1 1 0 1 0 1.42 1.42l3.88-3.89a4.49 4.49 0 0 0 0-6.33ZM8.83 15.17a1 1 0 0 0 1.1.22 1 1 0 0 0 .32-.22l4.92-4.92a1 1 0 0 0-1.42-1.42l-4.92 4.92a1 1 0 0 0 0 1.42Z"></path></svg></span><span class="sr-only">Section titled â€œReturning rich content from toolsâ€</span></a></div>
<p>MCP tools are not limited to returning simple text. You can return rich,
multi-part content, including text, images, audio, and other binary data in a
single tool response. This allows you to build powerful tools that can provide
diverse information to the model in a single turn.</p>
<p>All data returned from the tool is processed and sent to the model as context
for its next generation, enabling it to reason about or summarize the provided
information.</p>
<div class="sl-heading-wrapper level-h3"><h3 id="how-it-works">How it works</h3><a class="sl-anchor-link" href="#how-it-works"><span aria-hidden="true" class="sl-anchor-icon"><svg width="16" height="16" viewBox="0 0 24 24"><path fill="currentcolor" d="m12.11 15.39-3.88 3.88a2.52 2.52 0 0 1-3.5 0 2.47 2.47 0 0 1 0-3.5l3.88-3.88a1 1 0 0 0-1.42-1.42l-3.88 3.89a4.48 4.48 0 0 0 6.33 6.33l3.89-3.88a1 1 0 1 0-1.42-1.42Zm8.58-12.08a4.49 4.49 0 0 0-6.33 0l-3.89 3.88a1 1 0 0 0 1.42 1.42l3.88-3.88a2.52 2.52 0 0 1 3.5 0 2.47 2.47 0 0 1 0 3.5l-3.88 3.88a1 1 0 1 0 1.42 1.42l3.88-3.89a4.49 4.49 0 0 0 0-6.33ZM8.83 15.17a1 1 0 0 0 1.1.22 1 1 0 0 0 .32-.22l4.92-4.92a1 1 0 0 0-1.42-1.42l-4.92 4.92a1 1 0 0 0 0 1.42Z"></path></svg></span><span class="sr-only">Section titled â€œHow it worksâ€</span></a></div>
<p>To return rich content, your toolâ€™s response must adhere to the MCP
specification for a
<a href="https://modelcontextprotocol.io/specification/2025-06-18/server/tools#tool-result"><code dir="auto">CallToolResult</code></a>.
The <code dir="auto">content</code> field of the result should be an array of <code dir="auto">ContentBlock</code> objects.
The Gemini CLI will correctly process this array, separating text from binary
data and packaging it for the model.</p>
<p>You can mix and match different content block types in the <code dir="auto">content</code> array. The
supported block types include:</p>
<ul>
<li><code dir="auto">text</code></li>
<li><code dir="auto">image</code></li>
<li><code dir="auto">audio</code></li>
<li><code dir="auto">resource</code> (embedded content)</li>
<li><code dir="auto">resource_link</code></li>
</ul>
<div class="sl-heading-wrapper level-h3"><h3 id="example-returning-text-and-an-image">Example: Returning text and an image</h3><a class="sl-anchor-link" href="#example-returning-text-and-an-image"><span aria-hidden="true" class="sl-anchor-icon"><svg width="16" height="16" viewBox="0 0 24 24"><path fill="currentcolor" d="m12.11 15.39-3.88 3.88a2.52 2.52 0 0 1-3.5 0 2.47 2.47 0 0 1 0-3.5l3.88-3.88a1 1 0 0 0-1.42-1.42l-3.88 3.89a4.48 4.48 0 0 0 6.33 6.33l3.89-3.88a1 1 0 1 0-1.42-1.42Zm8.58-12.08a4.49 4.49 0 0 0-6.33 0l-3.89 3.88a1 1 0 0 0 1.42 1.42l3.88-3.88a2.52 2.52 0 0 1 3.5 0 2.47 2.47 0 0 1 0 3.5l-3.88 3.88a1 1 0 1 0 1.42 1.42l3.88-3.89a4.49 4.49 0 0 0 0-6.33ZM8.83 15.17a1 1 0 0 0 1.1.22 1 1 0 0 0 .32-.22l4.92-4.92a1 1 0 0 0-1.42-1.42l-4.92 4.92a1 1 0 0 0 0 1.42Z"></path></svg></span><span class="sr-only">Section titled â€œExample: Returning text and an imageâ€</span></a></div>
<p>Here is an example of a valid JSON response from an MCP tool that returns both a
text description and an image:</p>
<div class="expressive-code"><figure class="frame not-content"><figcaption class="header"></figcaption><pre data-language="json"><code><div class="ec-line"><div class="code"><span style="--0:#E1DFDF;--1:#292929">{</span></div></div><div class="ec-line"><div class="code"><span class="indent">  </span><span style="--0:#85CDF1;--1:#00709A">"content"</span><span style="--0:#E1DFDF;--1:#292929">: [</span></div></div><div class="ec-line"><div class="code"><span class="indent"><span style="--0:#E1DFDF;--1:#292929">    </span></span><span style="--0:#E1DFDF;--1:#292929">{</span></div></div><div class="ec-line"><div class="code"><span class="indent">      </span><span style="--0:#85CDF1;--1:#00709A">"type"</span><span style="--0:#E1DFDF;--1:#292929">: </span><span style="--0:#77D5A3;--1:#007847">"text"</span><span style="--0:#E1DFDF;--1:#292929">,</span></div></div><div class="ec-line"><div class="code"><span class="indent">      </span><span style="--0:#85CDF1;--1:#00709A">"text"</span><span style="--0:#E1DFDF;--1:#292929">: </span><span style="--0:#77D5A3;--1:#007847">"Here is the logo you requested."</span></div></div><div class="ec-line"><div class="code"><span class="indent"><span style="--0:#E1DFDF;--1:#292929">    </span></span><span style="--0:#E1DFDF;--1:#292929">},</span></div></div><div class="ec-line"><div class="code"><span class="indent"><span style="--0:#E1DFDF;--1:#292929">    </span></span><span style="--0:#E1DFDF;--1:#292929">{</span></div></div><div class="ec-line"><div class="code"><span class="indent">      </span><span style="--0:#85CDF1;--1:#00709A">"type"</span><span style="--0:#E1DFDF;--1:#292929">: </span><span style="--0:#77D5A3;--1:#007847">"image"</span><span style="--0:#E1DFDF;--1:#292929">,</span></div></div><div class="ec-line"><div class="code"><span class="indent">      </span><span style="--0:#85CDF1;--1:#00709A">"data"</span><span style="--0:#E1DFDF;--1:#292929">: </span><span style="--0:#77D5A3;--1:#007847">"BASE64_ENCODED_IMAGE_DATA_HERE"</span><span style="--0:#E1DFDF;--1:#292929">,</span></div></div><div class="ec-line"><div class="code"><span class="indent">      </span><span style="--0:#85CDF1;--1:#00709A">"mimeType"</span><span style="--0:#E1DFDF;--1:#292929">: </span><span style="--0:#77D5A3;--1:#007847">"image/png"</span></div></div><div class="ec-line"><div class="code"><span class="indent"><span style="--0:#E1DFDF;--1:#292929">    </span></span><span style="--0:#E1DFDF;--1:#292929">},</span></div></div><div class="ec-line"><div class="code"><span class="indent"><span style="--0:#E1DFDF;--1:#292929">    </span></span><span style="--0:#E1DFDF;--1:#292929">{</span></div></div><div class="ec-line"><div class="code"><span class="indent">      </span><span style="--0:#85CDF1;--1:#00709A">"type"</span><span style="--0:#E1DFDF;--1:#292929">: </span><span style="--0:#77D5A3;--1:#007847">"text"</span><span style="--0:#E1DFDF;--1:#292929">,</span></div></div><div class="ec-line"><div class="code"><span class="indent">      </span><span style="--0:#85CDF1;--1:#00709A">"text"</span><span style="--0:#E1DFDF;--1:#292929">: </span><span style="--0:#77D5A3;--1:#007847">"The logo was created in 2025."</span></div></div><div class="ec-line"><div class="code"><span class="indent"><span style="--0:#E1DFDF;--1:#292929">    </span></span><span style="--0:#E1DFDF;--1:#292929">}</span></div></div><div class="ec-line"><div class="code"><span class="indent"><span style="--0:#E1DFDF;--1:#292929">  </span></span><span style="--0:#E1DFDF;--1:#292929">]</span></div></div><div class="ec-line"><div class="code"><span style="--0:#E1DFDF;--1:#292929">}</span></div></div></code></pre><div class="copy"><button title="Copy to clipboard" data-copied="Copied!" data-code="{  &#x22;content&#x22;: [    {      &#x22;type&#x22;: &#x22;text&#x22;,      &#x22;text&#x22;: &#x22;Here is the logo you requested.&#x22;    },    {      &#x22;type&#x22;: &#x22;image&#x22;,      &#x22;data&#x22;: &#x22;BASE64_ENCODED_IMAGE_DATA_HERE&#x22;,      &#x22;mimeType&#x22;: &#x22;image/png&#x22;    },    {      &#x22;type&#x22;: &#x22;text&#x22;,      &#x22;text&#x22;: &#x22;The logo was created in 2025.&#x22;    }  ]}"><div></div></button></div></figure></div>
<p>When the Gemini CLI receives this response, it will:</p>
<ol>
<li>Extract all the text and combine it into a single <code dir="auto">functionResponse</code> part
for the model.</li>
<li>Present the image data as a separate <code dir="auto">inlineData</code> part.</li>
<li>Provide a clean, user-friendly summary in the CLI, indicating that both text
and an image were received.</li>
</ol>
<p>This enables you to build sophisticated tools that can provide rich, multi-modal
context to the Gemini model.</p>
<div class="sl-heading-wrapper level-h2"><h2 id="mcp-prompts-as-slash-commands">MCP prompts as slash commands</h2><a class="sl-anchor-link" href="#mcp-prompts-as-slash-commands"><span aria-hidden="true" class="sl-anchor-icon"><svg width="16" height="16" viewBox="0 0 24 24"><path fill="currentcolor" d="m12.11 15.39-3.88 3.88a2.52 2.52 0 0 1-3.5 0 2.47 2.47 0 0 1 0-3.5l3.88-3.88a1 1 0 0 0-1.42-1.42l-3.88 3.89a4.48 4.48 0 0 0 6.33 6.33l3.89-3.88a1 1 0 1 0-1.42-1.42Zm8.58-12.08a4.49 4.49 0 0 0-6.33 0l-3.89 3.88a1 1 0 0 0 1.42 1.42l3.88-3.88a2.52 2.52 0 0 1 3.5 0 2.47 2.47 0 0 1 0 3.5l-3.88 3.88a1 1 0 1 0 1.42 1.42l3.88-3.89a4.49 4.49 0 0 0 0-6.33ZM8.83 15.17a1 1 0 0 0 1.1.22 1 1 0 0 0 .32-.22l4.92-4.92a1 1 0 0 0-1.42-1.42l-4.92 4.92a1 1 0 0 0 0 1.42Z"></path></svg></span><span class="sr-only">Section titled â€œMCP prompts as slash commandsâ€</span></a></div>
<p>In addition to tools, MCP servers can expose predefined prompts that can be
executed as slash commands within the Gemini CLI. This allows you to create
shortcuts for common or complex queries that can be easily invoked by name.</p>
<div class="sl-heading-wrapper level-h3"><h3 id="defining-prompts-on-the-server">Defining prompts on the server</h3><a class="sl-anchor-link" href="#defining-prompts-on-the-server"><span aria-hidden="true" class="sl-anchor-icon"><svg width="16" height="16" viewBox="0 0 24 24"><path fill="currentcolor" d="m12.11 15.39-3.88 3.88a2.52 2.52 0 0 1-3.5 0 2.47 2.47 0 0 1 0-3.5l3.88-3.88a1 1 0 0 0-1.42-1.42l-3.88 3.89a4.48 4.48 0 0 0 6.33 6.33l3.89-3.88a1 1 0 1 0-1.42-1.42Zm8.58-12.08a4.49 4.49 0 0 0-6.33 0l-3.89 3.88a1 1 0 0 0 1.42 1.42l3.88-3.88a2.52 2.52 0 0 1 3.5 0 2.47 2.47 0 0 1 0 3.5l-3.88 3.88a1 1 0 1 0 1.42 1.42l3.88-3.89a4.49 4.49 0 0 0 0-6.33ZM8.83 15.17a1 1 0 0 0 1.1.22 1 1 0 0 0 .32-.22l4.92-4.92a1 1 0 0 0-1.42-1.42l-4.92 4.92a1 1 0 0 0 0 1.42Z"></path></svg></span><span class="sr-only">Section titled â€œDefining prompts on the serverâ€</span></a></div>
<p>Hereâ€™s a small example of a stdio MCP server that defines prompts:</p>
<div class="expressive-code"><figure class="frame not-content"><figcaption class="header"></figcaption><pre data-language="ts"><code><div class="ec-line"><div class="code"><span style="--0:#FD8DA3;--1:#C12F57">import</span><span style="--0:#E1DFDF;--1:#292929"> { McpServer } </span><span style="--0:#FD8DA3;--1:#C12F57">from</span><span style="--0:#E1DFDF;--1:#292929"> </span><span style="--0:#77D5A3;--1:#007847">'@modelcontextprotocol/sdk/server/mcp.js'</span><span style="--0:#E1DFDF;--1:#292929">;</span></div></div><div class="ec-line"><div class="code"><span style="--0:#FD8DA3;--1:#C12F57">import</span><span style="--0:#E1DFDF;--1:#292929"> { StdioServerTransport } </span><span style="--0:#FD8DA3;--1:#C12F57">from</span><span style="--0:#E1DFDF;--1:#292929"> </span><span style="--0:#77D5A3;--1:#007847">'@modelcontextprotocol/sdk/server/stdio.js'</span><span style="--0:#E1DFDF;--1:#292929">;</span></div></div><div class="ec-line"><div class="code"><span style="--0:#FD8DA3;--1:#C12F57">import</span><span style="--0:#E1DFDF;--1:#292929"> { z } </span><span style="--0:#FD8DA3;--1:#C12F57">from</span><span style="--0:#E1DFDF;--1:#292929"> </span><span style="--0:#77D5A3;--1:#007847">'zod'</span><span style="--0:#E1DFDF;--1:#292929">;</span></div></div><div class="ec-line"><div class="code">
</div></div><div class="ec-line"><div class="code"><span style="--0:#FD8DA3;--1:#C12F57">const</span><span style="--0:#E1DFDF;--1:#292929"> </span><span style="--0:#8DA8FF;--1:#3252B8">server</span><span style="--0:#E1DFDF;--1:#292929"> </span><span style="--0:#FD8DA3;--1:#C12F57">=</span><span style="--0:#E1DFDF;--1:#292929"> </span><span style="--0:#FD8DA3;--1:#C12F57">new</span><span style="--0:#E1DFDF;--1:#292929"> </span><span style="--0:#BD9CFE;--1:#6F4CDE">McpServer</span><span style="--0:#E1DFDF;--1:#292929">({</span></div></div><div class="ec-line"><div class="code"><span class="indent"><span style="--0:#E1DFDF;--1:#292929">  </span></span><span style="--0:#E1DFDF;--1:#292929">name: </span><span style="--0:#77D5A3;--1:#007847">'prompt-server'</span><span style="--0:#E1DFDF;--1:#292929">,</span></div></div><div class="ec-line"><div class="code"><span class="indent"><span style="--0:#E1DFDF;--1:#292929">  </span></span><span style="--0:#E1DFDF;--1:#292929">version: </span><span style="--0:#77D5A3;--1:#007847">'1.0.0'</span><span style="--0:#E1DFDF;--1:#292929">,</span></div></div><div class="ec-line"><div class="code"><span style="--0:#E1DFDF;--1:#292929">});</span></div></div><div class="ec-line"><div class="code">
</div></div><div class="ec-line"><div class="code"><span style="--0:#E1DFDF;--1:#292929">server.</span><span style="--0:#BD9CFE;--1:#6F4CDE">registerPrompt</span><span style="--0:#E1DFDF;--1:#292929">(</span></div></div><div class="ec-line"><div class="code"><span class="indent">  </span><span style="--0:#77D5A3;--1:#007847">'poem-writer'</span><span style="--0:#E1DFDF;--1:#292929">,</span></div></div><div class="ec-line"><div class="code"><span class="indent"><span style="--0:#E1DFDF;--1:#292929">  </span></span><span style="--0:#E1DFDF;--1:#292929">{</span></div></div><div class="ec-line"><div class="code"><span class="indent"><span style="--0:#E1DFDF;--1:#292929">    </span></span><span style="--0:#E1DFDF;--1:#292929">title: </span><span style="--0:#77D5A3;--1:#007847">'Poem Writer'</span><span style="--0:#E1DFDF;--1:#292929">,</span></div></div><div class="ec-line"><div class="code"><span class="indent"><span style="--0:#E1DFDF;--1:#292929">    </span></span><span style="--0:#E1DFDF;--1:#292929">description: </span><span style="--0:#77D5A3;--1:#007847">'Write a nice haiku'</span><span style="--0:#E1DFDF;--1:#292929">,</span></div></div><div class="ec-line"><div class="code"><span class="indent"><span style="--0:#E1DFDF;--1:#292929">    </span></span><span style="--0:#E1DFDF;--1:#292929">argsSchema: { title: z.</span><span style="--0:#BD9CFE;--1:#6F4CDE">string</span><span style="--0:#E1DFDF;--1:#292929">(), mood: z.</span><span style="--0:#BD9CFE;--1:#6F4CDE">string</span><span style="--0:#E1DFDF;--1:#292929">().</span><span style="--0:#BD9CFE;--1:#6F4CDE">optional</span><span style="--0:#E1DFDF;--1:#292929">() },</span></div></div><div class="ec-line"><div class="code"><span class="indent"><span style="--0:#E1DFDF;--1:#292929">  </span></span><span style="--0:#E1DFDF;--1:#292929">},</span></div></div><div class="ec-line"><div class="code"><span class="indent"><span style="--0:#E1DFDF;--1:#292929">  </span></span><span style="--0:#E1DFDF;--1:#292929">({ </span><span style="--0:#FFD395;--1:#99581C">title</span><span style="--0:#E1DFDF;--1:#292929">, </span><span style="--0:#FFD395;--1:#99581C">mood</span><span style="--0:#E1DFDF;--1:#292929"> }) </span><span style="--0:#FD8DA3;--1:#C12F57">=></span><span style="--0:#E1DFDF;--1:#292929"> ({</span></div></div><div class="ec-line"><div class="code"><span class="indent"><span style="--0:#E1DFDF;--1:#292929">    </span></span><span style="--0:#E1DFDF;--1:#292929">messages: [</span></div></div><div class="ec-line"><div class="code"><span class="indent"><span style="--0:#E1DFDF;--1:#292929">      </span></span><span style="--0:#E1DFDF;--1:#292929">{</span></div></div><div class="ec-line"><div class="code"><span class="indent"><span style="--0:#E1DFDF;--1:#292929">        </span></span><span style="--0:#E1DFDF;--1:#292929">role: </span><span style="--0:#77D5A3;--1:#007847">'user'</span><span style="--0:#E1DFDF;--1:#292929">,</span></div></div><div class="ec-line"><div class="code"><span class="indent"><span style="--0:#E1DFDF;--1:#292929">        </span></span><span style="--0:#E1DFDF;--1:#292929">content: {</span></div></div><div class="ec-line"><div class="code"><span class="indent"><span style="--0:#E1DFDF;--1:#292929">          </span></span><span style="--0:#E1DFDF;--1:#292929">type: </span><span style="--0:#77D5A3;--1:#007847">'text'</span><span style="--0:#E1DFDF;--1:#292929">,</span></div></div><div class="ec-line"><div class="code"><span class="indent"><span style="--0:#E1DFDF;--1:#292929">          </span></span><span style="--0:#E1DFDF;--1:#292929">text: </span><span style="--0:#77D5A3;--1:#007847">`Write a haiku${</span><span style="--0:#E1DFDF;--1:#292929">mood</span><span style="--0:#77D5A3;--1:#007847"> </span><span style="--0:#FD8DA3;--1:#C12F57">?</span><span style="--0:#77D5A3;--1:#007847"> </span><span style="--0:#77D5A3;--1:#007847">` with the mood ${</span><span style="--0:#E1DFDF;--1:#292929">mood</span><span style="--0:#77D5A3;--1:#007847">}`</span><span style="--0:#77D5A3;--1:#007847"> </span><span style="--0:#FD8DA3;--1:#C12F57">:</span><span style="--0:#77D5A3;--1:#007847"> </span><span style="--0:#77D5A3;--1:#007847">''} called ${</span><span style="--0:#E1DFDF;--1:#292929">title</span><span style="--0:#77D5A3;--1:#007847">}. Note that a haiku is 5 syllables followed by 7 syllables followed by 5 syllables `</span><span style="--0:#E1DFDF;--1:#292929">,</span></div></div><div class="ec-line"><div class="code"><span class="indent"><span style="--0:#E1DFDF;--1:#292929">        </span></span><span style="--0:#E1DFDF;--1:#292929">},</span></div></div><div class="ec-line"><div class="code"><span class="indent"><span style="--0:#E1DFDF;--1:#292929">      </span></span><span style="--0:#E1DFDF;--1:#292929">},</span></div></div><div class="ec-line"><div class="code"><span class="indent"><span style="--0:#E1DFDF;--1:#292929">    </span></span><span style="--0:#E1DFDF;--1:#292929">],</span></div></div><div class="ec-line"><div class="code"><span class="indent"><span style="--0:#E1DFDF;--1:#292929">  </span></span><span style="--0:#E1DFDF;--1:#292929">}),</span></div></div><div class="ec-line"><div class="code"><span style="--0:#E1DFDF;--1:#292929">);</span></div></div><div class="ec-line"><div class="code">
</div></div><div class="ec-line"><div class="code"><span style="--0:#FD8DA3;--1:#C12F57">const</span><span style="--0:#E1DFDF;--1:#292929"> </span><span style="--0:#8DA8FF;--1:#3252B8">transport</span><span style="--0:#E1DFDF;--1:#292929"> </span><span style="--0:#FD8DA3;--1:#C12F57">=</span><span style="--0:#E1DFDF;--1:#292929"> </span><span style="--0:#FD8DA3;--1:#C12F57">new</span><span style="--0:#E1DFDF;--1:#292929"> </span><span style="--0:#BD9CFE;--1:#6F4CDE">StdioServerTransport</span><span style="--0:#E1DFDF;--1:#292929">();</span></div></div><div class="ec-line"><div class="code"><span style="--0:#FD8DA3;--1:#C12F57">await</span><span style="--0:#E1DFDF;--1:#292929"> server.</span><span style="--0:#BD9CFE;--1:#6F4CDE">connect</span><span style="--0:#E1DFDF;--1:#292929">(transport);</span></div></div></code></pre><div class="copy"><button title="Copy to clipboard" data-copied="Copied!" data-code="import { McpServer } from &#x27;@modelcontextprotocol/sdk/server/mcp.js&#x27;;import { StdioServerTransport } from &#x27;@modelcontextprotocol/sdk/server/stdio.js&#x27;;import { z } from &#x27;zod&#x27;;const server = new McpServer({  name: &#x27;prompt-server&#x27;,  version: &#x27;1.0.0&#x27;,});server.registerPrompt(  &#x27;poem-writer&#x27;,  {    title: &#x27;Poem Writer&#x27;,    description: &#x27;Write a nice haiku&#x27;,    argsSchema: { title: z.string(), mood: z.string().optional() },  },  ({ title, mood }) => ({    messages: [      {        role: &#x27;user&#x27;,        content: {          type: &#x27;text&#x27;,          text: &#x60;Write a haiku${mood ? &#x60; with the mood ${mood}&#x60; : &#x27;&#x27;} called ${title}. Note that a haiku is 5 syllables followed by 7 syllables followed by 5 syllables &#x60;,        },      },    ],  }),);const transport = new StdioServerTransport();await server.connect(transport);"><div></div></button></div></figure></div>
<p>This can be included in <code dir="auto">settings.json</code> under <code dir="auto">mcpServers</code> with:</p>
<div class="expressive-code"><figure class="frame not-content"><figcaption class="header"></figcaption><pre data-language="json"><code><div class="ec-line"><div class="code"><span style="--0:#E1DFDF;--1:#292929">{</span></div></div><div class="ec-line"><div class="code"><span class="indent">  </span><span style="--0:#85CDF1;--1:#00709A">"mcpServers"</span><span style="--0:#E1DFDF;--1:#292929">: {</span></div></div><div class="ec-line"><div class="code"><span class="indent">    </span><span style="--0:#85CDF1;--1:#00709A">"nodeServer"</span><span style="--0:#E1DFDF;--1:#292929">: {</span></div></div><div class="ec-line"><div class="code"><span class="indent">      </span><span style="--0:#85CDF1;--1:#00709A">"command"</span><span style="--0:#E1DFDF;--1:#292929">: </span><span style="--0:#77D5A3;--1:#007847">"node"</span><span style="--0:#E1DFDF;--1:#292929">,</span></div></div><div class="ec-line"><div class="code"><span class="indent">      </span><span style="--0:#85CDF1;--1:#00709A">"args"</span><span style="--0:#E1DFDF;--1:#292929">: [</span><span style="--0:#77D5A3;--1:#007847">"filename.ts"</span><span style="--0:#E1DFDF;--1:#292929">]</span></div></div><div class="ec-line"><div class="code"><span class="indent"><span style="--0:#E1DFDF;--1:#292929">    </span></span><span style="--0:#E1DFDF;--1:#292929">}</span></div></div><div class="ec-line"><div class="code"><span class="indent"><span style="--0:#E1DFDF;--1:#292929">  </span></span><span style="--0:#E1DFDF;--1:#292929">}</span></div></div><div class="ec-line"><div class="code"><span style="--0:#E1DFDF;--1:#292929">}</span></div></div></code></pre><div class="copy"><button title="Copy to clipboard" data-copied="Copied!" data-code="{  &#x22;mcpServers&#x22;: {    &#x22;nodeServer&#x22;: {      &#x22;command&#x22;: &#x22;node&#x22;,      &#x22;args&#x22;: [&#x22;filename.ts&#x22;]    }  }}"><div></div></button></div></figure></div>
<div class="sl-heading-wrapper level-h3"><h3 id="invoking-prompts">Invoking prompts</h3><a class="sl-anchor-link" href="#invoking-prompts"><span aria-hidden="true" class="sl-anchor-icon"><svg width="16" height="16" viewBox="0 0 24 24"><path fill="currentcolor" d="m12.11 15.39-3.88 3.88a2.52 2.52 0 0 1-3.5 0 2.47 2.47 0 0 1 0-3.5l3.88-3.88a1 1 0 0 0-1.42-1.42l-3.88 3.89a4.48 4.48 0 0 0 6.33 6.33l3.89-3.88a1 1 0 1 0-1.42-1.42Zm8.58-12.08a4.49 4.49 0 0 0-6.33 0l-3.89 3.88a1 1 0 0 0 1.42 1.42l3.88-3.88a2.52 2.52 0 0 1 3.5 0 2.47 2.47 0 0 1 0 3.5l-3.88 3.88a1 1 0 1 0 1.42 1.42l3.88-3.89a4.49 4.49 0 0 0 0-6.33ZM8.83 15.17a1 1 0 0 0 1.1.22 1 1 0 0 0 .32-.22l4.92-4.92a1 1 0 0 0-1.42-1.42l-4.92 4.92a1 1 0 0 0 0 1.42Z"></path></svg></span><span class="sr-only">Section titled â€œInvoking promptsâ€</span></a></div>
<p>Once a prompt is discovered, you can invoke it using its name as a slash
command. The CLI will automatically handle parsing arguments.</p>
<div class="expressive-code"><figure class="frame is-terminal not-content"><figcaption class="header"><span class="title"></span><span class="sr-only">Terminal window</span></figcaption><pre data-language="bash"><code><div class="ec-line"><div class="code"><span style="--0:#BD9CFE;--1:#6F4CDE">/poem-writer</span><span style="--0:#E1DFDF;--1:#292929"> </span><span style="--0:#8DA8FF;--1:#3252B8">--title=</span><span style="--0:#77D5A3;--1:#007847">"Gemini CLI"</span><span style="--0:#E1DFDF;--1:#292929"> </span><span style="--0:#8DA8FF;--1:#3252B8">--mood=</span><span style="--0:#77D5A3;--1:#007847">"reverent"</span></div></div></code></pre><div class="copy"><button title="Copy to clipboard" data-copied="Copied!" data-code="/poem-writer --title=&#x22;Gemini CLI&#x22; --mood=&#x22;reverent&#x22;"><div></div></button></div></figure></div>
<p>or, using positional arguments:</p>
<div class="expressive-code"><figure class="frame is-terminal not-content"><figcaption class="header"><span class="title"></span><span class="sr-only">Terminal window</span></figcaption><pre data-language="bash"><code><div class="ec-line"><div class="code"><span style="--0:#BD9CFE;--1:#6F4CDE">/poem-writer</span><span style="--0:#E1DFDF;--1:#292929"> </span><span style="--0:#77D5A3;--1:#007847">"Gemini CLI"</span><span style="--0:#E1DFDF;--1:#292929"> </span><span style="--0:#77D5A3;--1:#007847">reverent</span></div></div></code></pre><div class="copy"><button title="Copy to clipboard" data-copied="Copied!" data-code="/poem-writer &#x22;Gemini CLI&#x22; reverent"><div></div></button></div></figure></div>
<p>When you run this command, the Gemini CLI executes the <code dir="auto">prompts/get</code> method on
the MCP server with the provided arguments. The server is responsible for
substituting the arguments into the prompt template and returning the final
prompt text. The CLI then sends this prompt to the model for execution. This
provides a convenient way to automate and share common workflows.</p>
<div class="sl-heading-wrapper level-h2"><h2 id="managing-mcp-servers-with-gemini-mcp">Managing MCP servers with <code dir="auto">gemini mcp</code></h2><a class="sl-anchor-link" href="#managing-mcp-servers-with-gemini-mcp"><span aria-hidden="true" class="sl-anchor-icon"><svg width="16" height="16" viewBox="0 0 24 24"><path fill="currentcolor" d="m12.11 15.39-3.88 3.88a2.52 2.52 0 0 1-3.5 0 2.47 2.47 0 0 1 0-3.5l3.88-3.88a1 1 0 0 0-1.42-1.42l-3.88 3.89a4.48 4.48 0 0 0 6.33 6.33l3.89-3.88a1 1 0 1 0-1.42-1.42Zm8.58-12.08a4.49 4.49 0 0 0-6.33 0l-3.89 3.88a1 1 0 0 0 1.42 1.42l3.88-3.88a2.52 2.52 0 0 1 3.5 0 2.47 2.47 0 0 1 0 3.5l-3.88 3.88a1 1 0 1 0 1.42 1.42l3.88-3.89a4.49 4.49 0 0 0 0-6.33ZM8.83 15.17a1 1 0 0 0 1.1.22 1 1 0 0 0 .32-.22l4.92-4.92a1 1 0 0 0-1.42-1.42l-4.92 4.92a1 1 0 0 0 0 1.42Z"></path></svg></span><span class="sr-only">Section titled â€œManaging MCP servers with gemini mcpâ€</span></a></div>
<p>While you can always configure MCP servers by manually editing your
<code dir="auto">settings.json</code> file, the Gemini CLI provides a convenient set of commands to
manage your server configurations programmatically. These commands streamline
the process of adding, listing, and removing MCP servers without needing to
directly edit JSON files.</p>
<div class="sl-heading-wrapper level-h3"><h3 id="adding-a-server-gemini-mcp-add">Adding a server (<code dir="auto">gemini mcp add</code>)</h3><a class="sl-anchor-link" href="#adding-a-server-gemini-mcp-add"><span aria-hidden="true" class="sl-anchor-icon"><svg width="16" height="16" viewBox="0 0 24 24"><path fill="currentcolor" d="m12.11 15.39-3.88 3.88a2.52 2.52 0 0 1-3.5 0 2.47 2.47 0 0 1 0-3.5l3.88-3.88a1 1 0 0 0-1.42-1.42l-3.88 3.89a4.48 4.48 0 0 0 6.33 6.33l3.89-3.88a1 1 0 1 0-1.42-1.42Zm8.58-12.08a4.49 4.49 0 0 0-6.33 0l-3.89 3.88a1 1 0 0 0 1.42 1.42l3.88-3.88a2.52 2.52 0 0 1 3.5 0 2.47 2.47 0 0 1 0 3.5l-3.88 3.88a1 1 0 1 0 1.42 1.42l3.88-3.89a4.49 4.49 0 0 0 0-6.33ZM8.83 15.17a1 1 0 0 0 1.1.22 1 1 0 0 0 .32-.22l4.92-4.92a1 1 0 0 0-1.42-1.42l-4.92 4.92a1 1 0 0 0 0 1.42Z"></path></svg></span><span class="sr-only">Section titled â€œAdding a server (gemini mcp add)â€</span></a></div>
<p>The <code dir="auto">add</code> command configures a new MCP server in your <code dir="auto">settings.json</code>. Based on
the scope (<code dir="auto">-s, --scope</code>), it will be added to either the user config
<code dir="auto">~/.gemini/settings.json</code> or the project config <code dir="auto">.gemini/settings.json</code> file.</p>
<p><strong>Command:</strong></p>
<div class="expressive-code"><figure class="frame is-terminal not-content"><figcaption class="header"><span class="title"></span><span class="sr-only">Terminal window</span></figcaption><pre data-language="bash"><code><div class="ec-line"><div class="code"><span style="--0:#BD9CFE;--1:#6F4CDE">gemini</span><span style="--0:#E1DFDF;--1:#292929"> </span><span style="--0:#77D5A3;--1:#007847">mcp</span><span style="--0:#E1DFDF;--1:#292929"> </span><span style="--0:#77D5A3;--1:#007847">add</span><span style="--0:#E1DFDF;--1:#292929"> [options] &#x3C;name> &#x3C;commandOrUrl> [args...]</span></div></div></code></pre><div class="copy"><button title="Copy to clipboard" data-copied="Copied!" data-code="gemini mcp add [options] <name> <commandOrUrl> [args...]"><div></div></button></div></figure></div>
<ul>
<li><code dir="auto">&#x3C;name></code>: A unique name for the server.</li>
<li><code dir="auto">&#x3C;commandOrUrl></code>: The command to execute (for <code dir="auto">stdio</code>) or the URL (for
<code dir="auto">http</code>/<code dir="auto">sse</code>).</li>
<li><code dir="auto">[args...]</code>: Optional arguments for a <code dir="auto">stdio</code> command.</li>
</ul>
<p><strong>Options (flags):</strong></p>
<ul>
<li><code dir="auto">-s, --scope</code>: Configuration scope (user or project). [default: â€œprojectâ€]</li>
<li><code dir="auto">-t, --transport</code>: Transport type (stdio, sse, http). [default: â€œstdioâ€]</li>
<li><code dir="auto">-e, --env</code>: Set environment variables (e.g. -e KEY=value).</li>
<li><code dir="auto">-H, --header</code>: Set HTTP headers for SSE and HTTP transports (e.g. -H
â€œX-Api-Key: abc123â€ -H â€œAuthorization: Bearer abc123â€).</li>
<li><code dir="auto">--timeout</code>: Set connection timeout in milliseconds.</li>
<li><code dir="auto">--trust</code>: Trust the server (bypass all tool call confirmation prompts).</li>
<li><code dir="auto">--description</code>: Set the description for the server.</li>
<li><code dir="auto">--include-tools</code>: A comma-separated list of tools to include.</li>
<li><code dir="auto">--exclude-tools</code>: A comma-separated list of tools to exclude.</li>
</ul>
<div class="sl-heading-wrapper level-h4"><h4 id="adding-an-stdio-server">Adding an stdio server</h4><a class="sl-anchor-link" href="#adding-an-stdio-server"><span aria-hidden="true" class="sl-anchor-icon"><svg width="16" height="16" viewBox="0 0 24 24"><path fill="currentcolor" d="m12.11 15.39-3.88 3.88a2.52 2.52 0 0 1-3.5 0 2.47 2.47 0 0 1 0-3.5l3.88-3.88a1 1 0 0 0-1.42-1.42l-3.88 3.89a4.48 4.48 0 0 0 6.33 6.33l3.89-3.88a1 1 0 1 0-1.42-1.42Zm8.58-12.08a4.49 4.49 0 0 0-6.33 0l-3.89 3.88a1 1 0 0 0 1.42 1.42l3.88-3.88a2.52 2.52 0 0 1 3.5 0 2.47 2.47 0 0 1 0 3.5l-3.88 3.88a1 1 0 1 0 1.42 1.42l3.88-3.89a4.49 4.49 0 0 0 0-6.33ZM8.83 15.17a1 1 0 0 0 1.1.22 1 1 0 0 0 .32-.22l4.92-4.92a1 1 0 0 0-1.42-1.42l-4.92 4.92a1 1 0 0 0 0 1.42Z"></path></svg></span><span class="sr-only">Section titled â€œAdding an stdio serverâ€</span></a></div>
<p>This is the default transport for running local servers.</p>
<div class="expressive-code"><figure class="frame is-terminal not-content"><figcaption class="header"><span class="title"></span><span class="sr-only">Terminal window</span></figcaption><pre data-language="bash"><code><div class="ec-line"><div class="code"><span style="--0:#8E8E8E;--1:#686868"># Basic syntax</span></div></div><div class="ec-line"><div class="code"><span style="--0:#BD9CFE;--1:#6F4CDE">gemini</span><span style="--0:#E1DFDF;--1:#292929"> </span><span style="--0:#77D5A3;--1:#007847">mcp</span><span style="--0:#E1DFDF;--1:#292929"> </span><span style="--0:#77D5A3;--1:#007847">add</span><span style="--0:#E1DFDF;--1:#292929"> [options] &#x3C;name> &#x3C;command> [args...]</span></div></div><div class="ec-line"><div class="code">
</div></div><div class="ec-line"><div class="code"><span style="--0:#8E8E8E;--1:#686868"># Example: Adding a local server</span></div></div><div class="ec-line"><div class="code"><span style="--0:#BD9CFE;--1:#6F4CDE">gemini</span><span style="--0:#E1DFDF;--1:#292929"> </span><span style="--0:#77D5A3;--1:#007847">mcp</span><span style="--0:#E1DFDF;--1:#292929"> </span><span style="--0:#77D5A3;--1:#007847">add</span><span style="--0:#E1DFDF;--1:#292929"> </span><span style="--0:#8DA8FF;--1:#3252B8">-e</span><span style="--0:#E1DFDF;--1:#292929"> </span><span style="--0:#77D5A3;--1:#007847">API_KEY=</span><span style="--0:#8DA8FF;--1:#3252B8">123</span><span style="--0:#E1DFDF;--1:#292929"> </span><span style="--0:#8DA8FF;--1:#3252B8">-e</span><span style="--0:#E1DFDF;--1:#292929"> </span><span style="--0:#77D5A3;--1:#007847">DEBUG=</span><span style="--0:#8DA8FF;--1:#3252B8">true</span><span style="--0:#E1DFDF;--1:#292929"> </span><span style="--0:#77D5A3;--1:#007847">my-stdio-server</span><span style="--0:#E1DFDF;--1:#292929"> </span><span style="--0:#77D5A3;--1:#007847">/path/to/server</span><span style="--0:#E1DFDF;--1:#292929"> </span><span style="--0:#77D5A3;--1:#007847">arg1</span><span style="--0:#E1DFDF;--1:#292929"> </span><span style="--0:#77D5A3;--1:#007847">arg2</span><span style="--0:#E1DFDF;--1:#292929"> </span><span style="--0:#77D5A3;--1:#007847">arg3</span></div></div><div class="ec-line"><div class="code">
</div></div><div class="ec-line"><div class="code"><span style="--0:#8E8E8E;--1:#686868"># Example: Adding a local python server</span></div></div><div class="ec-line"><div class="code"><span style="--0:#BD9CFE;--1:#6F4CDE">gemini</span><span style="--0:#E1DFDF;--1:#292929"> </span><span style="--0:#77D5A3;--1:#007847">mcp</span><span style="--0:#E1DFDF;--1:#292929"> </span><span style="--0:#77D5A3;--1:#007847">add</span><span style="--0:#E1DFDF;--1:#292929"> </span><span style="--0:#77D5A3;--1:#007847">python-server</span><span style="--0:#E1DFDF;--1:#292929"> </span><span style="--0:#77D5A3;--1:#007847">python</span><span style="--0:#E1DFDF;--1:#292929"> </span><span style="--0:#77D5A3;--1:#007847">server.py</span><span style="--0:#E1DFDF;--1:#292929"> </span><span style="--0:#8DA8FF;--1:#3252B8">--</span><span style="--0:#E1DFDF;--1:#292929"> </span><span style="--0:#8DA8FF;--1:#3252B8">--server-arg</span><span style="--0:#E1DFDF;--1:#292929"> </span><span style="--0:#77D5A3;--1:#007847">my-value</span></div></div></code></pre><div class="copy"><button title="Copy to clipboard" data-copied="Copied!" data-code="gemini mcp add [options] <name> <command> [args...]gemini mcp add -e API_KEY=123 -e DEBUG=true my-stdio-server /path/to/server arg1 arg2 arg3gemini mcp add python-server python server.py -- --server-arg my-value"><div></div></button></div></figure></div>
<div class="sl-heading-wrapper level-h4"><h4 id="adding-an-http-server">Adding an HTTP server</h4><a class="sl-anchor-link" href="#adding-an-http-server"><span aria-hidden="true" class="sl-anchor-icon"><svg width="16" height="16" viewBox="0 0 24 24"><path fill="currentcolor" d="m12.11 15.39-3.88 3.88a2.52 2.52 0 0 1-3.5 0 2.47 2.47 0 0 1 0-3.5l3.88-3.88a1 1 0 0 0-1.42-1.42l-3.88 3.89a4.48 4.48 0 0 0 6.33 6.33l3.89-3.88a1 1 0 1 0-1.42-1.42Zm8.58-12.08a4.49 4.49 0 0 0-6.33 0l-3.89 3.88a1 1 0 0 0 1.42 1.42l3.88-3.88a2.52 2.52 0 0 1 3.5 0 2.47 2.47 0 0 1 0 3.5l-3.88 3.88a1 1 0 1 0 1.42 1.42l3.88-3.89a4.49 4.49 0 0 0 0-6.33ZM8.83 15.17a1 1 0 0 0 1.1.22 1 1 0 0 0 .32-.22l4.92-4.92a1 1 0 0 0-1.42-1.42l-4.92 4.92a1 1 0 0 0 0 1.42Z"></path></svg></span><span class="sr-only">Section titled â€œAdding an HTTP serverâ€</span></a></div>
<p>This transport is for servers that use the streamable HTTP transport.</p>
<div class="expressive-code"><figure class="frame is-terminal not-content"><figcaption class="header"><span class="title"></span><span class="sr-only">Terminal window</span></figcaption><pre data-language="bash"><code><div class="ec-line"><div class="code"><span style="--0:#8E8E8E;--1:#686868"># Basic syntax</span></div></div><div class="ec-line"><div class="code"><span style="--0:#BD9CFE;--1:#6F4CDE">gemini</span><span style="--0:#E1DFDF;--1:#292929"> </span><span style="--0:#77D5A3;--1:#007847">mcp</span><span style="--0:#E1DFDF;--1:#292929"> </span><span style="--0:#77D5A3;--1:#007847">add</span><span style="--0:#E1DFDF;--1:#292929"> </span><span style="--0:#8DA8FF;--1:#3252B8">--transport</span><span style="--0:#E1DFDF;--1:#292929"> </span><span style="--0:#77D5A3;--1:#007847">http</span><span style="--0:#E1DFDF;--1:#292929"> </span><span style="--0:#77D5A3;--1:#007847">&#x3C;name></span><span style="--0:#E1DFDF;--1:#292929"> </span><span style="--0:#77D5A3;--1:#007847">&#x3C;url></span></div></div><div class="ec-line"><div class="code">
</div></div><div class="ec-line"><div class="code"><span style="--0:#8E8E8E;--1:#686868"># Example: Adding an HTTP server</span></div></div><div class="ec-line"><div class="code"><span style="--0:#BD9CFE;--1:#6F4CDE">gemini</span><span style="--0:#E1DFDF;--1:#292929"> </span><span style="--0:#77D5A3;--1:#007847">mcp</span><span style="--0:#E1DFDF;--1:#292929"> </span><span style="--0:#77D5A3;--1:#007847">add</span><span style="--0:#E1DFDF;--1:#292929"> </span><span style="--0:#8DA8FF;--1:#3252B8">--transport</span><span style="--0:#E1DFDF;--1:#292929"> </span><span style="--0:#77D5A3;--1:#007847">http</span><span style="--0:#E1DFDF;--1:#292929"> </span><span style="--0:#77D5A3;--1:#007847">http-server</span><span style="--0:#E1DFDF;--1:#292929"> </span><span style="--0:#77D5A3;--1:#007847">https://api.example.com/mcp/</span></div></div><div class="ec-line"><div class="code">
</div></div><div class="ec-line"><div class="code"><span style="--0:#8E8E8E;--1:#686868"># Example: Adding an HTTP server with an authentication header</span></div></div><div class="ec-line"><div class="code"><span style="--0:#BD9CFE;--1:#6F4CDE">gemini</span><span style="--0:#E1DFDF;--1:#292929"> </span><span style="--0:#77D5A3;--1:#007847">mcp</span><span style="--0:#E1DFDF;--1:#292929"> </span><span style="--0:#77D5A3;--1:#007847">add</span><span style="--0:#E1DFDF;--1:#292929"> </span><span style="--0:#8DA8FF;--1:#3252B8">--transport</span><span style="--0:#E1DFDF;--1:#292929"> </span><span style="--0:#77D5A3;--1:#007847">http</span><span style="--0:#E1DFDF;--1:#292929"> </span><span style="--0:#8DA8FF;--1:#3252B8">--header</span><span style="--0:#E1DFDF;--1:#292929"> </span><span style="--0:#77D5A3;--1:#007847">"Authorization: Bearer abc123"</span><span style="--0:#E1DFDF;--1:#292929"> </span><span style="--0:#77D5A3;--1:#007847">secure-http</span><span style="--0:#E1DFDF;--1:#292929"> </span><span style="--0:#77D5A3;--1:#007847">https://api.example.com/mcp/</span></div></div></code></pre><div class="copy"><button title="Copy to clipboard" data-copied="Copied!" data-code="gemini mcp add --transport http <name> <url>gemini mcp add --transport http http-server https://api.example.com/mcp/gemini mcp add --transport http --header &#x22;Authorization: Bearer abc123&#x22; secure-http https://api.example.com/mcp/"><div></div></button></div></figure></div>
<div class="sl-heading-wrapper level-h4"><h4 id="adding-an-sse-server">Adding an SSE server</h4><a class="sl-anchor-link" href="#adding-an-sse-server"><span aria-hidden="true" class="sl-anchor-icon"><svg width="16" height="16" viewBox="0 0 24 24"><path fill="currentcolor" d="m12.11 15.39-3.88 3.88a2.52 2.52 0 0 1-3.5 0 2.47 2.47 0 0 1 0-3.5l3.88-3.88a1 1 0 0 0-1.42-1.42l-3.88 3.89a4.48 4.48 0 0 0 6.33 6.33l3.89-3.88a1 1 0 1 0-1.42-1.42Zm8.58-12.08a4.49 4.49 0 0 0-6.33 0l-3.89 3.88a1 1 0 0 0 1.42 1.42l3.88-3.88a2.52 2.52 0 0 1 3.5 0 2.47 2.47 0 0 1 0 3.5l-3.88 3.88a1 1 0 1 0 1.42 1.42l3.88-3.89a4.49 4.49 0 0 0 0-6.33ZM8.83 15.17a1 1 0 0 0 1.1.22 1 1 0 0 0 .32-.22l4.92-4.92a1 1 0 0 0-1.42-1.42l-4.92 4.92a1 1 0 0 0 0 1.42Z"></path></svg></span><span class="sr-only">Section titled â€œAdding an SSE serverâ€</span></a></div>
<p>This transport is for servers that use Server-Sent Events (SSE).</p>
<div class="expressive-code"><figure class="frame is-terminal not-content"><figcaption class="header"><span class="title"></span><span class="sr-only">Terminal window</span></figcaption><pre data-language="bash"><code><div class="ec-line"><div class="code"><span style="--0:#8E8E8E;--1:#686868"># Basic syntax</span></div></div><div class="ec-line"><div class="code"><span style="--0:#BD9CFE;--1:#6F4CDE">gemini</span><span style="--0:#E1DFDF;--1:#292929"> </span><span style="--0:#77D5A3;--1:#007847">mcp</span><span style="--0:#E1DFDF;--1:#292929"> </span><span style="--0:#77D5A3;--1:#007847">add</span><span style="--0:#E1DFDF;--1:#292929"> </span><span style="--0:#8DA8FF;--1:#3252B8">--transport</span><span style="--0:#E1DFDF;--1:#292929"> </span><span style="--0:#77D5A3;--1:#007847">sse</span><span style="--0:#E1DFDF;--1:#292929"> </span><span style="--0:#77D5A3;--1:#007847">&#x3C;name></span><span style="--0:#E1DFDF;--1:#292929"> </span><span style="--0:#77D5A3;--1:#007847">&#x3C;url></span></div></div><div class="ec-line"><div class="code">
</div></div><div class="ec-line"><div class="code"><span style="--0:#8E8E8E;--1:#686868"># Example: Adding an SSE server</span></div></div><div class="ec-line"><div class="code"><span style="--0:#BD9CFE;--1:#6F4CDE">gemini</span><span style="--0:#E1DFDF;--1:#292929"> </span><span style="--0:#77D5A3;--1:#007847">mcp</span><span style="--0:#E1DFDF;--1:#292929"> </span><span style="--0:#77D5A3;--1:#007847">add</span><span style="--0:#E1DFDF;--1:#292929"> </span><span style="--0:#8DA8FF;--1:#3252B8">--transport</span><span style="--0:#E1DFDF;--1:#292929"> </span><span style="--0:#77D5A3;--1:#007847">sse</span><span style="--0:#E1DFDF;--1:#292929"> </span><span style="--0:#77D5A3;--1:#007847">sse-server</span><span style="--0:#E1DFDF;--1:#292929"> </span><span style="--0:#77D5A3;--1:#007847">https://api.example.com/sse/</span></div></div><div class="ec-line"><div class="code">
</div></div><div class="ec-line"><div class="code"><span style="--0:#8E8E8E;--1:#686868"># Example: Adding an SSE server with an authentication header</span></div></div><div class="ec-line"><div class="code"><span style="--0:#BD9CFE;--1:#6F4CDE">gemini</span><span style="--0:#E1DFDF;--1:#292929"> </span><span style="--0:#77D5A3;--1:#007847">mcp</span><span style="--0:#E1DFDF;--1:#292929"> </span><span style="--0:#77D5A3;--1:#007847">add</span><span style="--0:#E1DFDF;--1:#292929"> </span><span style="--0:#8DA8FF;--1:#3252B8">--transport</span><span style="--0:#E1DFDF;--1:#292929"> </span><span style="--0:#77D5A3;--1:#007847">sse</span><span style="--0:#E1DFDF;--1:#292929"> </span><span style="--0:#8DA8FF;--1:#3252B8">--header</span><span style="--0:#E1DFDF;--1:#292929"> </span><span style="--0:#77D5A3;--1:#007847">"Authorization: Bearer abc123"</span><span style="--0:#E1DFDF;--1:#292929"> </span><span style="--0:#77D5A3;--1:#007847">secure-sse</span><span style="--0:#E1DFDF;--1:#292929"> </span><span style="--0:#77D5A3;--1:#007847">https://api.example.com/sse/</span></div></div></code></pre><div class="copy"><button title="Copy to clipboard" data-copied="Copied!" data-code="gemini mcp add --transport sse <name> <url>gemini mcp add --transport sse sse-server https://api.example.com/sse/gemini mcp add --transport sse --header &#x22;Authorization: Bearer abc123&#x22; secure-sse https://api.example.com/sse/"><div></div></button></div></figure></div>
<div class="sl-heading-wrapper level-h3"><h3 id="listing-servers-gemini-mcp-list">Listing servers (<code dir="auto">gemini mcp list</code>)</h3><a class="sl-anchor-link" href="#listing-servers-gemini-mcp-list"><span aria-hidden="true" class="sl-anchor-icon"><svg width="16" height="16" viewBox="0 0 24 24"><path fill="currentcolor" d="m12.11 15.39-3.88 3.88a2.52 2.52 0 0 1-3.5 0 2.47 2.47 0 0 1 0-3.5l3.88-3.88a1 1 0 0 0-1.42-1.42l-3.88 3.89a4.48 4.48 0 0 0 6.33 6.33l3.89-3.88a1 1 0 1 0-1.42-1.42Zm8.58-12.08a4.49 4.49 0 0 0-6.33 0l-3.89 3.88a1 1 0 0 0 1.42 1.42l3.88-3.88a2.52 2.52 0 0 1 3.5 0 2.47 2.47 0 0 1 0 3.5l-3.88 3.88a1 1 0 1 0 1.42 1.42l3.88-3.89a4.49 4.49 0 0 0 0-6.33ZM8.83 15.17a1 1 0 0 0 1.1.22 1 1 0 0 0 .32-.22l4.92-4.92a1 1 0 0 0-1.42-1.42l-4.92 4.92a1 1 0 0 0 0 1.42Z"></path></svg></span><span class="sr-only">Section titled â€œListing servers (gemini mcp list)â€</span></a></div>
<p>To view all MCP servers currently configured, use the <code dir="auto">list</code> command. It
displays each serverâ€™s name, configuration details, and connection status. This
command has no flags.</p>
<p><strong>Command:</strong></p>
<div class="expressive-code"><figure class="frame is-terminal not-content"><figcaption class="header"><span class="title"></span><span class="sr-only">Terminal window</span></figcaption><pre data-language="bash"><code><div class="ec-line"><div class="code"><span style="--0:#BD9CFE;--1:#6F4CDE">gemini</span><span style="--0:#E1DFDF;--1:#292929"> </span><span style="--0:#77D5A3;--1:#007847">mcp</span><span style="--0:#E1DFDF;--1:#292929"> </span><span style="--0:#77D5A3;--1:#007847">list</span></div></div></code></pre><div class="copy"><button title="Copy to clipboard" data-copied="Copied!" data-code="gemini mcp list"><div></div></button></div></figure></div>
<p><strong>Example output:</strong></p>
<div class="expressive-code"><figure class="frame is-terminal not-content"><figcaption class="header"><span class="title"></span><span class="sr-only">Terminal window</span></figcaption><pre data-language="sh"><code><div class="ec-line"><div class="code"><span style="--0:#BD9CFE;--1:#6F4CDE">âœ“</span><span style="--0:#E1DFDF;--1:#292929"> </span><span style="--0:#77D5A3;--1:#007847">stdio-server:</span><span style="--0:#E1DFDF;--1:#292929"> </span><span style="--0:#77D5A3;--1:#007847">command:</span><span style="--0:#E1DFDF;--1:#292929"> </span><span style="--0:#77D5A3;--1:#007847">python3</span><span style="--0:#E1DFDF;--1:#292929"> </span><span style="--0:#77D5A3;--1:#007847">server.py</span><span style="--0:#E1DFDF;--1:#292929"> (stdio) - Connected</span></div></div><div class="ec-line"><div class="code"><span style="--0:#BD9CFE;--1:#6F4CDE">âœ“</span><span style="--0:#E1DFDF;--1:#292929"> </span><span style="--0:#77D5A3;--1:#007847">http-server:</span><span style="--0:#E1DFDF;--1:#292929"> </span><span style="--0:#77D5A3;--1:#007847">https://api.example.com/mcp</span><span style="--0:#E1DFDF;--1:#292929"> (http) - Connected</span></div></div><div class="ec-line"><div class="code"><span style="--0:#BD9CFE;--1:#6F4CDE">âœ—</span><span style="--0:#E1DFDF;--1:#292929"> </span><span style="--0:#77D5A3;--1:#007847">sse-server:</span><span style="--0:#E1DFDF;--1:#292929"> </span><span style="--0:#77D5A3;--1:#007847">https://api.example.com/sse</span><span style="--0:#E1DFDF;--1:#292929"> (sse) - Disconnected</span></div></div></code></pre><div class="copy"><button title="Copy to clipboard" data-copied="Copied!" data-code="âœ“ stdio-server: command: python3 server.py (stdio) - Connectedâœ“ http-server: https://api.example.com/mcp (http) - Connectedâœ— sse-server: https://api.example.com/sse (sse) - Disconnected"><div></div></button></div></figure></div>
<div class="sl-heading-wrapper level-h3"><h3 id="removing-a-server-gemini-mcp-remove">Removing a server (<code dir="auto">gemini mcp remove</code>)</h3><a class="sl-anchor-link" href="#removing-a-server-gemini-mcp-remove"><span aria-hidden="true" class="sl-anchor-icon"><svg width="16" height="16" viewBox="0 0 24 24"><path fill="currentcolor" d="m12.11 15.39-3.88 3.88a2.52 2.52 0 0 1-3.5 0 2.47 2.47 0 0 1 0-3.5l3.88-3.88a1 1 0 0 0-1.42-1.42l-3.88 3.89a4.48 4.48 0 0 0 6.33 6.33l3.89-3.88a1 1 0 1 0-1.42-1.42Zm8.58-12.08a4.49 4.49 0 0 0-6.33 0l-3.89 3.88a1 1 0 0 0 1.42 1.42l3.88-3.88a2.52 2.52 0 0 1 3.5 0 2.47 2.47 0 0 1 0 3.5l-3.88 3.88a1 1 0 1 0 1.42 1.42l3.88-3.89a4.49 4.49 0 0 0 0-6.33ZM8.83 15.17a1 1 0 0 0 1.1.22 1 1 0 0 0 .32-.22l4.92-4.92a1 1 0 0 0-1.42-1.42l-4.92 4.92a1 1 0 0 0 0 1.42Z"></path></svg></span><span class="sr-only">Section titled â€œRemoving a server (gemini mcp remove)â€</span></a></div>
<p>To delete a server from your configuration, use the <code dir="auto">remove</code> command with the
serverâ€™s name.</p>
<p><strong>Command:</strong></p>
<div class="expressive-code"><figure class="frame is-terminal not-content"><figcaption class="header"><span class="title"></span><span class="sr-only">Terminal window</span></figcaption><pre data-language="bash"><code><div class="ec-line"><div class="code"><span style="--0:#BD9CFE;--1:#6F4CDE">gemini</span><span style="--0:#E1DFDF;--1:#292929"> </span><span style="--0:#77D5A3;--1:#007847">mcp</span><span style="--0:#E1DFDF;--1:#292929"> </span><span style="--0:#77D5A3;--1:#007847">remove</span><span style="--0:#E1DFDF;--1:#292929"> </span><span style="--0:#77D5A3;--1:#007847">&#x3C;name></span></div></div></code></pre><div class="copy"><button title="Copy to clipboard" data-copied="Copied!" data-code="gemini mcp remove <name>"><div></div></button></div></figure></div>
<p><strong>Options (flags):</strong></p>
<ul>
<li><code dir="auto">-s, --scope</code>: Configuration scope (user or project). [default: â€œprojectâ€]</li>
</ul>
<p><strong>Example:</strong></p>
<div class="expressive-code"><figure class="frame is-terminal not-content"><figcaption class="header"><span class="title"></span><span class="sr-only">Terminal window</span></figcaption><pre data-language="bash"><code><div class="ec-line"><div class="code"><span style="--0:#BD9CFE;--1:#6F4CDE">gemini</span><span style="--0:#E1DFDF;--1:#292929"> </span><span style="--0:#77D5A3;--1:#007847">mcp</span><span style="--0:#E1DFDF;--1:#292929"> </span><span style="--0:#77D5A3;--1:#007847">remove</span><span style="--0:#E1DFDF;--1:#292929"> </span><span style="--0:#77D5A3;--1:#007847">my-server</span></div></div></code></pre><div class="copy"><button title="Copy to clipboard" data-copied="Copied!" data-code="gemini mcp remove my-server"><div></div></button></div></figure></div>
<p>This will find and delete the â€œmy-serverâ€ entry from the <code dir="auto">mcpServers</code> object in
the appropriate <code dir="auto">settings.json</code> file based on the scope (<code dir="auto">-s, --scope</code>).</p>
<div class="sl-heading-wrapper level-h2"><h2 id="instructions">Instructions</h2><a class="sl-anchor-link" href="#instructions"><span aria-hidden="true" class="sl-anchor-icon"><svg width="16" height="16" viewBox="0 0 24 24"><path fill="currentcolor" d="m12.11 15.39-3.88 3.88a2.52 2.52 0 0 1-3.5 0 2.47 2.47 0 0 1 0-3.5l3.88-3.88a1 1 0 0 0-1.42-1.42l-3.88 3.89a4.48 4.48 0 0 0 6.33 6.33l3.89-3.88a1 1 0 1 0-1.42-1.42Zm8.58-12.08a4.49 4.49 0 0 0-6.33 0l-3.89 3.88a1 1 0 0 0 1.42 1.42l3.88-3.88a2.52 2.52 0 0 1 3.5 0 2.47 2.47 0 0 1 0 3.5l-3.88 3.88a1 1 0 1 0 1.42 1.42l3.88-3.89a4.49 4.49 0 0 0 0-6.33ZM8.83 15.17a1 1 0 0 0 1.1.22 1 1 0 0 0 .32-.22l4.92-4.92a1 1 0 0 0-1.42-1.42l-4.92 4.92a1 1 0 0 0 0 1.42Z"></path></svg></span><span class="sr-only">Section titled â€œInstructionsâ€</span></a></div>
<p>Gemini CLI supports
<a href="https://modelcontextprotocol.io/specification/2025-06-18/schema#initializeresult">MCP server instructions</a>,
which will be appended to the system instructions.</p> </div>  </div> </div>   </main> </div> </div>   </div> <div id="cookie-notice-wrapper" class="hidden astro-uz2wdcl7"> <div class="cookie-notice-container fixed bottom-0 left-0 right-0 flex justify-center z-50 astro-uz2wdcl7"> <div class="cookie-notice text-sm dark:bg-black/50 bg-white/50 backdrop-blur-sm m-2 p-3 rounded-lg flex max-sm:flex-col items-center border border-black/20 astro-uz2wdcl7"> <div class="mr-2 astro-uz2wdcl7">
This website uses <a href="https://policies.google.com/technologies/cookies" class="underline text-black/70 dark:text-white/70 astro-uz2wdcl7" target="_blank">cookies</a> from Google to deliver and enhance the quality of its services and to analyze
        traffic.
</div> <button id="cookie-ack-button" class="font-bold text-nowrap px-2 py-1 border rounded dark:bg-black/80 dark:text-white/70 dark:border-white/30 border-black/20 astro-uz2wdcl7">
I understand.
</button> </div> </div> </div> <script type="module">const e=document.getElementById("cookie-notice-wrapper"),t="__cookieAck";e&&localStorage.getItem(t)!=="true"&&e.classList.remove("hidden");const o=document.getElementById("cookie-ack-button");o?.addEventListener("click",()=>{localStorage.setItem(t,"true"),e&&(e.style.display="none")});</script>  <!-- Footer at bottom of .page flex container --> <footer class="site-footer astro-yriad4ts theme-aware astro-sz7xmlte"> <div class="footer-content astro-sz7xmlte"> <div class="logos astro-sz7xmlte"> <img class="logo-light astro-sz7xmlte" src="/assets/Google.svg" alt="Google logo" width="64.216" height="21"> <img class="logo-dark astro-sz7xmlte" src="/assets/Google-dark.svg" alt="Google logo" width="64.216" height="21"> <img class="logo-light fordev-logo astro-sz7xmlte" src="/assets/fordevelopers.svg" alt="For Developers logo" width="122.678" height="17.583"> <img class="logo-dark fordev-logo astro-sz7xmlte" src="/assets/fordevelopers-dark.svg" alt="For Developers logo" width="122.678" height="17.583"> </div> <div class="footer-links astro-sz7xmlte"> <a href="/terms" class="tos-link astro-sz7xmlte" target="_blank" rel="noopener noreferrer">Terms</a> <span class="divider astro-sz7xmlte">|</span> <a href="https://policies.google.com/privacy" class="tos-link astro-sz7xmlte" target="_blank" rel="noopener noreferrer">Privacy</a> </div> </div> </footer>  </div>  </body></html>